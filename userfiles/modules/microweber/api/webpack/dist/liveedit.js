/*! For license information please see liveedit.js.LICENSE.txt */
(()=>{var e,t;mw.liveedit.beforeleave=function(e){var t="<div class='mw-before-leave-container'><p>Leave page by choosing an option</p><span class='mw-ui-btn mw-ui-btn-important'>"+mw.msg.before_leave+"</span><span class='mw-ui-btn mw-ui-btn-notification' >"+mw.msg.save_and_continue+"</span><span class='mw-ui-btn' onclick='mw.dialog.remove(\"#modal_beforeleave\")'>"+mw.msg.cancel+"</span></div>";if(mw.askusertostay&&mw.$(".edit.orig_changed").length>0){if(null===document.getElementById("modal_beforeleave")){var o=mw.dialog({html:t,name:"modal_beforeleave",width:470,height:230}),i=o.container.querySelector(".mw-ui-btn-notification"),n=o.container.querySelector(".mw-ui-btn-important");mw.$(i).click((function(){mw.$(document.body).addClass("loading"),mw.dialog.remove(o),mw.drag.save(void 0,(function(){mw.askusertostay=!1,window.location.href=e}))})),mw.$(n).click((function(){mw.askusertostay=!1,window.location.href=e}))}return!1}},mw.drag.onCloneableControl=function(e,t){this._onCloneableControl||(this._onCloneableControl=document.createElement("div"),this._onCloneableControl.className="mw-cloneable-control",this._onCloneableControl.innerHTML='<span class="mw-cloneable-control-item mw-cloneable-control-prev tip" data-tip="Move backward"></span><span class="mw-cloneable-control-item mw-cloneable-control-plus tip" data-tip="Clone"></span><span class="mw-cloneable-control-item mw-cloneable-control-minus tip" data-tip="Remove"></span><span class="mw-cloneable-control-item mw-cloneable-control-next tip" data-tip="Move forward"></span>',document.body.appendChild(this._onCloneableControl),$(".mw-cloneable-control-plus",this._onCloneableControl).on("click",(function(){var e=$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML});for(var t=mw.tools.parseHtml(mw.drag._onCloneableControl.__target.outerHTML).body,o=t.querySelectorAll("[id]"),i=0;i<o.length;i++)o[i].id="mw-cl-id-"+mw.random();$(mw.drag._onCloneableControl.__target).after(t.innerHTML),mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.wysiwyg.change(mw.drag._onCloneableControl.__target),mw.drag.onCloneableControl("hide")})),$(".mw-cloneable-control-minus",this._onCloneableControl).on("click",(function(){var e=$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),$(mw.drag._onCloneableControl.__target).fadeOut((function(){mw.wysiwyg.change(this),$(this).remove(),mw.liveEditState.record({target:e[0],value:e[0].innerHTML})})),mw.drag.onCloneableControl("hide")})),$(".mw-cloneable-control-next",this._onCloneableControl).on("click",(function(){var e=$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),$(mw.drag._onCloneableControl.__target).next().after(mw.drag._onCloneableControl.__target),mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.wysiwyg.change(mw.drag._onCloneableControl.__target),mw.drag.onCloneableControl("hide")})),$(".mw-cloneable-control-prev",this._onCloneableControl).on("click",(function(){var e=$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),$(mw.drag._onCloneableControl.__target).prev().before(mw.drag._onCloneableControl.__target),mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.wysiwyg.change(mw.drag._onCloneableControl.__target),mw.drag.onCloneableControl("hide")})));var o=$(this._onCloneableControl);if("hide"===e)o.hide();else{o.show(),this._onCloneableControl.__target=e;var i=$(this._onCloneableControl.__target).next(),n=$(this._onCloneableControl.__target).prev(),a=$(e),r=a.offset();0===i.length?$(".mw-cloneable-control-next",o).hide():$(".mw-cloneable-control-next",o).show(),0===n.length?$(".mw-cloneable-control-prev",o).hide():$(".mw-cloneable-control-prev",o).show();var l=(r.left>0?r.left:0)+(a.width()/2-o.width()/2);if(o.show(),t)return;o.css({top:r.top>0?r.top:0,left:l});var s=document.querySelector(".mw-cloneable-control");s&&mw._initHandles.getAll().forEach((function(e){masterRect=e.wrapper.getBoundingClientRect();var t=s.getBoundingClientRect();mw._initHandles.collide(masterRect,t)&&(s.style.top=parseFloat(e.wrapper.style.top)+10+"px",s.style.left=parseInt(e.wrapper.style.left,10)+masterRect.width+10+"px")}))}},mw.drag=mw.drag||{},mw.drag.columns={step:.8,resizing:!1,prepare:function(){mw.drag.columns.resizer=document.createElement("div"),mw.wysiwyg.contentEditable(mw.drag.columns.resizer,!1),mw.drag.columns.resizer.className="unselectable mw-columns-resizer",mw.drag.columns.resizer.pos=0,mw.$(mw.drag.columns.resizer).on("mousedown",(function(){mw.drag.columns.resizing=!0,mw.drag.columns.resizer.pos=0})),document.body.appendChild(mw.drag.columns.resizer),mw.$(mw.drag.columns.resizer).hide()},resize:function(e){if(!mw.drag.columns.resizer.curr)return!1;var t=parseFloat(mw.drag.columns.resizer.curr.style.width);isNaN(t)&&(t=(t=mw.$(mw.drag.columns.resizer.curr).outerWidth())/mw.$(mw.drag.columns.resizer.curr).parent().outerWidth()*100);var o=mw.drag.columns.nextColumn(mw.drag.columns.resizer.curr);if(!o)return mw.$(mw.drag.columns.resizer).hide(),!1;var i=parseFloat(o.style.width);if(isNaN(i)&&(i=(i=mw.$(o).outerWidth())/mw.$(o).parent().outerWidth()*100),mw.drag.columns.resizer.pos<e.pageX){if(i<10&&!mw.tools.isRtl())return!1;mw.drag.columns.resizer.curr.style.width=mw.tools.isRtl()?t-mw.drag.columns.step:t+mw.drag.columns.step+"%";var n=mw.tools.isRtl()?i+mw.drag.columns.step:i-mw.drag.columns.step;o.style.width=n+"%"}else{if(t<10&&!mw.tools.isRtl())return!1;mw.drag.columns.resizer.curr.style.width=mw.tools.isRtl()?t+mw.drag.columns.step:t-mw.drag.columns.step+"%",n=mw.tools.isRtl()?i-mw.drag.columns.step:i+mw.drag.columns.step,o.style.width=n+"%"}mw.drag.columns.resizer.pos=e.pageX,mw.drag.columns.position(mw.drag.columns.resizer.curr),mw.trigger("columnResize",mw.drag.columns.resizer.curr)},position:function(e){if(mw.drag.columns.nextColumn(e)){mw.drag.columns.resizer.curr=e;var t=mw.$(e).offset();mw.$(mw.drag.columns.resizer).css({top:t.top,left:mw.tools.isRtl()?t.left-10:t.left+e.offsetWidth-10,height:e.offsetHeight}).show()}},init:function(){mw.drag.columns.prepare(),mw.on("ColumnOver",(function(e,t){mw.drag.columns.resizer.pos=0,mw.drag.columns.position(t)})),mw.on("ColumnOut",(function(e,t){mw.$(mw.drag.columns.resizer).hide()}))},nextColumn:function(e){var t=e.nextElementSibling;if(null!==t)return mw.tools.hasClass(t,"mw-col")?t:mw.drag.columns.nextColumn(t)}},$(mwd).ready((function(){mw.$(document.body).on("mouseup touchend",(function(){mw.drag.plus.locked&&mw.wysiwyg.change(mw.drag.columns.resizer.curr),mw.drag.columns.resizing=!1,mw.drag.plus.locked=!1,mw.tools.removeClass(document.body,"mw-column-resizing")})),mw.$(document.body).on("mousemove touchmove",(function(e){!0===mw.drag.columns.resizing&&!1===mw.isDrag&&(mw.drag.columns.resize(e),e.preventDefault(),mw.drag.plus.locked=!0,mw.tools.addClass(document.body,"mw-column-resizing"))}))})),mw.liveedit.data={_data:{},_target:null,init:function(){var e=this;mw.$(document.body).on("touchmove mousemove",(function(t){var o=!!mw.tools.firstMatchesOnNodeOrParent(t.target,['[data-module-name="layouts"]','[data-type="layouts"]']);mw.liveedit.data.set("move","hasLayout",o),mw.liveedit.data.set("move","hasModuleOrElement",mw.tools.hasAnyOfClassesOnNodeOrParent(t.target,["module","element"])),e._target!==t.target&&(e._target=t.target,mw.trigger("Liveedit"))})).on("mouseup touchend",(function(e){mw.liveedit.data.set("mouseup","isIcon",mw.wysiwyg.firstElementThatHasFontIconClass(e.target))}))},set:function(e,t,o){this._data[e]=this._data[e]||{},this._data[e][t]=o},get:function(e,t){return this._data[e]?this._data[e][t]:void 0}},mw.drag={_fixDeniedParagraphHierarchySelector:".edit p h1,.edit p h2,.edit p h3,.edit p h4,.edit p h5,.edit p h6,.edit p p,.edit p ul,.edit p ol,.edit p header,.edit p form,.edit p article,.edit p aside,.edit p blockquote,.edit p footer,.edit p div",fixDeniedParagraphHierarchy:function(e){var t=(e=e||document.body).querySelectorAll(mw.drag._fixDeniedParagraphHierarchySelector);if(t.length)for(var o=0;o<t.length;o++){var i=mw.tools.firstParentWithTag(t[o],"p");mw.tools.setTag(i,"div")}},create_columns:function(e,t){if(!$(e).hasClass("active")){mw.$(mw.drag.columns.resizer).hide();var o=mw._activeRowOver.id;mw.$(e).addClass("active");var i=""!==o?o:mw.settings.mw-row_id;mw.settings.sortables_created=!1;var n=mw.$("#"+i).children(".mw-col").length;if(0===t&&(t=1),0===n&&(n=1),(t=parseInt(t))!==n){if(t>n)for(var a=n;a<t;a++){var r=document.createElement("div");r.className="mw-col",r.innerHTML='<div class="mw-col-container"><div class="mw-empty element" id="element_'+mw.random()+'"></div></div>',mw.$("#"+i).append(r),mw.drag.fix_placeholders(!0,"#"+i)}else if(n-t>0){var l,s=document.createDocumentFragment();mw.$("#"+i).children(".mw-col").each((function(e){e===t-1?l=mw.$(this):e>t-1&&(null!==this.querySelector(".mw-col-container")&&mw.tools.foreachChildren(this,(function(){mw.tools.hasClass(this.className,"mw-col-container")&&s.appendChild(this)})),mw.$(this).remove())}));for(var m=l.find(".mw-col-container"),d=s.childNodes,w=(a=0,d.length);a<w;a++){var c=d[a];mw.$(".empty-element, .ui-resizable-handle",c).remove(),m.append(c.innerHTML)}mw.$("#"+i).children(".empty-element").remove(),mw.drag.fix_placeholders(!0,"#"+i)}var u=100/(n=mw.$("#"+i).children(".mw-col").size());mw.$("#"+i).children(".mw-col").width(u+"%")}}mw.wysiwyg.nceui()},replace:function(e,t,o){var i=e[t](),n=e.offset(),a=i.offset();i.css({position:"relative"}).animate({top:n.top-a.top}),e.css({position:"relative"}).animate({top:a.top-n.top},(function(){"prev"===t?i.before(e):i.after(e),e.css({top:"",position:""}),i.css({top:"",position:""}),mw.wysiwyg.change(e[0]),o&&setTimeout((function(){o.call()}),10)}))},external_grids_col_classes:["row","col-lg-1","col-lg-10","col-lg-11","col-lg-12","col-lg-2","col-lg-3","col-lg-4","col-lg-5","col-lg-6","col-lg-7","col-lg-8","col-lg-9","col-md-1","col-md-10","col-md-11","col-md-12","col-md-2","col-md-3","col-md-4","col-md-5","col-md-6","col-md-7","col-md-8","col-md-9","col-sm-1","col-sm-10","col-sm-11","col-sm-12","col-sm-2","col-sm-3","col-sm-4","col-sm-5","col-sm-6","col-sm-7","col-sm-8","col-sm-9","col-xs-1","col-xs-10","col-xs-11","col-xs-12","col-xs-2","col-xs-3","col-xs-4","col-xs-5","col-xs-6","col-xs-7","col-xs-8","col-xs-9"],external_css_no_element_classes:["container","navbar","navbar-header","navbar-collapse","navbar-static","navbar-static-top","navbar-default","navbar-text","navbar-right","navbar-center","navbar-left","nav navbar-nav","collapse","header-collapse","panel-heading","panel-body","panel-footer"],section_selectors:[".module-layouts"],external_css_no_element_controll_classes:["container","container-fluid","edit","noelement","no-element","allow-drop","nodrop","mw-open-module-settings","module-layouts"],onCloneableControl:function(e,t){this._onCloneableControl||(this._onCloneableControl=document.createElement("div"),this._onCloneableControl.className="mw-cloneable-control",this._onCloneableControl.innerHTML='<span class="mw-cloneable-control-item mw-cloneable-control-prev" title="Move backward"></span><span class="mw-cloneable-control-item mw-cloneable-control-plus" title="Clone"></span><span class="mw-cloneable-control-item mw-cloneable-control-minus" title="Remove"></span><span class="mw-cloneable-control-item mw-cloneable-control-next" title="Move forward"></span>',document.body.appendChild(this._onCloneableControl),mw.$(".mw-cloneable-control-plus",this._onCloneableControl).on("click",(function(){var e=mw.$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML});for(var t=mw.tools.parseHtml(mw.drag._onCloneableControl.__target.outerHTML).body,o=t.querySelectorAll("[id]"),i=0;i<o.length;i++)o[i].id="mw-cl-id-"+mw.random();mw.$(mw.drag._onCloneableControl.__target).after(t.innerHTML),mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.wysiwyg.change(mw.drag._onCloneableControl.__target),mw.drag.onCloneableControl("hide")})),mw.$(".mw-cloneable-control-minus",this._onCloneableControl).on("click",(function(){var e=mw.$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.$(mw.drag._onCloneableControl.__target).fadeOut((function(){mw.wysiwyg.change(this),mw.$(this).remove(),mw.liveEditState.record({target:e[0],value:e[0].innerHTML})})),mw.drag.onCloneableControl("hide")})),mw.$(".mw-cloneable-control-next",this._onCloneableControl).on("click",(function(){var e=mw.$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.$(mw.drag._onCloneableControl.__target).next().after(mw.drag._onCloneableControl.__target),mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.wysiwyg.change(mw.drag._onCloneableControl.__target),mw.drag.onCloneableControl("hide")})),mw.$(".mw-cloneable-control-prev",this._onCloneableControl).on("click",(function(){var e=mw.$(mw.drag._onCloneableControl.__target).parent();mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.$(mw.drag._onCloneableControl.__target).prev().before(mw.drag._onCloneableControl.__target),mw.liveEditState.record({target:e[0],value:e[0].innerHTML}),mw.wysiwyg.change(mw.drag._onCloneableControl.__target),mw.drag.onCloneableControl("hide")})));var o=mw.$(this._onCloneableControl);if("hide"==e)o.hide();else{o.show(),this._onCloneableControl.__target=e;var i=mw.$(this._onCloneableControl.__target).next(),n=mw.$(this._onCloneableControl.__target).prev(),a=mw.$(e),r=a.offset();0==i.length?mw.$(".mw-cloneable-control-next",o).hide():mw.$(".mw-cloneable-control-next",o).show(),0==n.length?mw.$(".mw-cloneable-control-prev",o).hide():mw.$(".mw-cloneable-control-prev",o).show();var l=(r.left>0?r.left:0)+(a.width()/2-o.width()/2);if(o.show(),t)return;o.css({top:r.top>0?r.top:0,left:l});var s=document.querySelector(".mw-cloneable-control");s&&mw._initHandles.getAll().forEach((function(e){masterRect=e.wrapper.getBoundingClientRect();var t=s.getBoundingClientRect();mw._initHandles.collide(masterRect,t)&&(s.style.top=parseFloat(e.wrapper.style.top)+10+"px",s.style.left=parseInt(e.wrapper.style.left,10)+masterRect.width+10+"px")}))}},noop:document.createElement("div"),create:function(){for(var e=document.body.querySelectorAll(".edit"),t=e.length,o=0;o<t;o++)for(var i=e[o].querySelectorAll("p,div,h1,h2,h3,h4,h5,h6,section,img"),n=0,a=i.length;n<a;n++){var r=i[n];mw.drag.target.canBeElement(r)&&(r.className,mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(r,["element","module"])&&!mw.tools.hasAnyOfClasses(r,["mw-col","mw-col","mw-row","mw-zone"])&&mw.tools.addClass(r,"element"))}mw.$("#live_edit_toolbar_holder .module").removeClass("module"),mw.handlerMouse={x:0,y:0},mw.$(document.body).on("mousemove touchmove",(function(e){if(mw.dragSTOPCheck=!1,!mw.settings.resize_started)if(mw.emouse=mw.event.page(e),mw.mm_target=e.target,mw.$mm_target=mw.$(mw.mm_target),mw.isDrag){var t=document.getElementById("live_edit_side_holder");t&&t.contains&&t.contains(mw.mm_target)?(mw.dropable.hide(),mw.ea.data.target=null):(mw.ea.data.currentGrabbed=mw.dragCurrent,mw.tools.removeClass(this,"isTyping"),mw.ea.interactionAnalizer(e),mw.$(".currentDragMouseOver").removeClass("currentDragMouseOver"),mw.$(mw.currentDragMouseOver).addClass("currentDragMouseOver"))}else"element"===mw.liveEditSelectMode&&(mw.tools.removeClass(this,"isTyping"),mw.handlerMouse=Object.assign({},mw.emouse),mw.liveEditHandlers(e))})),mw.dropables.prepare(),mw.drag.fix_placeholders(!0),mw.drag.fixes(),mw.$(document.body).on("mouseup touchend",(function(e){mw.mouseDownStarted=!1,mw.isDrag&&mw.dropable.is(":hidden")&&mw.$(".ui-draggable-dragging").css({top:0,left:0}),mw.$(this).removeClass("not-allowed")})),mw.$(document.body).on("mousedown touchstart",(function(e){var t=e.target;if($(t).hasClass("image_free_text")){mw.image._dragcurrent=t,mw.image._dragparent=t.parentNode;var o=mw.event.page(e);mw.image._dragcursorAt.x=o.x-t.offsetLeft,mw.image._dragcursorAt.y=o.y-t.offsetTop,t.startedY=t.offsetTop-t.parentNode.offsetTop,t.startedX=t.offsetLeft-t.parentNode.offsetLeft}0===$(".desc_area_hover").length&&mw.$(".desc_area").hide(),mw.tools.hasClass(e.target.className,"mw-open-module-settings")&&(mw.settings.live_edit_open_module_settings_in_sidebar?(t=mw.tools.firstParentWithClass(e.target,"module"),mw.liveNodeSettings.set("module",t)):mw.drag.module_settings(mw.tools.firstParentOrCurrentWithAnyOfClasses(e.target,["module"]))),mw.tools.hasParentsWithTag(e.target,"TABLE")||mw.tools.hasParentsWithClass(e.target,"mw-inline-bar")||(mw.$(mw.liveedit.inline.tableControl).hide(),mw.$(".tc-activecell").removeClass("tc-activecell"))}))},init:function(e,t){mw.drag.the_drop()},properFocus:function(e){var t;if(mw.tools.hasClass(e.target,"mw-row")||mw.tools.hasClass(e.target,"mw-col")){if(mw.tools.hasClass(e.target,"mw-col"))t=e.target.querySelector(".mw-col-container");else for(var o=0,i=e.target.children,n=i.length;o<n;o++){var a=mw.$(i[o]).offset().left,r=mw.event.page(e);if(a<r.x&&a+i[o].clientWidth>r.x){null===(t=i[o].querySelector(".mw-col-container"))&&(i[o].innerHTML='<div class="mw-col-container">'+i[o].innerHTML+"</div>"),t=i[o].querySelector(".mw-col-container");break}}if(t&&null!==t.querySelector(".element")){var l=t.querySelectorAll(".element");t=l[(n=l.length)-1]}if(t){var s=document.createRange(),m=window.getSelection();s.selectNodeContents(t),s.collapse(!1),m.removeAllRanges(),m.addRange(s)}}},toolbar_modules:function(e){mw.liveedit.modulesToolbar.init(e)},the_drop:function(){$(document.body).hasClass("bup")||(mw.$(document.body).addClass("bup"),mw.$(document.body).on("mouseup touchend",(function(e){mw.image._dragcurrent=null,mw.image._dragparent=null;for(var t=document.getElementsByClassName("canvas-slider"),o=t.length,i=0;i<o;i++)t[i].isDrag=!1;if("mouseup"!==e.type&&"touchend"!==e.type||"none"!==mw.liveEditSelectMode||(mw.liveEditSelectMode="element"),!mw.isDrag){var n=e.target,a=["element","safe-element","module","plain-text"],r=mw.tools.firstParentOrCurrentWithAnyOfClasses(n,a),l=mw.liveedit.data.get("mouseup","isIcon");if(mw.tools.hasAnyOfClassesOnNodeOrParent(n,a)){if(r&&!l){var s=mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(n,["safe-mode","module"]);if(mw.tools.hasClass(r,"module"))mw.trigger("ComponentClick",[n,"module"]);else if(mw.wysiwyg.isSelectionEditable()&&!mw.tools.hasAnyOfClasses(n,a)&&s)mw.trigger("ComponentClick",[n,"element"]);else if(!mw.tools.hasAnyOfClasses(n,a)){var m=a.filter((function(e){return r.classList.contains(e)}));mw.trigger("ComponentClick",[r,m[0]])}}var d=mw.tools.firstParentOrCurrentWithClass(n,"element"),w=mw.tools.firstParentOrCurrentWithClass(n,"safe-element"),c=mw.tools.firstParentOrCurrentWithClass(n,"module");$(n).hasClass("plain-text")?mw.trigger("PlainTextClick",n):d&&mw.trigger("ElementClick",[d,e]),w&&mw.trigger("SafeElementClick",[w,e]),c&&mw.trigger("ModuleClick",[c,e])}l&&!mw.tools.hasAnyOfClasses(n,["element","module"])&&("I"!==l.tagName&&"SPAN"!==l.tagName||mw.tools.hasParentsWithClass(l,"dropdown")||mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(l,["edit","module"])&&(mw.trigger("IconElementClick",l),mw.trigger("ComponentClick",[l,"icon"]))),$(n).hasClass("mw_item")?mw.trigger("ItemClick",n):mw.tools.hasParentsWithClass(n,"mw_item")&&mw.trigger("ItemClick",mw.$(n).parents(".mw_item")[0]),"IMG"===n.tagName&&mw.tools.hasParentsWithClass(n,"edit")&&(-1==(s=mw.tools.parentsOrder(mw.mm_target,["edit","module"])).module||s.edit>-1&&s.edit<s.module)&&(mw.tools.hasParentsWithClass(n,"mw-defaults")||mw.trigger("ImageClick",n),mw.wysiwyg.select_element(n)),"BODY"===n.tagName&&mw.trigger("BodyClick",n),("TD"===n.tagName?n:mw.tools.firstParentWithTag(n,"td"))&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(n,["edit","module"])&&mw.trigger("TableTdClick",n),mw.tools.hasClass(n,"mw-empty")||mw.tools.hasParentsWithClass(n,"mw-empty"),mw.tools.hasClass(n,"mw-empty")&&""!==n.innerHTML.trim()&&(n.className="element"),mw.drag.properFocus(e)}mw.isDrag&&(mw.isDrag=!1,mw.wysiwyg.change(mw.currentDragMouseOver),mw.$(mw.currentDragMouseOver).removeClass("currentDragMouseOver"),mw._initHandles.hideAll(),setTimeout((function(){if(mw.ea.data.target&&mw.ea.data.currentGrabbed&&mw.ea.data.dropableAction&&mw.ea.data.target&&mw.ea.data.currentGrabbed){var e=mw.tools.firstParentOrCurrentWithClass(mw.ea.data.target,"edit"),t=mw.ea.data.currentGrabbed.parentNode,o={target:e,value:e.innerHTML};if(t){var i=mw.tools.parseHtml(t.innerHTML);mw.$(i.querySelector(".mw_drag_current")).css({visibility:"hidden",opacity:0}),o.prev=t,o.prevValue=i.body.innerHTML}mw.liveEditState.record(o),mw.$(mw.ea.data.target)[mw.ea.data.dropableAction](mw.ea.data.currentGrabbed),setTimeout((function(e){var o={target:e,value:e.innerHTML};if(t){var i=mw.tools.parseHtml(t.innerHTML);mw.$(i.querySelector(".mw_drag_current")).css({visibility:"hidden",opacity:0}),o.prev=t,o.prevValue=i.body.innerHTML}mw.liveEditState.record(o)}),50,e)}mw.drag.fixes(),setTimeout((function(){mw.drag.fix_placeholders(),mw.ea.afterAction(),mw.liveEditDomTree&&mw.ea.data.target&&mw.liveEditDomTree.refresh(mw.ea.data.target.parentNode)}),40),mw.dropable.hide()}),77),setTimeout((function(){mw.have_new_items&&mw.drag.load_new_modules()}),120))})))},fixes:function(){mw.$(".edit .mw-col, .edit .mw-row").height("auto"),mw.$(mw.dragCurrent).css({top:"",left:""});var e,t="",o=[];for(e=o.length-1;e>=0;--e)t+=",.edit .row > ."+o[e];setTimeout((function(){mw.$(".edit .mw-col"+t).each((function(){var e=mw.$(this);0===e.children().length||e.children(".empty-element").length>0||e.children(".ui-draggable-dragging").length>0?(e.height("auto"),e.height()<e.parent().height()?e.height(e.parent().height()):e.height("auto")):(e.children(".empty-element").height("auto"),e.height("auto"),e.parents(".mw-row:first").height("auto")),e.height("auto");var t=mw.tools.firstParentWithClass(this,"mw-row");t&&(t.style.height="auto"),mw.drag.fixDeniedParagraphHierarchy()}))}),222);var i=document.querySelectorAll("div.element"),n=i.length,a=0;if(n>0)for(;a<n;a++)null!==i[a].querySelector("p,div,li,h1,h2,h3,h4,h5,h6,figure,img")||mw.tools.hasClass(i[a],"plain-text")||mw.tools.hasClass(i[a].className,"nodrop")||mw.tools.hasClass(i[a].className,"mw-empty")||mw.tools.hasAnyOfClassesOnNodeOrParent(i[a],["safe-mode"])||(i[a].innerHTML='<p class="element">'+i[a].innerHTML+"</p>")},fix_placeholders:function(e,t){t=t||".edit .row";var o,i="div.col-md",n=mw.drag.external_grids_col_classes;for(o=n.length-1;o>=0;--o)i+=",div."+n[o];mw.$(t).each((function(){mw.$(this).children(i).each((function(){0==mw.$(this).children("*").size()&&(mw.$(this).append('<div class="element" id="mw-element-'+mw.random()+'"></div>'),mw.$(this).children("div.element"))}))}))},edit_remove:function(){},target:{canBeElement:function(e){var t=e,o=["mw-ui-col","mw-col-container","mw-ui-col-container"],i=mw.drag.external_grids_col_classes,n=mw.drag.external_css_no_element_classes,a=mw.drag.external_css_no_element_controll_classes,r=mw.drag.section_selectors,l=mw.wysiwyg.fontIconFamilies;return o=(o=(o=(o=(o=o.concat(i)).concat(n)).concat(a)).concat(r)).concat(l),mw.tools.hasAnyOfClasses(t,o)},canBeEditable:function(e){return e.isContentEditable||mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(e,["edit","module"])}},fancynateLoading:function(e){mw.$(e).addClass("module_loading"),setTimeout((function(){mw.$(e).addClass("module_activated"),setTimeout((function(){mw.$(e).removeClass("module_loading module_activated")}),510)}),150)},load_new_modules:function(e){return mw.ea.afterAction()},module_view:function(e){return mw.drag.module_settings(!1,e)},module_settings:function(e,t){return mw.tools.module_settings(e,t)},current_module_settings_tooltip_show_on_element:function(e,t,o){if(e&&0!==mw.$("#"+e).length){var i=mw._activeModuleOver,n=mw.$("#"+e),a={};o=o||"modal",$.each(i.attributes,(function(e,t){a[t.name]=t.value}));var r=a,l=null;r["data-type"]&&(l=r["data-type"],r["data-type"]=r["data-type"]+"/admin"),r["data-module-name"]&&delete r["data-module-name"],r.type&&(l=r.type,r.type=r.type+"/admin"),null!=l&&t&&(r["data-type"]=r.type=l+"/"+t),r.class&&delete r.class,r.style&&delete r.style,r.contenteditable&&delete r.contenteditable,r.live_edit="true",r.module_settings="true",r.view=null!=t?t:"admin",null==r.from_url&&(r.from_url=window.parent.location);var s="module-settings-"+i.id;if("function"==typeof r.view.hash&&(s="module-settings-"+i.id+r.view.hash()),mw.$("#"+s).length>0){var m=mw.$("#"+s)[0];return m.scrollIntoView(),mw.tools.highlight(m),!1}var d=mw.settings.site_url+"api/module?"+json2url(r);if("modal"===o)return mw.top().dialogIframe({url:d,width:532,height:150,name:s,title:"",callback:function(){mw.$(this.container).attr("data-settings-for-module",i.id)}});if("tooltip"===o){var w="mw-tooltip-iframe-"+mw.random();mw.tooltip({id:"module-settings-tooltip-"+s,group:"module_settings_tooltip_show_on_btn",close_on_click_outside:!0,content:'<iframe id="'+w+'" frameborder="0" class="mw-tooltip-iframe" src="'+d+'" scrolling="auto"></iframe>',element:n}),mw.tools.iframeAutoHeight(document.querySelector("#"+w))}}},load_module:function(e,t){var o={};o.module=e;var i=mw.settings.site_url+"api/module";mw.$(t).load_modules(i,o,(function(){window.mw_sortables_created=!1}))},delete_element:function(e,t){mw.tools.confirm(mw.settings.sorthandle_delete_confirmation_text,(function(){var o=mw.$(e);mw.wysiwyg.change(e);var i=o.parent();mw.liveEditState.record({target:i[0],value:i.html()}),o.addClass("mwfadeout"),setTimeout((function(){mw.$(e).remove(),mw.handleModule.hide(),mw.$(mw.handleModule).removeClass("mw-active-item"),mw.drag.fix_placeholders(!0),mw.liveEditState.record({target:i[0],value:i.html()}),t&&t.call()}),300)}))},grammarlyFix:function(e){var t=mw.tools.parseHtml(e).body;return mw.$("grammarly-btn",t).remove(),mw.$("grammarly-card",t).remove(),mw.$("g.gr_",t).each((function(){mw.$(this).replaceWith(this.innerHTML)})),mw.$("[data-gramm_id]",t).removeAttr("data-gramm_id"),mw.$("[data-gramm]",t).removeAttr("data-gramm"),mw.$("[data-gramm_id]",t).removeAttr("data-gramm_id"),mw.$("grammarly-card",t).remove(),mw.$("grammarly-inline-cards",t).remove(),mw.$("grammarly-popups",t).remove(),mw.$("grammarly-extension",t).remove(),t.innerHTML},saving:!1,coreSave:function(e){if(!e)return!1;$.each(e,(function(){this.html=mw.drag.grammarlyFix(this.html)})),mw.drag.saving=!0,e=JSON.stringify(e),e={data_base64:e=btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))};var t=mw.ajax({type:"POST",url:mw.settings.api_url+"save_edit",data:e,dataType:"json",success:function(e){e&&e.new_page_url&&!mw.drag.DraftSaving&&(window.parent.mw.askusertostay=!1,window.mw.askusertostay=!1,window.location.href=e.new_page_url)}});return t.always((function(){mw.drag.saving=!1})),t},parseContent:function(e){e=e||document.body;var t,o=mw.tools.parseHtml(e.innerHTML);mw.$(".element-current",o).removeClass("element-current"),mw.$(".element-active",o).removeClass("element-active"),mw.$(".disable-resize",o).removeClass("disable-resize"),mw.$(".mw-webkit-drag-hover-binded",o).removeClass("mw-webkit-drag-hover-binded"),mw.$(".module-cat-toggle-Modules",o).removeClass("module-cat-toggle-Modules"),mw.$(".mw-module-drag-clone",o).removeClass("mw-module-drag-clone"),mw.$("-module",o).removeClass("-module"),mw.$(".empty-element",o).remove(),mw.$(".empty-element",o).remove(),mw.$(".edit .ui-resizable-handle",o).remove(),mw.$("script",o).remove(),mw.tools.classNamespaceDelete("all","ui-",o,"starts"),mw.$("[contenteditable]",o).removeAttr("contenteditable");for(var i=(t=o.querySelectorAll("[contenteditable]")).length,n=0;n<i;n++)t[n].removeAttribute("contenteditable");for(i=(t=o.querySelectorAll(".module")).length,n=0;n<i;n++)null===t[n].querySelector(".edit")&&(t[n].innerHTML="");return o},htmlAttrValidate:function(e){var t=[];return $.each(e,(function(){var e=this.outerHTML;e=(e=(e=(e=(e=e.replace(/url\(&quot;/g,"url('")).replace(/jpg&quot;/g,"jpg'")).replace(/jpeg&quot;/g,"jpeg'")).replace(/png&quot;/g,"png'")).replace(/gif&quot;/g,"gif'"),t.push($(e)[0])})),t},collectData:function(e){mw.$(e).each((function(){mw.$("meta",this).remove()}));var t=(e=this.htmlAttrValidate(e)).length,o=0,i={},n={};if(t>0)for(;o<t;o++)if(i.item=e[o],mw.tools.mwattr(i.item,"rel")||(mw.$(i.item).removeClass("changed"),mw.tools.foreachParents(i.item,(function(e){var t=this.className,o=mw.tools.mwattr(this,"rel");mw.tools.hasClass(t,"edit")&&mw.tools.hasClass(t,"changed")&&o&&(i.item=this,mw.tools.stopLoop(e))}))),mw.tools.mwattr(i.item,"rel")){mw.$(i.item).removeClass("changed orig_changed"),mw.$(i.item).removeClass("module-over"),mw.$(".module-over",i.item).each((function(){mw.$(this).removeClass("module-over")})),mw.$("[class]",i.item).each((function(){var e=this.getAttribute("class");"string"==typeof e&&(e=e.trim()),e||this.removeAttribute("class")}));var a=mw.wysiwyg.cleanUnwantedTags(i.item).innerHTML,r={},l=i.item.attributes;if(l.length>0)for(var s=0,m=l.length;s<m;s++)r[l[s].nodeName]=l[s].nodeValue;var d={attributes:r,html:a};n["field_data_"+o]=d}else{var w=i.item.id?"#"+i.item.id:"";console.warn("Skipped save: .edit"+w+" element does not have rel attribute.")}return n},getData:function(e){var t=mw.drag.parseContent(e).body.querySelectorAll(".edit.changed");return mw.drag.collectData(t)},saveDisabled:!1,draftDisabled:!1,save:function(e,t,o){if(mw.trigger("beforeSaveStart",e),mw.liveedit.cssEditor&&mw.liveedit.cssEditor.publishIfChanged(),mw.drag.saveDisabled)return!1;if(!e){var i=mw.drag.parseContent().body.querySelectorAll(".edit.changed");e=mw.drag.collectData(i)}if(mw.tools.isEmptyObject(e))return!1;mw._liveeditData=e,mw.trigger("saveStart",mw._liveeditData);var n=mw.drag.coreSave(mw._liveeditData);return n.error((function(){403==n.status&&(mw.dialog({id:"save_content_error_iframe_modal",html:"<iframe id='save_content_error_iframe' style='overflow-x:hidden;overflow-y:auto;' class='mw-modal-frame' ></iframe>",width:$(window).width()-90,height:$(window).height()-90}),mw.askusertostay=!1,mw.$("#save_content_error_iframe").ready((function(){(t=document.getElementById("save_content_error_iframe").contentWindow.document).open(),t.write(n.responseText),t.close();var e=0,t=document.getElementById("save_content_error_iframe").contentWindow.document;mw.$("#save_content_error_iframe").load((function(){var o=mw.$(".challenge-form",t).length;e++,o&&2==e&&setTimeout((function(){mw.askusertostay=!1,mw.$("#save_content_error_iframe_modal").remove()}),150)}))})))})),n.success((function(e){mw.$(".edit.changed").removeClass("changed"),mw.$(".orig_changed").removeClass("orig_changed"),null!==document.querySelector(".edit.changed")?mw.drag.save():(mw.askusertostay=!1,mw.trigger("saveEnd",e)),t&&t.call(e)})),n.fail((function(e,t,i){mw.trigger("saveFailed",t,i),o&&o.call(sdata)})),n},saveDraftOld:"",DraftSaving:!1,initDraft:!1,saveDraft:function(){if(mw.drag.draftDisabled)return!1;if(mw.drag.DraftSaving)return!1;if(!mw.drag.initDraft)return!1;if(document.body.textContent!=mw.drag.saveDraftOld){mw.drag.saveDraftOld=document.body.textContent;var e=mw.drag.parseContent().body.querySelectorAll(".edit.changed"),t=mw.drag.collectData(e);if(mw.tools.isEmptyObject(t))return!1;t.is_draft=!0,mw.drag.DraftSaving=!0,mw.drag.coreSave(t).always((function(e){mw.drag.DraftSaving=!1,mw.drag.initDraft=!1,mw.trigger("saveDraftCompleted")}))}}},mw.liveedit.editFields={handleKeydown:function(){mw.$(".edit").on("keydown",(function(e){var t=9===(e.which||e.keyCode),o=t&&e.shiftKey,i=t&&!e.shiftKey;if(t&&(e.preventDefault(),m=mw.wysiwyg.validateCommonAncestorContainer(getSelection().focusNode)),i)if("LI"===m.nodeName){if((r=m.parentNode).children[0]!==m){var n=m.previousElementSibling,a=document.createElement(r.nodeName);a.appendChild(m),n.appendChild(a)}}else"TD"===m.nodeName||mw.tools.hasParentsWithTag(m,"td")?(w=(m="TD"===m.nodeName?m:mw.tools.firstParentWithTag(m,"td")).nextElementSibling)?mw.wysiwyg.cursorToElement(w,"start"):(d=m.parentNode.nextElementSibling)&&mw.wysiwyg.cursorToElement(d.querySelector("td"),"start"):mw.wysiwyg.insert_html("&nbsp;&nbsp;");else if(o){var r;if("LI"===m.nodeName){if("LI"===(r=m.parentNode).parentNode.nodeName){var l=mw.wysiwyg.listSplit(r,mw.$("li",r).index(m)),s=r.parentNode;mw.$(s).after(l.middle),l.top&&mw.$(s).append(l.top),l.bottom&&mw.$(l.middle).append(l.bottom),mw.$(r).remove()}}else if("TD"===m.nodeName||mw.tools.hasParentsWithTag(m,"td")){var m,d,w=(m="TD"===m.nodeName?m:mw.tools.firstParentWithTag(m,"td")).previousElementSibling;w?mw.wysiwyg.cursorToElement(w,"start"):(d=m.parentNode.previousElementSibling)&&mw.wysiwyg.cursorToElement(d.querySelector("td:last-child"),"start")}else{var c=getSelection().getRangeAt(0);clone=c.cloneRange(),clone.setStart(c.startContainer,c.startOffset-2),clone.setEnd(c.startContainer,c.startOffset),""===clone.cloneContents().firstChild.nodeValue.replace(/\s/g,"")&&clone.deleteContents()}}}))}},mw.$(window).on("load",(function(){mw.$(document.body).removeClass("mw-external-loading")})),mw.liveedit.editors={prepare:function(){mw.$(window).on("mouseup touchend",(function(e){var t=getSelection();if(t.rangeCount>0){var o=t.getRangeAt(0),i=mw.wysiwyg.validateCommonAncestorContainer(o.commonAncestorContainer);mw.tools.hasClass(i,"edit")||mw.tools.hasParentsWithClass(i,"edit")?mw.tools.hasClass(i,"nodrop")||mw.tools.hasParentsWithClass(i,"nodrop")?mw.wysiwyg.disableEditors():mw.wysiwyg.enableEditors():mw.wysiwyg.disableEditors()}if((t=window.getSelection()).rangeCount>0)var n=t.getRangeAt(0),a=mw.wysiwyg.validateCommonAncestorContainer(n.commonAncestorContainer);mw.tools.hasAnyOfClassesOnNodeOrParent(a,["edit","mw-admin-editor-area"])&&t.rangeCount>0&&!t.getRangeAt(0).collapsed?($.contains(e.target,a)||$.contains(a,e.target)||a===e.target)&&setTimeout((function(){var o=mw.event.page(e);if(!a.isContentEditable||t.isCollapsed||mw.tools.hasClass(a,"plain-text")||mw.tools.hasClass(a,"safe-element"))mw.smallEditorCanceled=!0,mw.smallEditor.css({visibility:"hidden"});else{if(void 0===window.getSelection().getRangeAt(0).getClientRects()[0])return;mw.smallEditorCanceled=!1;var i=o.y-mw.smallEditor.height()-window.getSelection().getRangeAt(0).getClientRects()[0].height;mw.smallEditor.css({visibility:"visible",opacity:.7,top:i>55?i:55,left:o.x+mw.smallEditor.width()<mw.$(window).width()?o.x:$(window).width()-mw.smallEditor.width()-5})}}),33):mw.smallEditor&&!mw.tools.hasParentsWithClass(e.target,"mw_small_editor")&&(mw.smallEditorCanceled=!0,mw.smallEditor.css({visibility:"hidden"})),setTimeout((function(){window.getSelection().rangecount>0&&window.getSelection().getRangeAt(0).collapsed&&void 0!==mw.smallEditor&&(mw.smallEditorCanceled=!0,mw.smallEditor.css({visibility:"hidden"}))}),39)})),mw.smallEditorOff=150,mw.$(window).on("mousemove touchmove touchstart",(function(e){if(mw.smallEditor&&!mw.isDrag&&!mw.smallEditorCanceled&&!mw.smallEditor.hasClass("editor_hover")){var t=mw.smallEditor.offset(),o=mw.event.page(e);void 0!==t&&(o.x-mw.smallEditorOff>t.left+mw.smallEditor.width()||o.y-mw.smallEditorOff>t.top+mw.smallEditor.height()||o.x+mw.smallEditorOff<t.left||o.y+mw.smallEditorOff<t.top)&&void 0!==mw.smallEditor&&(mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0)}})),mw.$(window).on("scroll",(function(e){void 0!==mw.smallEditor&&(mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0)})),mw.$("#live_edit_toolbar, #mw_small_editor").on("mousedown touchstart",(function(e){mw.$(".wysiwyg_external").empty(),"INPUT"!==e.target.nodeName&&"SELECT"!==e.target.nodeName&&"OPTION"!==e.target.nodeName&&"CHECKBOX"!==e.target.nodeName&&e.preventDefault(),void 0!==mw.smallEditor&&(mw.tools.hasParentsWithClass(e.target,"mw_small_editor")||(mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0))}))}},mw.AfterDrop=function(){this.loadNewModules=function(){mw.pauseSave=!0;var e=!1,t=mw.$(".edit .module-item"),o=0;t.each((function(i){!function(i){var n=i.parentNode,a=mw._({selector:i,done:function(e){mw.drag.fancynateLoading(e),mw.pauseSave=!1,mw.wysiwyg.init_editables(),mw.liveEditDomTree&&(mw.liveEditDomTree.refresh(n),mw.liveEditDomTree.select(n))},fail:function(){mw.$(this).remove(),mw.notification.error("Error loading module.")}},!0);a?a.always((function(){o++,t.length===o&&(mw.dragCurrent=null)})):o++,e=!0}(this)})),!0===mw.have_new_items&&(e=!0),!0===e&&(mw.isDrag||"function"==typeof callback&&callback.call(this)),mw.have_new_items=!1},this.__timeInit=null,this.init=function(){var e=this;e.__timeInit&&clearTimeout(e.__timeInit),e.__timeInit=setTimeout((function(){mw.$(".mw-drag-current-bottom, .mw-drag-current-top").removeClass("mw-drag-current-bottom mw-drag-current-top"),mw.$(".currentDragMouseOver").removeClass("currentDragMouseOver"),mw.$(".mw_drag_current").each((function(){mw.$(this).removeClass("mw_drag_current").css({visibility:"visible",opacity:""})})),mw.$(".currentDragMouseOver").removeClass("currentDragMouseOver"),mw.$(".mw-empty").not(":empty").removeClass("mw-empty"),e.loadNewModules(),mw.dropable.hide().removeClass("mw_dropable_onleaveedit")}),78)}},mw.ElementAnalyzer=function(e){this.data={dropableAction:null,currentGrabbed:null,target:null,dropablePosition:null},this.dataReset=function(){this.data={dropableAction:null,currentGrabbed:null,target:null,dropablePosition:null}},this.options=e||{},this.defaults={classes:{edit:"edit",element:"element",module:"module",noDrop:"nodrop",allowDrop:"allow-drop",emptyElement:"mw-empty",zone:"mw-zone"},rows:["mw-row","mw-ui-row","row"],columns:["mw-col","mw-ui-col","col","column","columns"],columnMatches:'[class*="col-"]',rowMatches:'[class*="row-"]'},this.settings=$.extend({},this.options,this.defaults),this.prepare=function(){this.cls=this.settings.classes,this.initCSS()},this.initCSS=function(){var e="body.dragStart ."+this.cls.noDrop+"{pointer-events: none;}body.dragStart ."+this.cls.allowDrop+"{pointer-events: all;}",t=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(t),t.innerHTML=e},this._isEditLike=function(e){e=e||this.data.target;var t=mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(e,[this.cls.edit,this.cls.module]),o=mw.tools.hasClass(e,"module")&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(e.parentNode,[this.cls.edit,this.cls.module]),i=mw.tools.firstParentOrCurrentWithAnyOfClasses(e,this.cls.edit);return(t||o)&&!mw.tools.hasClass(i,this.cls.noDrop)},this._canDrop=function(e){return e=e||this.data.target,mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(e,[this.cls.allowDrop,this.cls.noDrop])},this._layoutInLayout=function(){if(!this.data.currentGrabbed||!document.body.contains(this.data.currentGrabbed))return!1;var e="layouts"===this.data.currentGrabbed.getAttribute("data-module-name")||"layouts"===mw.dragCurrent.getAttribute("data-type"),t=mw.tools.firstMatchesOnNodeOrParent(this.data.target,['[data-module-name="layouts"]','[data-type="layouts"]']);return{target:t,result:e&&!!t}},this.canDrop=function(e){return e=e||this.data.target,this._isEditLike(e)&&this._canDrop(e)&&!this._layoutInLayout().result},this.analizePosition=function(e,t){var o=(t=t||this.data.target).offsetHeight,i=mw.$(t).offset();mw.event.page(e).y>i.top+o/2?this.data.dropablePosition="bottom":this.data.dropablePosition="top"},this.analizeActionOfElement=function(e,t){(e=e||this.data.target)||this.data.dropablePosition},this.afterAction=function(e,t){this._afterAction||(this._afterAction=new mw.AfterDrop),this._afterAction.init()},this.dropableHide=function(){},this.analizeAction=function(e,t){if(e=e||this.data.target,t=t||this.data.dropablePosition,this.helpers.isEmpty())this.data.dropableAction="append";else{var o={Around:{top:"before",bottom:"after"},Inside:{top:"prepend",bottom:"append"}};t&&(mw.tools.hasClass(e,"allow-drop")?this.data.dropableAction=o.Inside[t]:this.helpers.isElement()?this.data.dropableAction=o.Around[t]:this.helpers.isEdit()?this.data.dropableAction=o.Inside[t]:(this.helpers.isLayoutModule()||this.helpers.isModule())&&(this.data.dropableAction=o.Around[t]))}},this.action=function(e){var t=e.target;this._isEditLike(t)&&this._canDrop(t)},this.helpers={scope:this,isBlockLevel:function(e){return e=e||(this.data?this.data.target:null),mw.tools.isBlockLevel(e)},isInlineLevel:function(e){return e=e||this.data.target,mw.tools.isInlineLevel(e)},canAccept:function(e,t){var o=e.dataset("accept");if(!o)return!0;o=o.trim().split(",").map(Function.prototype.call,String.prototype.trim);var i="all";return mw.tools.hasClass(t,"module-layout")?i="layout":mw.tools.hasClass(t,"module")?i="module":mw.tools.hasClass(t,"element")&&(i="element"),"all"==i||-1!==o.indexOf(i)},getBlockElements:function(e,t){e=e||"*";var o=(t=t||document.body).querySelectorAll(e),i=0;for(final=[];i<o.length;i++)this.scope.helpers.isBlockLevel(o[i])&&final.push(o[i]);return final},getElementsLike:function(e,t){e=e||"*";var o=(t=t||document.body).querySelectorAll(e),i=0;for(final=[];i<o.length;i++)this.scope.helpers.isColLike(o[i])||this.scope.helpers.isRowLike(o[i])||this.scope.helpers.isEdit(o[i])||!this.scope.helpers.isBlockLevel(o[i])||final.push(o[i]);return final},isEdit:function(e){return e=e||this.scope.data.target,mw.tools.hasClass(e,this.scope.cls.edit)},isModule:function(e){return e=e||this.scope.data.target,mw.tools.hasClass(e,this.scope.cls.module)&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(e,[this.scope.cls.module,this.scope.cls.edit])},isElement:function(e){return e=e||this.scope.data.target,mw.tools.hasClass(e,this.scope.cls.element)},isEmpty:function(e){return e=e||this.scope.data.target,mw.tools.hasClass(e,"mw-empty")},isRowLike:function(e){var t=!1;return(e=e||this.scope.data.target).className?(t=mw.tools.hasAnyOfClasses(e,this.scope.settings.rows))||mw.tools.matches(e,this.scope.settings.rowMatches):t},isColLike:function(e){var t=!1;return(e=e||this.scope.data.target).className?(t=mw.tools.hasAnyOfClasses(e,this.scope.settings.columns))||!mw.tools.hasAnyOfClasses(e,["mw-col-container","mw-ui-col-container"])&&mw.tools.matches(e,this.scope.settings.columnMatches):t},isLayoutModule:function(e){return e=e||this.scope.data.target,!1},noop:function(){}},this.interactionTarget=function(e){for(node=this.data.target,e&&(node=node.parentNode);node&&!this.helpers.isBlockLevel(node);)node=node.parentNode;return node},this.validateInteractionTarget=function(e){if(e=e||this.data.target,!mw.tools.firstParentOrCurrentWithClass(e,this.cls.edit))return!1;for(var t=[this.cls.edit,this.cls.element,this.cls.module,this.cls.emptyElement];e&&e!==document.body;){if(mw.tools.hasAnyOfClasses(e,t))return e;e=e.parentNode}return!1},this.on=function(e,t){e=e.trim().split(" ");for(var o=0;o<e.length;o++)document.body.addEventListener(e[o],t,!1)},this.loadNewModules=function(){mw.pauseSave=!0,mw.$(".edit .module-item").each((function(e){mw._({selector:this,done:function(e){mw.drag.fancynateLoading(e),mw.pauseSave=!1,mw.wysiwyg.init_editables()},fail:function(){mw.$(this).remove(),mw.notification.error("Error loading module.")}},!0)})),mw.have_new_items,mw.have_new_items=!1},this.whenUp=function(){var e=this;this.on("mouseup touchend",(function(){e.data.currentGrabbed&&(e.data.currentGrabbed=null)}))},this.getTarget=function(e){if(e=e||this.validateInteractionTarget())return this.canDrop(e)?e:this.redirect(e)},this.redirect=function(e){e=e||this.data.target;var t=this._layoutInLayout(e);return t.result?this.validateInteractionTarget(t.target):e===document.body||e.parentNode===document.body?null:this.getTarget(e.parentNode)},this.interactionAnalizer=function(e){var t=this;if(mw.dropable.hide(),this.data.currentGrabbed){if(-1!==e.type.indexOf("touch")){var o=mw.event.page(e);t.data.target=document.elementFromPoint(o.x,o.y)}else t.data.target=e.target;if(t.interactionTarget(),t.data.target=t.getTarget(),t.data.target)t.analizePosition(e),t.analizeAction(),mw.dropable.show();else{var i=mw.dropables.findNearest(e);i.element?(t.data.target=i.element,t.data.dropablePosition=i.position,mw.dropables.findNearestException=!0,mw.dropable.show()):(mw.currentDragMouseOver=null,mw.dropable.hide(),t.dataReset())}var n=mw.$(t.data.target);mw.currentDragMouseOver=t.data.target;var a=mw.tools.firstParentOrCurrentWithClass(mw.currentDragMouseOver,"edit");if(mw.tools.classNamespaceDelete(mw.dropable[0],"mw-dropable-tagret-rel-"),a){mw.tools.addClass(mw.dropable[0],"mw-dropable-tagret-rel-"+a.getAttribute("rel"));var r=a.getAttribute("rel");mw.tools.addClass(mw.dropable[0],"mw-dropable-tagret-rel-"+r)}mw.dropables.set(t.data.dropablePosition,n.offset(),n.height(),n.width()),n[0]&&!mw.tools.hasAnyOfClasses(n[0],["mw-drag-current-"+t.data.dropablePosition])&&(mw.$(".mw-drag-current-top,.mw-drag-current-bottom").removeClass("mw-drag-current-top mw-drag-current-bottom"),mw.tools.addClass(n[0],"mw-drag-current-"+t.data.dropablePosition))}},this.whenMove=function(){var e=this;this.on("mousemove touchmove",(function(t){e.interactionAnalizer(t)}))},this.init=function(){this.prepare()},this.init()},mw.ea=new mw.ElementAnalyzer,mw.liveedit.handleCustomEvents=function(){mw.on("moduleOver ElementOver",(function(e,t,o){var i=mw.tools.firstParentOrCurrentWithAnyOfClasses(o.target,["element","module"]);i.id&&(mw.liveEditSelector.active(!0),mw.liveEditSelector.setItem(i,mw.liveEditSelector.interactors))})),mw.$(document.body).on("click",(function(e){var t=e.target;mw.tools.firstParentOrCurrentWithAnyOfClasses(t,["edit","module","element"])&&(mw.tools.firstNotInlineLevel(t),mw.liveEditSelector.select(t),mw.liveEditDomTree&&mw.liveEditDomTree.select(mw.wysiwyg.validateCommonAncestorContainer(t)))})),mw.on("DragHoverOnEmpty",(function(e,t){if($.browser.webkit){var o=mw.$(t);o.addClass("hover"),o.hasClass("mw-webkit-drag-hover-binded")||(o.addClass("mw-webkit-drag-hover-binded"),o.mouseleave((function(){o.removeClass("hover")})))}})),mw.on("IconElementClick",(function(e,t){mw.editorIconPicker.tooltip(t),setTimeout((function(){mw.wysiwyg.contentEditable(t,!1)}))})),mw.on("ComponentClick",(function(e,t,o){if("icon"!==o){if(mw.settings.live_edit_open_module_settings_in_sidebar){if(mw.log("ComponentClick"+o),!mw.liveEditSettings)return;var i=o;"element"===o&&(i="none"),"safe-element"===o&&(i="none"),"IMG"===t.nodeName&&(i="image"),mw.liveEditSettings.active&&(mw.sidebarSettingsTabs&&("module"!==i?mw.sidebarSettingsTabs.setLastClicked():mw.sidebarSettingsTabs.set(2)),mw.liveNodeSettings.set(i,t))}}else mw.editorIconPicker.tooltip(t)})),mw.on("ElementClick",(function(e,t,o){mw.$(".element-current").not(t).removeClass("element-current"),"element"===mw.liveEditSelectMode&&mw.$(t).addClass("element-current"),mw.$(".module").each((function(){mw.wysiwyg.contentEditable(this,!1)}))})),mw.on("PlainTextClick",(function(e,t){mw.wysiwyg.contentEditable(t,!0),mw.$(".module").each((function(){mw.wysiwyg.contentEditable(this,!1)}))})),mw.on("editUserIsTypingForLong",(function(e){void 0!==mw.liveEditSettings&&mw.liveEditSettings.active&&mw.liveEditSettings.hide()})),mw.on("TableTdClick",(function(e,t){if(mw.liveedit&&mw.liveedit.inline){mw.liveedit.inline.setActiveCell(t,e);var o=mw.tools.firstParentWithTag(t,"table");o&&mw.liveedit.inline.tableController(o)}})),mw.on("UserInteraction",(function(){mw.dropables.userInteractionClasses(),mw.liveEditSelector.positionSelected()})),mw.on("ElementOver moduleOver",(function(e,t){var o=null;"onElementOver"===e.type?(o=mw.tools.firstParentOrCurrentWithAnyOfClasses(t,["element"]))&&!mw.tools.hasClass("element-over",o)&&mw.tools.addClass(o,"element-over"):"moduleOver"===e.type&&(o=mw.tools.firstParentOrCurrentWithAnyOfClasses(t,["module"]))&&!mw.tools.hasClass("module-over",o)&&mw.tools.addClass(o,"module-over"),o&&mw.$(".element-over,.module-over").not(o).removeClass("element-over module-over")})),mw.on("CloneableOver",(function(e,t,o){mw.drag.onCloneableControl(t,o)}));var e=null;mw.on("ModuleBetweenModules",(function(t,o,i){clearTimeout(e),e=setTimeout((function(){0===$("#moduleinbetween").length&&(mw.tooltip({content:"To drop this element here, select Clean container first",element:o[0],position:i+"-center",skin:"dark",id:"moduleinbetween"}),setTimeout((function(){mw.$("#moduleinbetween").fadeOut((function(){mw.$(this).remove()}))}),3e3))}),1e3)}))},mw.liveedit.handleEvents=function(){mw.$(document.body).on("touchmove mousemove",(function(e){mw.liveEditSelector.interactors.active&&(mw.liveedit.data.get("move","hasModuleOrElement")||e.target!==mw.drag.plusTop&&e.target!==mw.drag.plusBottom&&mw.liveEditSelector.hideItem(mw.liveEditSelector.interactors))})),mw.$("#live-edit-dropdown-actions-content a").off("click"),mw.$(document).on("mousedown touchstart",(function(e){mw.tools.hasAnyOfClassesOnNodeOrParent(e.target,["mw-defaults","edit","element"])||mw.$(".element-current").removeClass("element-current")})),mw.$("span.edit:not('.nodrop')").each((function(){mw.tools.setTag(this,"div")})),mw.$("#mw-toolbar-css-editor-btn").click((function(){mw.liveedit.widgets.cssEditorDialog()})),mw.$("#mw-toolbar-html-editor-btn").click((function(){mw.liveedit.widgets.htmlEditorDialog()})),mw.$("#mw-toolbar-reset-content-editor-btn").click((function(){mw.tools.open_reset_content_editor()})),mw.$(document.body).on("keyup",(function(e){mw.$(".mw_master_handle").css({left:"",top:""}),mw.on.stopWriting(e.target,(function(){(mw.tools.hasClass(e.target,"edit")||mw.tools.hasParentsWithClass(this,"edit"))&&(mw.liveEditState.record({target:e.target,value:e.target.innerHTML}),mw.drag.saveDraft())}))})),mw.$(document.body).on("keydown",(function(e){if(83===e.keyCode&&e.ctrlKey){if(e.altKey)return;if(void 0!==mw.settings.live_edit_disable_keyboard_shortcuts&&!0===mw.settings.live_edit_disable_keyboard_shortcuts)return;mw.event.cancel(e,!0),mw.drag.save()}})),mw.$(document.body).on("paste",(function(e){if(mw.tools.hasClass(e.target,"plain-text")){e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}})),mw.$(document.body).on("mousedown mouseup touchstart touchend",(function(e){if("mousedown"===e.type||"touchstart"===e.type){if(!mw.wysiwyg.elementHasFontIconClass(e.target)&&!mw.tools.hasAnyOfClassesOnNodeOrParent(e.target,["tooltip-icon-picker","mw-tooltip"])){mw.editorIconPicker.tooltip("hide");try{$(mw.liveedit.widgets._iconEditor.tooltip).hide()}catch(e){}}mw.tools.hasClass(e.target,"ui-resizable-handle")||mw.tools.hasParentsWithClass(e.target,"ui-resizable-handle")?mw.tools.removeClass(document.body,"state-element"):mw.tools.addClass(document.body,"state-element"),mw.tools.hasParentsWithClass(e.target,"mw-tooltip-insert-module")||mw.tools.hasAnyOfClasses(e.target,["mw-plus-bottom","mw-plus-top"])||(mw.$(".mw-tooltip-insert-module").remove(),mw.drag.plus.locked=!1)}else mw.tools.removeClass(document.body,"state-element")})),mw.$("span.mw-powered-by").on("click",(function(e){return mw.tools.open_global_module_settings_modal("white_label/admin","mw-powered-by"),!1})),mw.$(".edit a, #mw-toolbar-right a").click((function(){var e=this;if(!e.isContentEditable&&null===e.onclick){var t=(e.getAttribute("href")||"").trim();if(t&&0!==t.indexOf("javascript:")&&0!==t.indexOf("#"))return mw.liveedit.beforeleave(this.href)}}))},mw.iframecallbacks={noop:function(){},insert_link:function(e,t,o){e.length?(t=e[1],o=e[2],e=e[0]):e.url&&(e=e.url,t=t||e.target||"_self",o=o||e.text||"_self"),e=e.trim();for(var i=["mailto:","tel:","skype:","sms:","geopoint:","whatsapp:"],n=0;n<i.length;n++)e.indexOf(i[n]);t=t||"_self";var a,r,l,s=!1;if(o&&(s=o),(a=getSelection()).rangeCount){r=a.getRangeAt(0);var m=e?"attr":"removeAttr";if(mw.wysiwyg.change(r.startContainer),mw.current_element&&"IMG"===mw.current_element.nodeName&&("A"!==mw.current_element.parentNode.nodeName?(l=document.createElement("a"),e&&(l.href=e),l.target=t,mw.$(mw.current_element).wrap(l)):(mw.$(mw.current_element.parentNode)[m]("href",e),mw.current_element.parentNode.target=t)),"A"===r.commonAncestorContainer.nodeName)return mw.$(r.commonAncestorContainer)[m]("href",e).attr("target",t),s&&mw.$(r.commonAncestorContainer).html(s),!1;var d=r.startContainer;if(window.getSelection().isCollapsed){if(mw.current_element&&"A"!==mw.current_element.nodeName){if(mw.tools.hasChildrenWithTag(mw.current_element,"a"))return mw.$(mw.tools.firstChildWithTag(mw.current_element,"a"))[m]("href",e).attr("target",t),s&&mw.$(mw.tools.firstChildWithTag(mw.current_element,"a")).html(s),!1}else if(mw.current_element&&"A"===mw.current_element.nodeName)return mw.$(mw.current_element).attr("href",e).attr("target",t),s&&mw.$(mw.current_element).html(s),!1;if(mw.tools.hasParentsWithTag(d,"a"))return mw.$(mw.tools.firstParentWithTag(d,"a"))[m]("href",e).attr("target",t),s&&mw.$(mw.tools.firstParentWithTag(d,"a")).html(s),!1;if(mw.tools.hasChildrenWithTag(d,"a"))return mw.$(mw.tools.firstChildWithTag(d,"a"))[m]("href",e).attr("target",t),s&&mw.$(mw.tools.firstChildWithTag(d,"a")).html(s),!1}var w=mw.wysiwyg.findTagAcrossSelection("a");if(w)mw.$(w)[m]("href",e),mw.$(w).attr("target",t),s&&mw.$(w).html(s);else if(window.getSelection().isCollapsed){var c='<a href="'+e+'" target="'+t+'">'+(s||e)+"</a>";mw.wysiwyg.insert_html(c)}else{(l=document.createElement("a")).href=e,l.target=t,r=(a=window.getSelection()).getRangeAt(0);try{r.surroundContents(l)}catch(t){mw.wysiwyg.execCommand("CreateLink",!1,e)}}o&&l&&(l.innerHTML=o)}},set_bg_image:function(e){return mw.wysiwyg.set_bg_image(e)},fontColor:function(e){return mw.wysiwyg.fontColor(e)},fontbg:function(e){return mw.wysiwyg.fontbg(e)},change_bg_color:function(e){return mw.wysiwyg.change_bg_color(e)},change_border_color:function(e){return mw.wysiwyg.change_border_color(e)},change_shadow_color:function(e){return mw.wysiwyg.change_shadow_color(e)},add_link_to_menu:function(){},editlink:function(e,t){mw.wysiwyg.restore_selection();var o=mw.wysiwyg.findTagAcrossSelection("a");o.href=e,mw.wysiwyg.change(o)}},(()=>{var e;mw.require("selector.js");var t=function(t,o){if(e||(e=mw.element('<div class="mw-handle-insert-target-display" />'),mw.element(document.body).append(e)),"hide"!==t){e.show();var i=$(t),n=i.offset(),a={left:n.left,width:i.outerWidth()};"top"===o?a.top=n.top:"bottom"===o&&(a.top=n.top+i.outerHeight()),e.removeClass("mw-handle-insert-target-display-top").removeClass("mw-handle-insert-target-display-bottom").addClass("top"===o?"mw-handle-insert-target-display-top":"mw-handle-insert-target-display-bottom").css(a)}else e.removeClass("mw-handle-insert-target-display-top").removeClass("mw-handle-insert-target-display-bottom").hide()},o=null,i=function(e,t){var i;if(mw.inaccessibleModules||(mw.inaccessibleModules=document.createElement("div"),mw.inaccessibleModules.className="mw-ui-btn-nav mwInaccessibleModulesMenu",document.body.appendChild(mw.inaccessibleModules),mw.$(mw.inaccessibleModules).on("mouseenter",(function(){this._hovered=!0})).on("mouseleave",(function(){this._hovered=!1}))),"moduleOver"===e.type||"ModuleClick"===e.type){var n=mw.tools.lastParentWithClass(t,"module"),a=mw.tools.firstChildWithClass(t,"module");i=mw.$(t),n&&i.offset().top-mw.$(n).offset().top<10?(t.__disableModuleTrigger=n,i.addClass("inaccessibleModule")):a&&mw.$(a).offset().top-i.offset().top<10?(a.__disableModuleTrigger=t,mw.$(a).addClass("inaccessibleModule")):i.removeClass("inaccessibleModule")}var r=mw.$(".inaccessibleModule",t);if(0===r.length){var l=mw.tools.firstParentWithClass(t,"module");l&&i.offset().top-mw.$(l).offset().top<10&&(r=mw.$([t]),t=l,i=mw.$(t))}if("ModuleClick"===e.type&&mw.liveEditSelector.select(t),r.length&&!mw.inaccessibleModules._hovered&&(mw.inaccessibleModules.innerHTML=""),r.each((function(){var e=document.createElement("span");e.className="mw-handle-item mw-ui-btn mw-ui-btn-small";var t=mw.$(this).attr("data-type")||mw.$(this).attr("type");if(t){var o=mw.live_edit.registry[t]?mw.live_edit.registry[t].title:t;o=o.replace(/\_/," "),e.innerHTML=mw.live_edit.getModuleIcon(t)+o;var i=this;e.onclick=function(){mw.tools.module_settings(i)},mw.inaccessibleModules.appendChild(e)}})),r.length>0){var s=mw.$(t).offset();mw.tools.collision(t,mw.handleModule.wrapper)&&(s.top=parseFloat(mw.handleModule.wrapper.style.top),s.left=parseFloat(mw.handleModule.wrapper.style.left)),mw.inaccessibleModules.style.top=s.top+"px",mw.inaccessibleModules.style.left=s.left+"px",clearTimeout(o),mw.$(mw.inaccessibleModules).show()}else o=setTimeout((function(){mw.inaccessibleModules._hovered||mw.$(mw.inaccessibleModules).hide()}),3e3);return i[0]},n={};mw.Handle=function(e){this.options=e||{};var t=this;this._visible=!0,this.visible=function(){return this._visible},this.createWrapper=function(){this.wrapper=document.createElement("div"),this.wrapper.id=this.options.id||"mw-handle-"+mw.random(),this.wrapper.className="mw-defaults mw-handle-item "+(this.options.className||"mw-handle-type-default"),this.wrapper.contenteditable=!1,mw.$(this.wrapper).on("mousedown",(function(){mw.tools.addClass(this,"mw-handle-item-mouse-down")})),mw.$(document).on("mouseup",(function(){mw.tools.removeClass(t.wrapper,"mw-handle-item-mouse-down")})),document.body.appendChild(this.wrapper)},this.create=function(){this.createWrapper(),this.createHandler(),this.createMenu()},this.setTitle=function(e,t){this.handleIcon.innerHTML=e,this.handleTitle.innerHTML=t},this.hide=function(){return mw.$(this.wrapper).hide().removeClass("active"),this._visible=!1,this},this.show=function(){return mw.$(this.wrapper).show(),this._visible=!0,this},this.createHandler=function(){this.handle=document.createElement("span"),this.handleIcon=document.createElement("span"),this.handleTitle=document.createElement("span"),this.handle.className="mw-handle-handler",this.handleIcon.dataset.tip="Drag to rearrange",this.handleIcon.className="tip mw-handle-handler-icon",this.handleTitle.className="mw-handle-handler-title",this.handle.appendChild(this.handleIcon),this.createButtons(),this.handle.appendChild(this.handleTitle),this.wrapper.appendChild(this.handle),this.handleTitle.onclick=function(){mw.$(t.wrapper).toggleClass("active")},mw.$(document.body).on("click",(function(e){mw.tools.hasParentWithId(e.target,t.wrapper.id)||mw.$(t.wrapper).removeClass("active")}))},this.menuButton=function(e){var o=document.createElement("span");if(o.className="mw-handle-menu-item",e.icon){var i=e.icon;0===i.indexOf("mdi-")&&(i="mdi "+i);var n=document.createElement("span");n.className=i+" mw-handle-menu-item-icon",o.appendChild(n)}return o.appendChild(document.createTextNode(e.title)),e.className&&(o.className+=" "+e.className),e.id&&(o.id=e.id),e.action&&(o.onmousedown=function(e){e.preventDefault()},o.onclick=function(o){o.preventDefault(),e.action.call(t,o,this,e),t.hide()}),o},this._defaultButtons=[],this.createMenuDynamicHolder=function(e){var t=document.createElement("div");return t.className="mw-handle-menu-dynamic"+(e.className?" "+e.className:""),t},this.createMenu=function(){if(this.menu=document.createElement("div"),this.menu.className="mw-handle-menu "+(this.options.menuClass?this.options.menuClass:"mw-handle-menu-default"),this.options.menu)for(var e=0;e<this.options.menu.length;e++)"{dynamic}"!==this.options.menu[e].title?this.menu.appendChild(this.menuButton(this.options.menu[e])):this.menu.appendChild(this.createMenuDynamicHolder(this.options.menu[e]));this.wrapper.appendChild(this.menu)},this.createButton=function(e){var o=document.createElement("span");return o.className="tip mdi "+e.icon+(e.className?" "+e.className:""),o.dataset.tip=e.title,e.hover&&(o.addEventListener("mouseenter",e.hover[0],!1),o.addEventListener("mouseleave",e.hover[1],!1)),o.onclick=function(){mw.tools.removeClass(this,"active"),e.action(this),t.hide()},o},this.createButtons=function(){if(this.buttonsHolder=document.createElement("div"),this.buttonsHolder.className="mw-handle-buttons",this.options.buttons)for(var e=0;e<this.options.buttons.length;e++)this.buttonsHolder.appendChild(this.createButton(this.options.buttons[e]));this.handle.appendChild(this.buttonsHolder)},this.create(),this.hide()},mw._activeModuleOver={module:null,element:null},mw._initHandles={getNodeHandler:function(e){return mw._activeElementOver===e?mw.handleElement:mw._activeModuleOver===e?mw.handleModule:mw._activeRowOver===e?mw.handleColumns:void 0},getAllNodes:function(e){var t=[mw._activeModuleOver,mw._activeRowOver,mw._activeElementOver];return t.filter((function(e){return!!e&&1===e.nodeType}))},getAll:function(e){var t=[mw.handleModule,mw.handleModuleActive,mw.handleColumns,mw.handleElement];return(t=e?t.filter((function(t){return t!==e})):t).filter((function(e){if(e)return e.visible()}))},hideAll:function(e){this.getAll(e).forEach((function(e){e.hide()}))},collide:function(e,t){return!(e.y+e.height<t.y||e.y>t.y+t.height||e.x+e.width<t.x||e.x>t.x+t.width)},_manageCollision:!1,manageCollision:function(){var e=this,t=[];e.getAll().forEach((function(o){var i,n=o;e.getAll(o).forEach((function(a){i=n.wrapper.getBoundingClientRect();var r=a.wrapper.getBoundingClientRect();if(e.collide(i,r)){t.push(a);var l=a===mw.handleElement?10:0;a.wrapper.style.top=parseInt(n.wrapper.style.top,10)+l+"px",a.wrapper.style.left=parseInt(n.wrapper.style.left,10)+i.width+10+"px",n=o}}))}));var o=document.querySelector(".mw-cloneable-control");o&&e.getAll().forEach((function(t){masterRect=t.wrapper.getBoundingClientRect();var i=o.getBoundingClientRect();e.collide(masterRect,i)&&(o.style.top=t.wrapper.style.top,o.style.left=parseInt(t.wrapper.style.left,10)+masterRect.width+10+"px")}))},elements:function(){mw.handleElement=new mw.Handle({id:"mw-handle-item-element",className:"mw-handle-type-default",buttons:[{title:mw.lang("Insert"),icon:"mdi-plus-circle",className:"mw-handle-insert-button",hover:[function(e){t(mw._activeElementOver,mw.handleElement.positionedAt)},function(e){t("hide")}],action:function(e){if(!mw.tools.hasClass(e,"active")){mw.tools.addClass(e,"active"),mw.drag.plus.locked=!0,mw.$(".mw-tooltip-insert-module").remove(),mw.drag.plusActive=this===mw.drag.plusTop?"top":"bottom";var t=new mw.ToolTip({content:document.getElementById("plus-modules-list").innerHTML,element:e,position:mw.drag.plus.tipPosition(this.currentNode),template:"mw-tooltip-default mw-tooltip-insert-module",id:"mw-plus-tooltip-selector",overlay:!0});t.on("removed",(function(){mw.drag.plus.locked=!1})),mw._initHandles.hideAll();var o=t.tooltip.get(0);setTimeout((function(){$("#mw-plus-tooltip-selector").addClass("active").find(".mw-ui-searchfield").focus()}),10),mw.tabs({nav:o.querySelectorAll(".mw-ui-btn"),tabs:o.querySelectorAll(".module-bubble-tab")}),mw.$(".mw-ui-searchfield",o).on("input",(function(){0===mw.drag.plus.search(this.value,o)?mw.$(".module-bubble-tab-not-found-message").html(mw.msg.no_results_for+": <em>"+this.value+"</em>").show():mw.$(".module-bubble-tab-not-found-message").hide()})),mw.$("#mw-plus-tooltip-selector li").each((function(){this.onclick=function(){var e=mw.$(this).attr("data-module-name"),o={class:this.className};"layout"===e&&(o.template=mw.$(this).attr("template")),mw.module.insert(mw._activeElementOver,e,o,mw.handleElement.positionedAt),t.remove()}}))}}}],menu:[{title:"Edit HTML",icon:"mw-icon-code",action:function(){mw.editSource(mw._activeElementOver)}},{title:"Edit Style",icon:"mw-icon-edit",action:function(){mw.liveEditSettings.show(),mw.sidebarSettingsTabs.set(3),mw.cssEditorSelector?(mw.liveEditSelector.active(!0),mw.liveEditSelector.select(mw._activeElementOver)):mw.$(mw.liveEditWidgets.cssEditorInSidebarAccordion()).on("load",(function(){setTimeout((function(){mw.liveEditSelector.active(!0),mw.liveEditSelector.select(mw._activeElementOver)}),333)})),mw.liveEditWidgets.cssEditorInSidebarAccordion()}},{title:"Remove",icon:"mw-icon-bin",className:"mw-handle-remove",action:function(){mw.drag.delete_element(mw._activeElementOver),mw.handleElement.hide()}}]}),mw.$(mw.handleElement.wrapper).on("mouseenter",(function(){mw.liveEditSelector.select(mw._activeElementOver)})),mw.$(mw.handleElement.wrapper).draggable({handle:mw.handleElement.handleIcon,cursorAt:{},start:function(){mw.isDrag=!0,mw.dragCurrent=mw.ea.data.currentGrabbed=mw._activeElementOver,n.start=mw.dragCurrent.parentNode,mw.dragCurrent.id||(mw.dragCurrent.id="element_"+mw.random()),mw.$(mw.dragCurrent).invisible().addClass("mw_drag_current"),mw.trigger("AllLeave"),mw.drag.fix_placeholders(),mw.$(document.body).addClass("dragStart"),mw.image_resizer._hide(),mw.wysiwyg.change(mw.dragCurrent),mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0},stop:function(){mw.$(document.body).removeClass("dragStart"),mw.liveEditDomTree&&mw.liveEditDomTree.refresh(n.start)}}),mw.$(mw.handleElement.wrapper).on("click",(function(){$(mw._activeElementOver).hasClass("element-current")||(mw.$(".element-current").removeClass("element-current"),"IMG"===mw._activeElementOver.nodeName?mw.trigger("ImageClick",mw._activeElementOver):mw.trigger("ElementClick",mw._activeElementOver))})),mw.on("ElementOver",(function(e,t,o){if(mw._activeElementOver=t,mw.$(".mw_edit_delete, .mw_edit_delete_element, .mw-sorthandle-moveit, .column_separator_title").show(),!mw.ea.canDrop(t))return mw.$(".mw_edit_delete, .mw_edit_delete_element, .mw-sorthandle-moveit, .column_separator_title").hide(),!1;var i=mw.$(t),n=i.offset(),a=parseFloat(i.css("paddingLeft")),r=n.left;mw.tools.hasClass(t,"jumbotron")&&(r+=a),r<0&&(r=0);var l='<span class="mw-handle-element-title-icon "   ><span class="mdi mdi-drag tip" data-tip="'+mw.lang("")+'"></span></span>';mw.handleElement.setTitle(l,'<i class="mdi mdi-cog mw-handle-handler-settings-icon"></i>'),i.hasClass("allow-drop")?mw.handleElement.hide():mw.handleElement.show(),mw.handleElement.positionedAt="top";var s=n.top-30,m=i.height();o.pageY>n.top+m/2&&(s=n.top+m,mw.handleElement.positionedAt="bottom"),mw.$(mw.handleElement.wrapper).css({top:s,left:r}).removeClass("active"),t.id||(t.id="element_"+mw.random()),mw.dropable.removeClass("mw_dropable_onleaveedit"),mw._initHandles.manageCollision()}))},modules:function(){var e=[{title:mw.lang("Edit"),icon:"mdi-pencil",action:function(){mw.drag.module_settings(mw._activeModuleOver,"admin"),mw.handleModule.hide()}},{title:mw.lang("Insert"),className:"mw-handle-insert-button",icon:"mdi-plus-circle",hover:[function(e){t(mw._activeModuleOver,mw.handleModule.positionedAt)},function(e){t("hide")}],action:function(e){mw.handleModule.isLayout?mw.layoutPlus.showSelectorUI(e):mw.drag.plus.rendModules(e)}}],o={id:"mw-handle-item-module",buttons:e,menu:[{title:mw.lang("Edit"),icon:"mdi-pencil",action:function(){mw.drag.module_settings(mw._activeModuleOver,"admin"),mw.handleModule.hide()}},{title:"Move Up",icon:"mdi mdi-chevron-double-up",className:"mw_handle_module_up",action:function(){mw.drag.replace($(mw._activeModuleOver),"prev"),mw.handleModule.hide()}},{title:"Move Down",icon:"mdi mdi-chevron-double-down",className:"mw_handle_module_down",action:function(){mw.drag.replace($(mw._activeModuleOver),"next"),mw.handleModule.hide()}},{title:"{dynamic}",className:"mw_handle_module_submodules"},{title:"{dynamic}",className:"mw_handle_module_spacing"},{title:"Reset",icon:"mw-icon-reload",className:"mw-handle-remove",action:function(){mw._activeModuleOver&&mw._activeModuleOver.id&&mw.tools.confirm_reset_module_by_id(mw._activeModuleOver.id)}},{title:"Remove",icon:"mw-icon-bin",className:"mw-handle-remove",action:function(){mw.drag.delete_element(mw._activeModuleOver),mw.handleModule.hide()}}]},a={id:"mw-handle-item-module-active",buttons:e,menu:[{title:"Settings",icon:"mw-icon-gear",action:function(){mw.drag.module_settings(r(),"admin"),$(mw.handleModuleActive.wrapper).removeClass("active")}},{title:"Move Up",icon:"mdi mdi-chevron-double-up",className:"mw_handle_module_up",action:function(){mw.drag.replace($(r()),"prev")}},{title:"Move Down",icon:"mdi mdi-chevron-double-down",className:"mw_handle_module_down",action:function(){mw.drag.replace($(r()),"next")}},{title:"{dynamic}",className:"mw_handle_module_submodules"},{title:"{dynamic}",className:"mw_handle_module_spacing"},{title:"Reset",icon:"mw-icon-reload",className:"mw-handle-remove",action:function(){mw._activeModuleOver&&mw._activeModuleOver.id&&mw.tools.confirm_reset_module_by_id(mw._activeModuleOver.id)}},{title:"Remove",icon:"mw-icon-bin",className:"mw-handle-remove",action:function(){mw.drag.delete_element(r()),mw.handleModuleActive.hide()}}]},r=function(){var e=mw.liveEditSelector.activeModule;return e&&1===e.nodeType?e:mw.handleModuleActive._target?mw.handleModuleActive._target:void 0},l=function(e,t){return{handle:t.handleIcon,distance:20,cursorAt:{},start:function(){mw.isDrag=!0,mw.dragCurrent=e(),n.start=mw.dragCurrent.parentNode,mw.dragCurrent.id||(mw.dragCurrent.id="module_"+mw.random()),mw.liveEditTools.isLayout(mw.dragCurrent)?mw.$(mw.dragCurrent).css({opacity:0}).addClass("mw_drag_current"):mw.$(mw.dragCurrent).invisible().addClass("mw_drag_current"),mw.trigger("AllLeave"),mw.drag.fix_placeholders(),mw.$(document.body).addClass("dragStart"),mw.image_resizer._hide(),mw.wysiwyg.change(mw.dragCurrent),mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0},stop:function(){mw.$(document.body).removeClass("dragStart"),mw.liveEditDomTree&&mw.liveEditDomTree.refresh(n.start)}}};mw.handleModule=new mw.Handle(o),mw.handleModuleActive=new mw.Handle(a),mw.handleModule.type="hover",mw.handleModuleActive.type="active",mw.handleModule._hideTime=null,mw.$(mw.handleModule.wrapper).draggable(l((function(){if(mw._activeModuleOver)return mw._activeModuleOver}),mw.handleModule)).on("mousedown",(function(e){mw.liveEditSelectMode="none"})),mw.$(mw.handleModuleActive.wrapper).draggable(l(r,mw.handleModuleActive)).on("mousedown",(function(e){mw.liveEditSelectMode="none"}));var s=function(e,t,o,n){var a,r;o._element=t,"hover"===o.type?(a=i(e,t)||t,mw._activeModuleOver=a):(a=i(e,t)||t,o._target=t),mw.$(".mw-handle-menu-dynamic",o.wrapper).empty(),mw.$(".mw_handle_module_up,.mw_handle_module_down").hide();var l=a&&"layouts"===a.getAttribute("data-type");o.isLayout=l,o.handle.classList[l?"add":"remove"]("mw-handle-target-layout"),l&&(r=mw.$(a),mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(r[0].parentNode,["edit","module"])&&(r.prev('[data-type="layouts"]')[0]&&mw.$(".mw_handle_module_up").show(),r.next('[data-type="layouts"]')[0]&&mw.$(".mw_handle_module_down").show()));var s=mw.$(a),m=s.offset(),d=(s.width(),parseFloat(s.css("paddingLeft"))),w=document.querySelector("#live_edit_toolbar"),c=w?w.offsetHeight:0;if(mw.templateTopFixed){var u=document.querySelector(mw.templateTopFixed);u&&!u.contains(s[0])&&(c+=u.offsetHeight)}var g=m.top;g<c&&(g=c);var h=mw.$(window).scrollTop();g<h+c&&(g=h+c,s[0].offsetHeight<100&&(g=m.top+s[0].offsetHeight));var p=m.left+d;p<0&&(p=0);var f=g,v=mw.$(w),y=v.offset(),_=s.outerHeight();f<y.top+v.height()&&(f=m.top+_-(_>100?0:o.wrapper.clientHeight)),"layouts"===s.attr("data-type")&&(f=m.top+10,p+=10);var b=s.height();if(o.positionedAt="top",n.pageY>m.top+b/2&&(f+=b,o.positionedAt="bottom"),clearTimeout(o._hideTime),o.show(),mw.$(o.wrapper).removeClass("active").css({top:f,left:p}).addClass("mw-active-item"),mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(a.parentNode,["edit","module"])&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(a,["allow-drop","nodrop"])?mw.$(o.wrapper).removeClass("mw-handle-no-drag"):mw.$(o.wrapper).addClass("mw-handle-no-drag"),s){var C=s.dataset("mw-title"),S=(s.attr("id"),s.dataset("type")||s.attr("type"));if(void 0!==S){var E=s[0].querySelector(".cloneable");(E||mw.tools.hasClass(s[0],"cloneable"))&&($(E).offset().top-s.offset().top<20?mw.tools.addClass(mw.drag._onCloneableControl,"mw-module-near-cloneable"):mw.tools.removeClass(mw.drag._onCloneableControl,"mw-module-near-cloneable"));var N=mw.live_edit.getModuleIcon(S),T=C||mw.msg.settings;if(o.setTitle(N,T),o.handleTitle.dataset.tip=mw.lang("Module")+": "+T,o.handleTitle.classList.add("tip"),o){if(mw.tools.classNamespaceDelete(o,"module-active-"),mw.tools.addClass(o,"module-active-"+S.replace(/\//g,"-")),mw.live_edit_module_settings_array&&mw.live_edit_module_settings_array[S]){document.createElement("div").className="mw_edit_settings_multiple_holder";var M=mw.live_edit_module_settings_array[S];mw.$(M).each((function(){if(this.view){var e=document.createElement("a");e.className="mw_edit_settings_multiple",e.title=this.title,e.draggable="false";var t="mw_edit_settings_multiple_btn_"+mw.random();e.id=t,this.type&&"tooltip"===this.type?e.href='javascript:mw.drag.current_module_settings_tooltip_show_on_element("'+t+'","'+this.view+'", "tooltip"); void(0);':e.href='javascript:mw.drag.module_settings(undefined,"'+this.view+'"); void(0);';var i="";this.icon&&(i='<i class="mw-edit-module-settings-tooltip-icon '+this.icon+'"></i>'),e.innerHTML=i+'<span class="mw-edit-module-settings-tooltip-btn-title">'+this.title+"</span>",mw.$(".mw_handle_module_spacing",o.wrapper).append(e)}}))}a.id||(a.id="module_"+mw.random()),mw._initHandles.manageCollision()}}}};mw.on("ModuleClick",(function(e,t,o){mw.handleModule.hide(),s(e,t,mw.handleModuleActive,o)})),mw.on("moduleOver",(function(e,t,o){if(mw.handleModuleActive._element!==t){s(e,t,mw.handleModule,o),mw._activeModuleOver===mw.handleModuleActive._target&&mw.handleModule.hide();var i=[];mw.$(".module",t).each((function(){var e=this.getAttribute("data-type"),t=!!mw.live_edit.registry[e]&&mw.live_edit.registry[e].title,o=mw.live_edit.getModuleIcon(e);if(o||(o='<span class="mw-icon-gear mw-handle-menu-item-icon"></span>'),t){var n='<span class="mw-handle-menu-item dynamic-submodule-handle" data-module="'+this.id+'">'+o+t.replace(/_/g," ")+"</span>";i.push(n)}}));var n=mw.$(".mw_handle_module_submodules");n.empty(),$.each(i,(function(){n.append(this)})),mw.$(".text-background",t).each((function(){var e=this;$.each([0,1],(function(t){var o=document.createElement("span");o.className="mw-handle-menu-item text-background-handle",o.innerHTML='<span class="mw-icon-gear mw-handle-menu-item-icon"></span>background text',o.__for=e,n.eq(t).append(o)}))})),mw.$(".text-background-handle").on("click",(function(){var e=mw.$('<button class="mw-ui-btn mw-ui-btn-medium mw-ui-btn-info pull-right">OK</button>'),t=mw.$('<button class="mw-ui-btn mw-ui-btn-medium pull-left">Cancel</button>'),o=mw.$("<div></div>"),i=$('<textarea class="mw-ui-field w100" style="height: 200px"/>'),n=this.__for;i.val(mw.$(n).html()),o.append(t),o.append(e);var a=mw.dialog({content:i,footer:o});e.on("click",(function(){mw.liveEditState.record({target:n,value:n.innerHTML}),mw.$(n).html(i.val()),a.remove(),mw.liveEditState.record({target:n,value:n.innerHTML})})),t.on("click",(function(){a.remove()}))})),mw.$(".dynamic-submodule-handle").on("click",(function(){mw.tools.module_settings("#"+this.dataset.module)}))}}))},columns:function(){mw.handleColumns=new mw.Handle({id:"mw-handle-item-columns",menu:[{title:"One column",action:function(){mw.drag.create_columns(this,1)}},{title:"2 columns",action:function(){mw.drag.create_columns(this,2)}},{title:"3 columns",action:function(){mw.drag.create_columns(this,3)}},{title:"4 columns",action:function(){mw.drag.create_columns(this,4)}},{title:"5 columns",action:function(){mw.drag.create_columns(this,5)}},{title:"Remove",icon:"mw-icon-bin",className:"mw-handle-remove",action:function(){mw.drag.delete_element(mw._activeRowOver,(function(){mw.$(mw.drag.columns.resizer).hide(),mw.handleColumns.hide()}))}}]}),mw.handleColumns.setTitle('<span class="mw-handle-columns-icon"></span>',""),mw.$(mw.handleColumns.wrapper).draggable({handle:mw.handleColumns.handleIcon,cursorAt:{},start:function(){mw.isDrag=!0;var e=mw._activeRowOver;mw.dragCurrent=mw.ea.data.currentGrabbed=e,n.start=mw.dragCurrent.parentNode,""==mw.dragCurrent.id&&(mw.dragCurrent.id="element_"+mw.random()),mw.$(mw.dragCurrent).invisible().addClass("mw_drag_current"),mw.trigger("AllLeave"),mw.drag.fix_placeholders(),mw.$(document.body).addClass("dragStart"),mw.image_resizer._hide(),mw.wysiwyg.change(mw.dragCurrent),mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0,mw.$(mw.drag.columns.resizer).hide()},stop:function(){mw.$(document.body).removeClass("dragStart"),mw.liveEditDomTree&&mw.liveEditDomTree.refresh(n.start)}}),mw.on("RowOver",(function(e,t){mw._activeRowOver=t;var o=mw.$(t).offset(),i=o.top-35,n=o.left;i<55&&null!==document.getElementById("live_edit_toolbar")&&(i=55,n-=100),i<0&&null===document.getElementById("live_edit_toolbar")&&(i=0),mw.handleColumns.show(),mw.$(mw.handleColumns.wrapper).css({top:i,left:n}),mw._initHandles.manageCollision();var a=mw.$(t).children(".mw-col").length;mw.$("a.mw-make-cols").removeClass("active"),mw.$("a.mw-make-cols").eq(a-1).addClass("active"),t.id||(t.id="element_row_"+mw.random())}))},nodeLeave:function(){mw.on("ElementLeave",(function(e,t){mw.handleElement.hide()})),mw.on("ModuleLeave",(function(e,t){clearTimeout(mw.handleModule._hideTime),mw.handleModule._hideTime=setTimeout((function(){mw.handleModule.hide()}),3e3)})),mw.on("RowLeave",(function(e,t){}))}},$(document).ready((function(){mw._initHandles.modules(),mw._initHandles.elements(),mw._initHandles.columns(),mw._initHandles.nodeLeave()}))})(),mw.liveedit.initLoad=function(){setTimeout((function(){mw.$(".mw-dropdown_type_navigation a").each((function(){var e=mw.$(this),t=e.parent();e.attr("href","javascript:;");var o=t.dataset("category-id");t.attr("value",o)})),mw.$("#module_category_selector").change((function(){var e=mw.$(this).getDropdownValue();if("all"===e)return mw.$(".list-modules li").show(),!1;-1!==e&&"-1"!==e&&mw.liveedit.toolbar_sorter(Modules_List_modules,e)})),mw.$("#elements_category_selector").change((function(){var e=mw.$(this).getDropdownValue();if("all"===e)return mw.$(".list-elements li").show(),!1;-1!==e&&"-1"!==e&&mw.liveedit.toolbar_sorter(Modules_List_elements,e)})),mw.interval("regular-mode",(function(){mw.$('.safe-element[class*="mw-micon-"]').removeClass("safe-element")}))}),100),mw.wysiwyg.prepareContentEditable(),mw.image.resize.init(".element-image"),mw.$(document.body).on("mousedown touchstart",(function(e){if(0===mw.$(".editor_hover").length&&(mw.$(mw.wysiwyg.external).empty().css("top","-9999px"),mw.$(document.body).removeClass("hide_selection")),mw.tools.hasClass(e.target,"mw_handle_row")||mw.tools.hasParentsWithClass(e.target,"mw_handle_row")||mw.tools.hasClass(e.target,"mw-row")||mw.tools.hasParentsWithClass(e.target,"mw-row")||mw.$(".mw-row").each((function(){this.clicked=!1})),mw.tools.hasClass(e.target,"mw-row"))mw.$(".mw-row").each((function(){this!==e.target&&(this.clicked=!1)})),e.target.clicked=!0;else if(mw.tools.hasParentsWithClass(e.target,"mw-row")){var t=mw.tools.firstParentWithClass(e.target,"mw-row");mw.$(".mw-row").each((function(){this!==t&&(this.clicked=!1)})),t.clicked=!0}})),mw.$(document.body).on("mouseup touchend",(function(e){mw.target.item=e.target,mw.target.tag=e.target.tagName.toLowerCase(),mw.mouseDownOnEditor=!1,mw.SmallEditorIsDragging=!1,mw.image.isResizing||"img"===mw.target.tag||e.target===mw.image_resizer||mw.tools.hasClass(mw.target.item.className,"image_change")||mw.tools.hasClass(mw.target.item.parentNode.className,"image_change")||!mw.$(mw.image_resizer).hasClass("active")||mw.image_resizer._hide()})),mw.liveedit.toolbar.prepare(),mw.liveedit.toolbar.fixPad(),mw.liveedit.editors.prepare(),mw.liveedit.toolbar.setEditor()},mw.liveedit.initReady=function(){mw.liveedit.data.init(),mw.liveEditSelector=new mw.Selector({root:document.body,autoSelect:!1}),mw.paddingCTRL=new mw.paddingEditor({}),mw.drag.create(),mw.liveedit.editFields.handleKeydown(),mw.dragSTOPCheck=!1;for(var e=document.querySelectorAll('[field="title"]'),t=e.length,o=0;o<t;o++)mw.$(e[o]).addClass("nodrop");mw.wysiwyg.init_editables(),mw.wysiwyg.prepare(),mw.wysiwyg.init(),mw.ea=mw.ea||new mw.ElementAnalyzer},mw.liveedit.inline={bar:function(e){if(void 0===e)return!1;if(0===mw.$("#"+e).length){var t=document.createElement("div");return t.id=e,mw.wysiwyg.contentEditable(t,!1),t.className="mw-defaults mw-inline-bar",document.body.appendChild(t),t}return mw.$("#"+e)[0]},tableControl:!1,tableController:function(e,t){void 0!==t&&t.stopPropagation(),!1===mw.liveedit.inline.tableControl&&(mw.liveedit.inline.tableControl=mw.liveedit.inline.bar("mw-inline-tableControl"),mw.liveedit.inline.tableControl.innerHTML='<ul class="mw-ui-box mw-ui-navigation mw-ui-navigation-horizontal"><li><a href="javascript:;">Insert<span class="mw-icon-dropdown"></span></a><ul><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.insertRow(\'above\', mw.liveedit.inline.activeCell);">Row Above</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.insertRow(\'under\', mw.liveedit.inline.activeCell);">Row Under</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.insertColumn(\'left\', mw.liveedit.inline.activeCell)">Column on left</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.insertColumn(\'right\', mw.liveedit.inline.activeCell)">Column on right</a></li></ul></li><li><a href="javascript:;">Style<span class="mw-icon-dropdown"></span></a><ul><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.setStyle(\'mw-wysiwyg-table\', mw.liveedit.inline.activeCell);">Bordered</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.setStyle(\'mw-wysiwyg-table-zebra\', mw.liveedit.inline.activeCell);">Bordered Zebra</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.setStyle(\'mw-wysiwyg-table-simple\', mw.liveedit.inline.activeCell);">Simple</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.setStyle(\'mw-wysiwyg-table-simple-zebra\', mw.liveedit.inline.activeCell);">Simple Zebra</a></li></ul></li><li><a href="javascript:;">Delete<span class="mw-icon-dropdown"></span></a><ul><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.deleteRow(mw.liveedit.inline.activeCell);">Row</a></li><li><a href="javascript:;" onclick="mw.liveedit.inline.tableManager.deleteColumn(mw.liveedit.inline.activeCell);">Column</a></li></ul></li></ul>');var o=mw.$(e).offset();mw.$(mw.liveedit.inline.tableControl).css({top:o.top-45,left:o.left,display:"block"})},activeCell:null,setActiveCell:function(e,t){mw.tools.hasClass(e.className,"tc-activecell")||(mw.$(".tc-activecell").removeClass("tc-activecell"),mw.$(e).addClass("tc-activecell"),mw.liveedit.inline.activeCell=e)},tableManager:{insertColumn:function(e,t){if(null===(t=mw.$(t)[0]))return!1;e=e||"right";for(var o=mw.$(t.parentNode.parentNode).children("tr"),i=0,n=o.length,a=mw.tools.index(t);i<n;i++){var r=o[i];t=mw.$(r).children("td")[a],"left"!=e&&"both"!=e||mw.$(t).before("<td>&nbsp;</td>"),"right"!=e&&"both"!=e||mw.$(t).after("<td>&nbsp;</td>")}},insertRow:function(e,t){if(null===(t=mw.$(t)[0]))return!1;e=e||"under";for(var o=t.parentNode,i=0,n=mw.$(o).children("td").length,a="";i<n;i++)a+="<td>&nbsp;</td>";a="<tr>"+a+"</tr>","under"!=e&&"both"!=e||mw.$(o).after(a),"above"!=e&&"both"!=e||mw.$(o).before(a)},deleteRow:function(e){mw.$(e.parentNode).remove()},deleteColumn:function(e){for(var t=mw.tools.index(e),o=e.parentNode.parentNode,i=mw.$(o).children("tr"),n=i.length,a=0;a<n;a++){var r=i[a];mw.$(r.getElementsByTagName("td")[t]).remove()}},setStyle:function(e,t){var o=mw.tools.firstParentWithTag(t,"table");mw.tools.classNamespaceDelete(o,"mw-wysiwyg-table"),mw.$(o).addClass(e)}}},mw.layoutPlus={create:function(){this._top=$('<span class="mw-defaults mw-layout-plus mw-layout-plus-top">Add Layout</span>'),this._bottom=$('<span class="mw-defaults mw-layout-plus mw-layout-plus-bottom">Add Layout</span>'),mw.$(document.body).append(this._top).append(this._bottom),this._top.on("mouseenter",(function(){mw.tools.addClass(document.body,"body-mw-layout-plus-hover"),mw.liveEditSelector.select(mw.layoutPlus._active)})),this._top.on("mouseleave",(function(){mw.tools.removeClass(document.body,"body-mw-layout-plus-hover")})),this._bottom.on("mouseenter",(function(){mw.tools.addClass(document.body,"body-mw-layout-plus-hover"),mw.liveEditSelector.select(mw.layoutPlus._active)})),this._bottom.on("mouseleave",(function(){mw.tools.removeClass(document.body,"body-mw-layout-plus-hover")}))},hide:function(){this._top.css({top:-999,left:-999}),this._bottom.css({top:-999,left:-999}),this.pause=!1},pause:!1,_active:null,position:function(){var e=mw.$(this._active),t=e.offset(),o=t.left+e.outerWidth()/2;this._top.css({top:t.top-20,left:o}),this._bottom.css({top:t.top+e.outerHeight(),left:o})},_prepareList:function(e,t){var o=this,i=mw.$(".modules-list li",e);mw.$("input",e).on("input",(function(){mw.tools.search(this.value,i,(function(e){$(this)[e?"show":"hide"]()}))})),mw.$(".modules-list li",e).on("click",(function(){var i=mw.id("mw-layout-"),n='<div id="'+i+'"></div>',a=mw.$(mw.layoutPlus._active);a[t](n),a.attr("data-module-name");var r=$(this).attr("template"),l={class:mw.layoutPlus._active.className,template:r};mw.load_module("layouts","#"+i,(function(){mw.wysiwyg.change(document.getElementById(i)),mw.drag.fixes(),setTimeout((function(){mw.drag.fix_placeholders()}),40),mw.dropable.hide(),"Dialog"===mw.layoutPlus.mode?mw.dialog.get(e).remove():$(e).remove()}),l),o.pause=!1}))},mode:"Dialog",showSelectorUI:function(e){this.pause=!0,new mw[mw.layoutPlus.mode]({content:document.getElementById("plus-layouts-list").innerHTML,element:e,position:"right-center",template:"mw-tooltip-default mw-tooltip-insert-module",id:"mw-plus-tooltip-selector",title:mw.lang("Select layout"),width:800,overlay:!0}),this._prepareList(document.getElementById("mw-plus-tooltip-selector"),"before"),$("#mw-plus-tooltip-selector input").focus(),$("#mw-plus-tooltip-selector").addClass("active")},initSelector:function(){var e=this;this._top.on("click",(function(){e.showSelectorUI(this)})),this._bottom.on("click",(function(){e.showSelectorUI(this)}))},handle:function(){var e=this;mw.$(window).on("resize",(function(t){e._active&&e.position()})),mw.on("moduleOver ModuleClick",(function(t,o){"layouts"!==o.dataset.type||e.pause?e.hide():(e._active=o,e.position())}))},_ready:!1,init:function(){this._ready||(this._ready=!0,this.create(),this.handle(),this.initSelector())}},$(window).on("load",(function(){mw.layoutPlus.init()})),mw.live_edit=mw.live_edit||{},mw.live_edit.registry=mw.live_edit.registry||{},mw.live_edit.hasAbilityToDropElementsInside=function(e){var t=/^(span|h[1-6]|hr|ul|ol|input|table|b|em|i|a|img|textarea|br|canvas|font|strike|sub|sup|dl|button|small|select|big|abbr|body)$/i;return"string"==typeof e?!t.test(e):!(!mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(e,["allow-drop","nodrop"])||mw.tools.hasAnyOfClasses(e,["plain-text"])||t.test(e.nodeName)||(mw.tools.hasParentsWithClass(e,"module")?!mw.tools.hasParentsWithClass(e,"edit"):mw.tools.hasClass(e,"module")))},mw.live_edit.showSettings=function(e,t){var o,i=t.liveedit||!1,n=t.mode||"modal",a=t.view||"admin";if("string"==typeof e){o=e;var r=mw.$(e+":first");if(r.length>0){var l=$(r).attr("id");void 0!==l&&!1!==l&&(l=l.contains("#")?l.replace("#",""):l);var s=$(r).attr("type");void 0!==(l=$(r).attr("data-type"))&&!1!==l?o=l:void 0!==s&&!1!==s&&(o=s),e=r[0]}}var m=e||$("#mw_handle_module").data("curr");if(m&&void 0!==m){var d={};m&&m.attributes&&$.each(m.attributes,(function(e,t){d[t.name]=t.value}));var w="js-iframe-module-settings-"+m.id,c="sidebar-frame-wrapper-"+w,u=d;o=null,void 0!==u["data-type"]&&(o=u["data-type"],u["data-type"]=u["data-type"]+"/admin"),void 0!==u["data-module-name"]&&delete u["data-module-name"],void 0!==u.type&&(o=u.type,u.type=u.type+"/admin"),null!=o&&void 0!==a&&(u["data-type"]=u.type=o+"/"+a),void 0!==u.class&&delete u.class,void 0!==u.style&&delete u.style,void 0!==u.contenteditable&&delete u.contenteditable,u.live_edit=i,u.module_settings="true",u.view=void 0!==a?a:"admin",null==u.from_url&&(u.from_url=window.parent.location);var g="module-settings-"+m.id;u.view.hash;var h=mw.settings.site_url+"api/module?"+json2url(u);if(self!==top||"modal"===n){$("#"+w).remove(),mw.liveEditSettings&&mw.liveEditSettings.active&&mw.liveEditSettings.hide();var p=mw.$("#"+g);if(p.length){var f=mw.dialog.get(p[0]);return f.show(),f}var v=mw.dialogIframe({url:h,width:532,height:"auto",autoHeight:!0,id:g,title:"",className:"mw-dialog-module-settings",closeButtonAction:"remove"});return v.iframe.contentWindow.thismodal=v,v}mw.liveEditSettings.active||mw.liveEditSettings.show(),mw.sidebarSettingsTabs&&mw.sidebarSettingsTabs.set(2),u.live_edit_sidebar=!0;var y='<div class="js-module-settings-edit-item-group-frame loading" id="'+c+'"><iframe src="'+(h=mw.settings.site_url+"api/module?"+json2url(u))+'" frameborder="0" onload="this.parentNode.classList.remove(\'loading\')"></div>',_='<div  id="'+w+'" class="js-module-settings-edit-item-group">'+mw.live_edit.getModuleTitleBar(o,m.id)+y+"</div>";$("#"+w).length||$("#js-live-edit-module-settings-items").append(_),$("#"+w).length&&($(".js-module-settings-edit-item-group").hide(),$("#"+w).attr("data-settings-for-module",m.id),$("#"+w).show())}},mw.live_edit.getModuleTitleBar=function(e,t){var o=mw.live_edit.getModuleIcon(e),i=mw.live_edit.getModuleTitle(e),n=(mw.live_edit.getModuleDescription(e),"<div class='mw_module_settings_sidebar_title_wrapper js-module-titlebar-"+t+"'>"+o);return(n=(n+="<div class='js-module-sidebar-settings-menu-holder'></div>")+"<div class='mw_module_settings_sidebar_title'>"+i+"</div>")+"</div>"},mw.live_edit.getModuleIcon=function(e){return mw.live_edit.registry[e]&&mw.live_edit.registry[e].icon?'<span class="mw_module_settings_sidebar_icon" style="background-image: url('+mw.live_edit.registry[e].icon+')"></span>':'<span class="mw-icon-gear"></span>&nbsp;&nbsp;'},mw.live_edit.getModuleTitle=function(e){return mw.live_edit.registry[e]&&mw.live_edit.registry[e].title?mw.live_edit.registry[e].title:mw.live_edit.registry[e]&&mw.live_edit.registry[e].name?mw.live_edit.registry[e].name:""},mw.live_edit.getModuleDescription=function(e){return mw.live_edit.registry[e]&&void 0!==mw.live_edit.registry[e].description?mw.live_edit.registry[e].description:""},mw.dropables={prepare:function(){var e=document.createElement("div");e.className="mw_dropable",e.innerHTML='<span class="mw_dropable_arr"></span>',document.body.appendChild(e),mw.dropable=mw.$(e),mw.dropable.hide=function(){return mw.$(this).addClass("mw_dropable_hidden")},mw.dropable.show=function(){return mw.$(this).removeClass("mw_dropable_hidden")},mw.dropable.hide()},userInteractionClasses:function(){for(var e=document.querySelectorAll(".edit.background-image-holder, .edit .background-image-holder, .edit[style*='background-image'], .edit [style*='background-image']"),t=document.querySelectorAll(".module"+mw.noEditModules.join(",.module")),o=document.querySelectorAll(".edit"),i=0,n=0,a=0;i<e.length;i++){var r=e[i],l=mw.tools.parentsOrder(r,["edit","module"]);(-1===l.module||l.edit<l.module&&-1!==l.edit)&&(mw.tools.hasClass(r,"module")||mw.tools.addClass(r,"element"),r.style.backgroundImage=r.style.backgroundImage||"none")}for(;n<t.length;n++)mw.tools.removeClass(t[i],"module");for(;a<o.length;a++){for(var s=mw.ea.helpers.getElementsLike(":not(.element)",o[a]),m=0,d=o[a].querySelectorAll(".allow-drop"),w=0;w<d.length;w++)mw.tools.addClass(d[w],"element");for(;m<s.length;m++)mw.tools.hasClass(s[m],"module")||mw.ea.canDrop(s[m])&&mw.tools.addClass(s[m],"element")}if(document.body.classList){var c=mw.wysiwyg.isSelectionEditable();if(!c){var u=document.querySelector(".mw_editor");u&&u.contains(document.activeElement)&&(c=!0)}var g=mw.wysiwyg.validateCommonAncestorContainer(getSelection().focusNode),h=mw.tools.firstParentOrCurrentWithAnyOfClasses(g,["safe-mode"]),p=mw.tools.firstParentOrCurrentWithAnyOfClasses(g,["plain-text"]);document.body.classList[c?"add":"remove"]("mw-active-element-iseditable"),document.body.classList[h?"add":"remove"]("mw-active-element-is-in-safe-mode"),document.body.classList[p?"add":"remove"]("mw-active-element-is-plain-text")}},findNearest:function(e,t){t=(t||mw.drag.section_selectors).slice(0);for(var o=0;r<t.length;o++)t[o]=".edit "+t[o].trim();t=t.join(",");for(var i={y:99999999},n=mw.event.page(e).y,a=document.querySelectorAll(t),r=0,l={element:null,position:null};r<a.length;r++){var s=mw.tools.parentsOrder(a[r],["edit","module"]);if(!(-1===s.edit||-1!==s.module&&-1!==s.edit&&s.module<s.edit)&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(a[r],["allow-drop","nodrop"])){var m=mw.$(a[r]),d=m.offset().top,w=d-n,c=n-(d+m[0].offsetHeight),u=w>0?w:c;i.y>u&&(l.element=a[r]),i.y>u&&w>0?l.position="top":i.y>u&&c>0&&(l.position="bottom"),i.y>u&&(i.y=u)}}return l},display:function(e){var t=(e=mw.$(e)).offset(),o=e.outerWidth(),i=e.outerHeight();mw.dropable.css({top:t.top+i,left:t.left,width:o})},set:function(e,t,o,i){"top"===e?(mw.dropable.css({top:t.top-2,left:t.left,width:i,height:""}),mw.dropable.data("position","top"),mw.dropable.addClass("mw_dropable_arr_up")):"bottom"===e?(mw.dropable.css({top:t.top+o+2,left:t.left,width:i,height:""}),mw.dropable.data("position","bottom"),mw.dropable.removeClass("mw_dropable_arr_up"),mw.dropable.removeClass("mw_dropable_arr_rigt")):"left"===e?(mw.dropable.data("position","left"),mw.dropable.css({top:t.top,height:o,width:"",left:t.left})):"right"===e&&(mw.dropable.data("position","right"),mw.dropable.addClass("mw_dropable_arr_rigt"),mw.dropable.css({top:t.top,left:t.left+i,height:o,width:""}))}},mw.triggerLiveEditHandlers={cacheEnabled:!1,reseSetCache:function(e){this[e]={}},shouldTrigger:function(e,t){return!this.cacheEnabled||(this[e]&&this[e].node===t||(this[e]={node:t,count:0}),this[e].count<3&&(this[e].count++,!0))},_moduleRegister:null,module:function(e){targetFrom=e?e.target:mw.mm_target;var t=mw.tools.firstMatchesOnNodeOrParent(targetFrom,".module:not(.no-settings)"),o=t.__disableModuleTrigger||t;t?mw.trigger("moduleOver",[o,e]):"mw-handle-item-module"===mw.mm_target.id||"mw-handle-item-module-active"===mw.mm_target.id||mw.tools.hasParentWithId(mw.mm_target,"mw-handle-item-module")||mw.tools.hasParentWithId(mw.mm_target,"mw-handle-item-module-active")||mw.tools.hasAnyOfClassesOnNodeOrParent(mw.mm_target,["mwInaccessibleModulesMenu"])||mw.trigger("ModuleLeave",mw.mm_target)},cloneable:function(){var e=mw.tools.firstParentOrCurrentWithAnyOfClasses(mw.mm_target,["cloneable","mw-cloneable-control"]);e?mw.tools.hasClass(e,"mw-cloneable-control")||mw.tools.hasParentsWithClass(e,"mw-cloneable-control")?mw.trigger("CloneableOver",[mw.drag._onCloneableControl.__target,!0]):mw.trigger("CloneableOver",[e,!1]):mw.drag._onCloneableControl&&mw.mm_target!==mw.drag._onCloneableControl&&(mw.drag._onCloneableControl.style.display="none")},_elementRegister:null,element:function(e){var t=mw.tools.firstParentOrCurrentWithClass(mw.mm_target,"element");t?(this._elementRegister=t,!mw.tools.hasClass(t,"module")&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(t,["edit","module"])&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(t,["allow-drop","nodrop"])?mw.trigger("ElementOver",[t,e]):this._elementRegister=null):t||mw.tools.firstParentOrCurrentWithId(mw.mm_target,"mw-handle-item-element")||(this._elementRegister=null,mw.trigger("ElementLeave")),mw.mm_target===mw.image_resizer&&this._elementRegister!==mw.image.currentResizing[0]&&(this._elementRegister=mw.image.currentResizing[0],mw.trigger("ElementOver",[mw.image.currentResizing[0],e]))},_layoutRegister:null,layout:function(){var e=mw.tools.firstParentOrCurrentWithClass(mw.mm_target,"mw-layout-root");e&&this._layoutRegister!==e&&(this._layoutRegister=e,mw.trigger("LayoutOver",e))},_rowRegister:null,row:function(){var e=mw.tools.firstParentOrCurrentWithClass(mw.mm_target,"mw-row");e&&this._rowRegister!==e?(this._rowRegister=e,mw.trigger("RowOver",e)):null!==this._rowRegister&&(this._rowRegister=null,mw.trigger("RowLeave",mw.mm_target))},col:function(){if(!mw.drag.columns.resizing){var e=mw.tools.firstParentOrCurrentWithClass(mw.mm_target,"mw-col");e?mw.trigger("ColumnOver",e):mw.trigger("ColumnOut",mw.mm_target)}}},mw.liveEditHandlers=function(e){var t,o,i;if(!1===mw.drag.columns.resizing&&(mw.triggerLiveEditHandlers.cloneable(e),mw.triggerLiveEditHandlers.layout(e),mw.triggerLiveEditHandlers.element(e),mw.triggerLiveEditHandlers.module(e),!1!==mw.drag.columns.resizing||!mw.tools.hasParentsWithClass(mw.mm_target,"edit")||mw.tools.hasParentsWithClass(mw.mm_target,"module")&&!mw.tools.hasParentsWithClass(mw.mm_target,"allow-drop")||(mw.triggerLiveEditHandlers.row(),mw.triggerLiveEditHandlers.col())),mw.image._dragTxt(e),e.target&&(t=e.target.style&&e.target.style.backgroundImage&&!mw.tools.hasClass(e.target,"edit"),o=e.target,!t))for(var n=e.target;(!t||n===document.body)&&(n=n.parentNode);)t=n.style&&n.style.backgroundImage&&!mw.tools.hasClass(n,"edit"),o=n;t&&(i=!1===mw.drag.columns.resizing&&(mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(o,["edit","module"])||mw.tools.hasClass(e.target,"element"))),!mw.image.isResizing&&mw.image_resizer&&("IMG"===e.target.nodeName&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(e.target,["edit","module"])&&!1===mw.drag.columns.resizing?(mw.image_resizer._show(),mw.image.resize.resizerSet(e.target,!1)):t&&i?(mw.image_resizer._show(),mw.image.resize.resizerSet(o,!1)):mw.tools.hasClass(mw.mm_target,"mw-image-holder-content")||mw.tools.hasParentsWithClass(mw.mm_target,"mw-image-holder-content")?(mw.image_resizer._show(),mw.image.resize.resizerSet(mw.tools.firstParentWithClass(mw.mm_target,"mw-image-holder").querySelector("img"),!1)):e.target.mwImageResizerComponent||mw.image_resizer&&mw.image_resizer._hide())},mw.liveNodeSettings={_working:!1,set:function(e,t){if(!this._working){this._working=!0;var o=this;return setTimeout((function(){o._working=!1}),78),this[e]?(mw.sidebarSettingsTabs.set(2),this[e](t)):void 0}},element:function(e){this.__is_sidebar_opened()},none:function(e){this.__is_sidebar_opened()},module:function(e){mw.live_edit.showSettings(void 0,{mode:"sidebar",liveedit:!0})},image:function(e){this.__is_sidebar_opened()&&mw.$("#mw-live-edit-sidebar-image-frame").contents().find("#mwimagecurrent").attr("src",e.src)},initImage:function(){var e=mw.external_tool("imageeditor");mw.$("#js-live-edit-image-settings-holder").append('<iframe src="'+e+'" frameborder="0" id="mw-live-edit-sidebar-image-frame"></iframe>')},icon:function(){},__is_sidebar_opened:function(){if(mw.liveEditSettings&&mw.liveEditSettings.active)return!0}},$(document).ready((function(){mw.on("liveEditSettingsReady",(function(){mw.liveNodeSettings.initImage()}))})),mw.liveEditWidgets={_cssEditorInSidebarAccordion:null,cssEditorInSidebarAccordion:function(){if(!this._cssEditorInSidebarAccordion){this._cssEditorInSidebarAccordion=document.createElement("iframe"),this._cssEditorInSidebarAccordion.id="mw-css-editor-sidebar-iframe",this._cssEditorInSidebarAccordion.src=mw.external_tool("rte_css_editor"),this._cssEditorInSidebarAccordion.style.opacity=0,this._cssEditorInSidebarAccordion.scrolling="no",this._cssEditorInSidebarAccordion.frameBorder=0;var e=document.querySelector("#mw-css-editor-sidebar-iframe-holder");e.appendChild(this._cssEditorInSidebarAccordion),mw.tools.loading(e,90),mw.tools.iframeAutoHeight(this._cssEditorInSidebarAccordion),this._cssEditorInSidebarAccordion.onload=function(){this.contentWindow.document.body.style.padding=0,this.contentWindow.document.body.style.backgroundColor="transparent",mw.tools.loading(e,!1),this.style.opacity=1},mw.$(this._cssEditorInSidebarAccordion).height($(this._cssEditorInSidebarAccordion).parents(".mw-ui-box").outerHeight()-mw.$(this._cssEditorInSidebarAccordion).parents(".tabitem").outerHeight())}return this._cssEditorInSidebarAccordion},_tplSettings:null,loadTemplateSettings:function(e){return this._tplSettings||(this._tplSettings=document.createElement("iframe"),this._tplSettings.id="mw-live-edit-sidebar-settings-iframe-holder-template-settings-frame",this._tplSettings.className="mw-live-edit-sidebar-settings-iframe",this._tplSettings.src=e,this._tplSettings.scrolling="no",this._tplSettings.frameBorder=0,mw.$("#mw-live-edit-sidebar-settings-iframe-holder-template-settings").html(this._tplSettings),mw.tools.iframeAutoHeight(this._tplSettings),this._tplSettings.onload=function(){this.contentWindow.document.querySelector(".mw-module-live-edit-settings").style.padding=0},mw.$(this._tplSettings).height($(this._tplSettings).parents(".mw-ui-box").outerHeight()-mw.$(this._tplSettings).parents(".tabitem").outerHeight())),this._tplSettings}},mw.liveEditTools={isLayout:function(e){return!(!e||!e.getAttribute||"layouts"!==e.getAttribute("data-module-name")&&"layouts"!==e.getAttribute("data-type"))}},mw.liveedit={},mw.isDrag=!1,mw.resizable_row_width=!1,mw.mouse_over_handle=!1,mw.external_content_dragged=!1,mw.have_new_items=!1,mw.dragCurrent=null,mw.currentDragMouseOver=null,mw.liveEditSelectMode="element",mw.modulesClickInsert=!0,mw.mouseDownOnEditor=!1,mw.mouseDownStarted=!1,mw.SmallEditorIsDragging=!1,mw.states={},mw.live_edit_module_settings_array=[],mw.noEditModules=['[type="template_settings"]'],mw.isDragItem=mw.isBlockLevel=function(e){return mw.ea.helpers.isBlockLevel(e)},function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var o=e.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}if(e.support.touch="ontouchend"in document,e.support.touch){var o,i=e.ui.mouse.prototype,n=i._mouseInit,a=i._mouseDestroy;i._touchStart=function(e){!o&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(o=!0,this._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},i._touchMove=function(e){o&&(this._touchMoved=!0,t(e,"mousemove"))},i._touchEnd=function(e){o&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),o=!1)},i._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),n.call(t)},i._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),a.call(t)}}}(jQuery),mw.tools.addClass(document.body,"mw-live-edit"),$(document).ready((function(){"ontouchstart"in document.documentElement&&mw.$("body").addClass("touchscreen-device"),mw.liveedit.initReady(),mw.liveedit.handleEvents(),mw.liveedit.handleCustomEvents(),mw.liveedit.cssEditor=new mw.liveeditCSSEditor})),mw.require("stylesheet.editor.js"),$(window).on("load",(function(){mw.liveedit.initLoad()})),$(window).on("resize",(function(){mw.liveedit.toolbar.setEditor()})),mw.liveedit.manageContent={w:"985px",page:function(){var e=mw.dialogIframe({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&id=mw-quick-page&recommended_parent="+mw.settings.page_id,width:this.w,height:"auto",autoHeight:!0,name:"quick_page",overlay:!0,title:"New Page",scrollMode:"inside"});mw.$(e.main).addClass("mw-add-content-modal")},category:function(){var e=mw.dialogIframe({url:mw.settings.api_url+"module/?type=categories/edit_category&live_edit=true&quick_edit=false&id=mw-quick-category&recommended_parent="+mw.settings.page_id,width:this.w,height:"auto",autoHeight:!0,name:"quick_page",overlay:!0,title:"New Category",scrollMode:"inside"});mw.$(e.main).addClass("mw-add-content-modal")},edit:function(e,t,o,i,n){var a="";i&&(a="&recommended_parent="+i),t&&(a=a+"&content_type="+t),n&&(a=a+"&category="+n),o&&(a=a+"&subtype="+o);var r;r=0===e?"Add":"Edit";var l="Content";"post"===t?l="Post":"page"===t?l="Page":"product"===t?l="Product":"category"===t&&(l="Category");var s=mw.dialogIframe({url:mw.settings.api_url+"module/?type=content/edit&live_edit=true&quick_edit=false&is-current=true&id=mw-quick-page&content-id="+e+a,width:this.w,height:"auto",autoHeight:!0,name:"quick_page",id:"quick_page",overlay:!0,title:r+" "+l,scrollMode:"inside"});mw.$(s.main).addClass("mw-add-content-modal")},page_2:function(){var e=mw.dialogIframe({url:mw.settings.api_url+"module/?type=content/quick_add&live_edit=true&id=mw-new-content-add-ifame",width:this.w,height:"auto",name:"quick_page",overlay:!0,title:"New Page",scrollMode:"inside"});mw.$(e.main).addClass("mw-add-content-modal")},post:function(){var e=mw.dialogIframe({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&id=mw-quick-post&subtype=post&parent-page-id="+mw.settings.page_id+"&parent-category-id="+mw.settings.category_id,width:this.w,height:"auto",autoHeight:!0,name:"quick_post",overlay:!0,title:"New Post"});mw.$(e.main).addClass("mw-add-content-modal")},product:function(){var e=mw.dialogIframe({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&id=mw-quick-product&subtype=product&parent-page-id="+mw.settings.page_id+"&parent-category-id="+mw.settings.category_id,width:this.w,height:"auto",autoHeight:!0,name:"quick_product",overlay:!0,title:"New Product"});mw.$(e.main).addClass("mw-add-content-modal")}},mw.liveedit.modulesToolbar={init:function(e){var t=e||".modules-list li[data-module-name]",o=mw.$(t);o.on("mouseup touchend",(function(){document.body.classList.contains("dragStart")||this.classList.contains("module-item-layout")||(mw.liveEditSelector.selected[0]?(mw.element(mw.liveEditSelector.selected[0]).after(this.outerHTML),setTimeout((function(){mw.drag.load_new_modules(),mw.tools.scrollTo(mw.liveEditSelector.selected[0].nextElementSibling,void 0,200)}),78)):mw.notification.warning("Select element from the page or drag the <b>"+this.dataset.filter+"</b> to the desired place"))})),o.draggable({revert:!0,revertDuration:0,distance:20,start:function(e,t){mw.isDrag=!0,mw.dragCurrent=mw.ea.data.currentGrabbed=mw.GlobalModuleListHelper,mw.$(document.body).addClass("dragStart"),mw.image_resizer._hide()},stop:function(){mw.isDrag=!1,mw.pauseSave=!0;var e=this;mw.$(document.body).removeClass("dragStart"),setTimeout((function(){mw.drag.load_new_modules(),mw.drag.toolbar_modules(e)}),200)}}),o.on("mouseenter touchstart",(function(){mw.$(this).draggable("option","helper",(function(){var e=$(this),t=e.clone(!0);return t.appendTo(document.body),t.addClass("mw-module-drag-clone"),mw.GlobalModuleListHelper=t[0],t.css({width:e.width(),height:e.height()}),t[0]}))}))}},function(e){e.paddingEditor=function(t){t=t||{},this.settings=$.extend({},{height:10},t),this._pageY=-1,this._active=null,this._paddingTopDown=!1,this._paddingBottomDown=!1;var o=this;this.create=function(){this.paddingTop=document.createElement("div"),this.paddingTop.className="mw-padding-ctrl mw-padding-ctrl-top",this.paddingBottom=document.createElement("div"),this.paddingBottom.className="mw-padding-ctrl mw-padding-ctrl-bottom",this.paddingTop.style.height=this.settings.height+"px",this.paddingBottom.style.height=this.settings.height+"px",document.body.appendChild(this.paddingTop),document.body.appendChild(this.paddingBottom)},this.record=function(){if(o._active){var t=o._active;t.parentNode&&(t=t.parentNode);var i=e.tools.firstParentOrCurrentWithAnyOfClasses(t,["edit","element","module"]);e.liveEditState.record({target:i,value:i.innerHTML})}},o&&o._active,this.handleMouseMove=function(){e.$(this.paddingTop).on("mousedown touchstart",(function(){o._paddingTopDown=!0,e.liveEditSelectMode="none",e.$("html").addClass("padding-control-start")})),e.$(this.paddingBottom).on("mousedown touchstart",(function(){o._paddingBottomDown=!0,e.liveEditSelectMode="none",e.$("html").addClass("padding-control-start"),o.record()})),e.$(document.body).on("mouseup touchend",(function(){(o._paddingTopDown||o._paddingBottomDown)&&o.record(),e.liveEditSelectMode="element",o._paddingTopDown=!1,o._paddingBottomDown=!1,o._working=!1,e.$(o._info).removeClass("active"),o.activeMark(!1),e.liveEditSelector.active(!0),e.$("html").removeClass("padding-control-start")})),e.event.windowLeave((function(t){(o._paddingTopDown||o._paddingBottomDown)&&o.record(),e.liveEditSelectMode="element",o._paddingTopDown=!1,o._paddingBottomDown=!1,o._working=!1,e.$(o._info).removeClass("active"),e.liveEditSelector.active(!0),e.$("html").removeClass("padding-control-start")})),e.$(document).on("mousemove touchmove",(function(t){if(o._active){var i,n=t.pageY<o._pageY,a=n?o._pageY-t.pageY:t.pageY-o._pageY;o&&o._active&&o._paddingTopDown?(o._working=!0,i=o._active._currPaddingTop||parseFloat($(o._active).css("paddingTop")),o._active.style.paddingTop=n?(i<=0?0:i-a)+"px":i+a+"px",o._active._currPaddingTop=parseFloat(o._active.style.paddingTop),o.position(o._active),o.info(),o._active.setAttribute("staticdesign",!0),o.activeMark(!0),e.wysiwyg.change(o._active),e.liveEditSelector.pause(),e.trigger("PaddingControl",o._active)):o&&o._active&&o._paddingBottomDown&&(o._working=!0,i=o._active._currPaddingBottom||parseFloat($(o._active).css("paddingBottom")),o._active.style.paddingBottom=n?(i<=0?0:i-a)+"px":i+a+"px",o._active._currPaddingBottom=parseFloat(o._active.style.paddingBottom),o.position(o._active),o.info(),o._active.setAttribute("staticdesign",!0),o.activeMark(!0),e.wysiwyg.change(o._active),e.liveEditSelector.pause(),e.trigger("PaddingControl",o._active)),o._pageY=t.pageY,o._activePadding=i}o._active&&e.liveedit.data.get("move","hasLayout")?(o.show(),o.position()):o.hide()}))},this.show=function(){o.paddingTop.style.display="block",o.paddingBottom.style.display="block"},this.hide=function(){o.paddingTop.style.display="none",o.paddingBottom.style.display="none"},this.position=function(t){var i=e.$(t),n=i.offset();o._active=t,o.paddingTop.style.top=n.top+"px",o.paddingBottom.style.top=n.top+i.outerHeight()-this.settings.height+"px"},this.selectors=[".mw-padding-gui-element",".mw-padding-control-element"],this.prepareSelectors=function(){},this.addSelector=function(e){this.selectors.push(e),this.prepareSelectors()},this.eventsHandlers=function(){e.on("moduleOver ModuleClick",(function(t,i){if(!o._working){var n=e.tools.firstMatchesOnNodeOrParent(i,o.selectors);n&&(e.tools.hasClass(n,"module")&&(n=e.$(n).children(o.selectors.join(","))[0]||n),o.position(n))}}))},this.init=function(){this.create(),this.eventsHandlers(),this.handleMouseMove(),this.prepareSelectors(),this.hide()},this.activeMark=function(t){if(void 0===t&&(t=!1),this._activeMark||(this._activeMark=document.createElement("div"),this._activeMark.className="mw-padding-control-active-mark",document.body.appendChild(this._activeMark)),t){e.tools.addClass(this._activeMark,"active"),o._paddingTopDown?o.paddingTop:o.paddingBottom;var i=o._active.getBoundingClientRect();this._activeMark.style.left=i.left+"px",this._activeMark.style.width=i.width+"px",this._activeMark.style.height=o._activePadding+"px",o._paddingTopDown?this._activeMark.style.top=i.top+scrollY+"px":this._activeMark.style.top=i.top+scrollY+e.$(o._active).outerHeight()-parseFloat(o._active.style.paddingBottom)+"px"}else e.tools.removeClass(this._activeMark,"active")},this.generateCSS=function(t,i){if(t&&o._active){i=(i||"all").trim();var n=e.tools.generateSelectorForNode(o._active),a="{";for(var r in t)a+=r+":"+t[r]+";";return"@media "+i+" {"+n+(a+="}")+"}"}},this.info=function(){var t;this._info||(this._info=document.createElement("div"),this._info.className="mw-padding-control-info",document.body.appendChild(this._info)),e.$(this._info).addClass("active"),o._paddingTopDown?(t=e.$(o.paddingTop).offset(),this._info.style.top=t.top+o.settings.height+"px",this._info.innerHTML=o._active.style.paddingTop):o._paddingBottomDown&&(t=e.$(o.paddingBottom).offset(),this._info.style.top=t.top-o.settings.height-30+"px",this._info.innerHTML=o._active.style.paddingBottom),this._info.style.left=t.left+o._active.clientWidth/2+"px"},this.init()}}(window.mw),mw.drag=mw.drag||{},mw.drag.plus={locked:!1,disabled:!1,init:function(e){this.disabled||(mw.drag.plusTop=document.querySelector(".mw-plus-top"),mw.drag.plusBottom=document.querySelector(".mw-plus-bottom"),mw.drag.plusTop&&(mw.drag.plusTop.style.top="-9999px"),mw.drag.plusBottom&&(mw.drag.plusBottom.style.top="-9999px"),mw.$(e).on("mousemove touchmove click",(function(e){if(!1===mw.drag.plus.locked&&!1===mw.isDrag){if(e.pageY%2==0&&mw.tools.isEditable(e)){var t,o=mw.drag.plus.selectNode(e.target);if(o&&"mousemove"===e.type){var i=$(o).offset();t=e.pageY-i.top>i.top+o.offsetHeight-e.pageY?"top":"bottom"}mw.drag.plus.set(o,t),mw.$(document.body).removeClass("editorKeyup")}}else mw.drag.plusTop.style.top="-9999px",mw.drag.plusBottom.style.top="-9999px"})),mw.$(e).on("mouseleave",(function(e){!1===mw.drag.plus.locked&&e.target!==mw.drag.plusTop&&e.target!==mw.drag.plusBottom&&mw.drag.plus.set(void 0)})),mw.drag.plus.action())},selectNode:function(e){if(!e||mw.tools.hasAnyOfClassesOnNodeOrParent(e,["noplus","noedit","noplus"])||mw.tools.hasClass(e,"edit"))return mw.drag.plusTop.style.top="-9999px",void(mw.drag.plusBottom.style.top="-9999px");var t=mw.tools.firstMatchesOnNodeOrParent(e,[".module",".element","p",".mw-empty"]);return t&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(e,["allow-drop","nodrop"])?t:(mw.drag.plusTop.style.top="-9999px",void(mw.drag.plusBottom.style.top="-9999px"))},set:function(e,t){if(void 0!==e){var o=mw.$(e),i=o.offset(),n=document.querySelector("#live_edit_toolbar"),a=Math.max(0,i.left-10);n&&i.top<n.offsetHeight&&(i.top=n.offsetHeight+10),mw.drag.plusTop.style.top=i.top+"px",mw.drag.plusTop.style.left=a+o.width()/2+"px",mw.drag.plusTop.currentNode=e,mw.drag.plusBottom.style.top=i.top+e.offsetHeight+"px",mw.drag.plusBottom.style.left=a+o.width()/2+"px",t&&("top"===t?mw.drag.plusTop.style.top="-9999px":mw.drag.plusBottom.style.top="-9999px"),mw.drag.plusBottom.currentNode=e,mw.tools.removeClass([mw.drag.plusTop,mw.drag.plusBottom],"active")}},tipPosition:function(e){return"right-center"},rendModules:function(e){var t=e===mw.drag.plusTop?mw.drag.plusBottom:mw.drag.plusTop;if(!mw.tools.hasClass(e,"active")){mw.tools.addClass(e,"active"),mw.tools.removeClass(t,"active"),mw.drag.plus.locked=!0,mw.$(".mw-tooltip-insert-module").remove(),mw.drag.plusActive=this===mw.drag.plusTop?"top":"bottom";var o=new mw.tooltip({content:document.getElementById("plus-modules-list").innerHTML,element:e,position:mw.drag.plus.tipPosition(this.currentNode),template:"mw-tooltip-default mw-tooltip-insert-module",id:"mw-plus-tooltip-selector"});setTimeout((function(){$("#mw-plus-tooltip-selector").addClass("active").find(".mw-ui-searchfield").focus()}),10),mw.tabs({nav:o.querySelectorAll(".mw-ui-btn"),tabs:o.querySelectorAll(".module-bubble-tab")}),mw.$(".mw-ui-searchfield",o).on("keyup paste",(function(){0===mw.drag.plus.search(this.value,o)?mw.$(".module-bubble-tab-not-found-message").html(mw.msg.no_results_for+": <em>"+this.value+"</em>").show():mw.$(".module-bubble-tab-not-found-message").hide()})),mw.$("#plus-modules-list li").each((function(){var e=mw.$(this).attr("data-module-name");if("layout"===e){var t=mw.$(this).attr("template");mw.$(this).attr("onclick",'InsertModule("'+e+'", {class:this.className, template:"'+t+'"})')}else mw.$(this).attr("onclick",'InsertModule("'+e+'", {class:this.className})')}))}},action:function(){var e=[mw.drag.plusTop,mw.drag.plusBottom],t=mw.$(e);t.on("mouseenter",(function(){mw.tools.addClass(document.body,"body-mw-module-plus-hover"),mw.liveEditSelector.select(mw.drag.plusTop.currentNode)})),t.on("mouseleave",(function(){mw.tools.removeClass(document.body,"body-mw-module-plus-hover")})),t.on("click",(function(){mw.drag.plus.rendModules(this)}))},search:function(e,t){for(var o=t.querySelectorAll(".module_name"),i=o.length,n=0,a=0,r=""===(e=e.toLowerCase()).replace(/\s+/g,"");n<i;n++){var l=o[n].innerHTML.toLowerCase(),s=mw.tools.firstParentWithTag(o[n],"li"),m=(s.dataset.filter||"").trim().toLowerCase();l.contains(e)||r?(s.style.display="",l.contains(e)&&a++):m.contains(e)?(s.style.display="",a++):s.style.display="none"}return a}},InsertModule=function(e,t,o){var i="top"===mw.drag.plusActive?"top":"bottom";(function(e,t,o,i){return new Promise((function(n){var a;i=i||"bottom";var r=mw.id("mw-module-"),l='<div id="'+r+'"></div>';"top"===i?(a="before",mw.tools.hasClass(e,"allow-drop")&&(a="prepend")):"bottom"===i&&(a="after",mw.tools.hasClass(e,"allow-drop")&&(a="append")),mw.$(mw.drag.plusBottom.currentNode)[a](l),mw.load_module(t,"#"+r,(function(){n(this)}),o)}))})(mw.drag.plusTop.currentNode,e,t,i).then((function(e){mw.wysiwyg.change(e),mw.drag.plus.locked=!1,mw.drag.fixes(),setTimeout((function(){mw.drag.fix_placeholders()}),40),mw.dropable.hide()})),mw.$(".mw-tooltip").hide()},e=function(e,t){for(var o in t)e.style[o]="number"==typeof t[o]?t[o]+"px":t[o]},mw.Selector=function(t){t=t||{};var o={autoSelect:!0,document,toggleSelect:!1,strict:!1};this.options=$.extend({},o,t),this.document=this.options.document,this.buildSelector=function(){var e=this.document.createElement("div"),t=this.document.createElement("div"),o=this.document.createElement("div"),i=this.document.createElement("div");e.className="mw-selector mw-selector-top",t.className="mw-selector mw-selector-right",o.className="mw-selector mw-selector-bottom",i.className="mw-selector mw-selector-left",this.document.body.appendChild(e),this.document.body.appendChild(t),this.document.body.appendChild(o),this.document.body.appendChild(i),this.selectors.push({top:e,right:t,bottom:o,left:i,active:!1})},this.getFirstNonActiveSelector=function(){for(var e=0;e<this.selectors.length;e++)if(!this.selectors[e].active)return this.selectors[e];return this.buildSelector(),this.selectors[this.selectors.length-1]},this.deactivateAll=function(){for(var e=0;e<this.selectors.length;e++)this.selectors[e].active=!1},this.pause=function(){this.active(!1),this.hideAll()},this.hideAll=function(){for(var e=0;e<this.selectors.length;e++)this.hideItem(this.selectors[e]);this.hideItem(this.interactors)},this.hideItem=function(e){for(var t in e.active=!1,e)e[t]&&(e[t].style.visibility="hidden")},this.showItem=function(e){for(var t in e)"boolean"!=typeof e[t]&&e[t].className&&-1!==e[t].className.indexOf("mw-selector")&&(e[t].style.visibility="visible")},this.buildInteractor=function(){var e=this.document.createElement("div"),t=this.document.createElement("div"),o=this.document.createElement("div"),i=this.document.createElement("div");e.className="mw-selector mw-interactor mw-selector-top",t.className="mw-selector mw-interactor mw-selector-right",o.className="mw-selector mw-interactor mw-selector-bottom",i.className="mw-selector mw-interactor mw-selector-left",this.document.body.appendChild(e),this.document.body.appendChild(t),this.document.body.appendChild(o),this.document.body.appendChild(i),this.interactors={top:e,right:t,bottom:o,left:i}},this.isSelected=function(e){var t=e.target?e.target:e;return-1!==this.selected.indexOf(t)},this.unsetItem=function(e){for(var t=e.target?e.target:e,o=0;o<this.selectors.length;o++)if(this.selectors[o].active===t){this.hideItem(this.selectors[o]);break}this.selected.splice(this.selected.indexOf(t),1)},this.positionSelected=function(){for(var e=0;e<this.selectors.length;e++)this.position(this.selectors[e],this.selectors[e].active)},this.position=function(t,o){var i=mw.$(o).offset();e(t.top,{top:i.top,left:i.left,width:o.offsetWidth}),e(t.right,{top:i.top,left:i.left+o.offsetWidth,height:o.offsetHeight}),e(t.bottom,{top:i.top+o.offsetHeight,left:i.left,width:o.offsetWidth}),e(t.left,{top:i.top,left:i.left,height:o.offsetHeight})},this.setItem=function(e,t,o,i){if(e&&this.active()){var n=e.target?e.target:e;this.options.strict&&(n=mw.tools.firstMatchesOnNodeOrParent(n,["[id]",".edit"]));var a=!mw.tools.firstMatchesOnNodeOrParent(n,[".mw-control-box",".mw-defaults"]);if(n&&a){if($(n).hasClass("mw-select-skip"))return this.setItem(n.parentNode,t,o,i);if(o){if(this.options.toggleSelect&&this.isSelected(n))return this.unsetItem(n),!1;i?this.selected.push(n):this.selected=[n],mw.$(this).trigger("select",[this.selected])}this.position(t,n),t.active=n,this.showItem(t)}}},this.select=function(e,t){(e||t)&&(t=e.nodeType?e:t||e.target,e.ctrlKey?this.setItem(t,this.getFirstNonActiveSelector(),!0,!0):(this.hideAll(),this.setItem(t,this.selectors[0],!0,!1)))},this.deselect=function(e,t){e.preventDefault(),t=t||e.target,this.unsetItem(t)},this.init=function(){this.buildSelector(),this.buildInteractor();var e=this;mw.$(this.root).on("click",(function(t){e.options.autoSelect&&e.active()&&e.select(t)})),mw.$(this.root).on("mousemove touchmove touchend",(function(t){e.options.autoSelect&&e.active()&&e.setItem(t,e.interactors)})),mw.$(this.root).on("scroll",(function(){e.positionSelected()})),mw.$(window).on("resize orientationchange",(function(){e.positionSelected()}))},this._active=!1,this.active=function(e){if(void 0===e)return this._active;this._active!==e&&(this._active=e,mw.$(this).trigger("stateChange",[e]))},this.selected=[],this.selectors=[],this.root=t.root,this.init()},mw.editSource=function(e){mw._editSource||(mw._editSource={wrapper:document.createElement("div"),area:document.createElement("textarea"),ok:document.createElement("mwbtn"),cancel:document.createElement("mwbtn"),nav:document.createElement("div"),validator:document.createElement("div")},mw.$(mw._editSource.ok).addClass("mw-ui-btn mw-ui-btn-medium mw-ui-btn-info").html(mw.lang("OK")),mw.$(mw._editSource.cancel).addClass("mw-ui-btn mw-ui-btn-medium").html(mw.lang("Cancel")),mw._editSource.wrapper.appendChild(mw._editSource.area),mw._editSource.wrapper.appendChild(mw._editSource.nav),mw._editSource.nav.appendChild(mw._editSource.cancel),mw._editSource.nav.appendChild(mw._editSource.ok),mw._editSource.nav.className="mw-inline-source-editor-buttons",mw._editSource.wrapper.className="mw-inline-source-editor",document.body.appendChild(mw._editSource.wrapper),mw.$(mw._editSource.cancel).on("click",(function(){mw.$(mw._editSource.target).html(mw._editSource.area.value),mw.$(mw._editSource.wrapper).removeClass("active"),mw._editSource.ok.disabled=!1})),mw.$(mw._editSource.area).on("input",(function(){mw._editSource.validator.innerHTML=mw._editSource.area.value,mw._editSource.ok.disabled=mw._editSource.validator.innerHTML!==mw._editSource.area.value,mw._editSource.ok.classList[mw._editSource.ok.disabled?"add":"remove"]("disabled");var e=mw.$(".mw-inline-source-editor-error",mw._editSource.nav);mw._editSource.ok.disabled?e.length||mw.$(mw._editSource.nav).prepend('<span class="mw-inline-source-editor-error">'+mw.lang("Invalid HTML")+"</span>"):e.remove()})),mw.$(mw._editSource.ok).on("click",(function(){mw._editSource.ok.disabled||(mw.$(mw._editSource.target).html(mw._editSource.area.value),mw.$(mw._editSource.wrapper).removeClass("active"),mw.wysiwyg.change(mw._editSource.target))}))),mw._editSource.area.value=e.innerHTML,mw._editSource.target=e;var t=mw.$(e),o=t.offset(),i=t.outerWidth(),n=mw.$(".mw-live-edit-sidebar-tabs-wrapper").offset();o.left+i>n.left&&(o.left-=o.left+i-n.left+10),mw.$(mw._editSource.area).height(t.outerHeight()).width(i),mw.$(mw._editSource.wrapper).css(o).addClass("active")},mw.tempCSS=function(e){e=e||{};var t={document,css:{}};this.settings=$.extend({},t,e),this.styleElement=function(){return this._styleElement||(this._styleElement=this.settings.document.createElement("style"),this._styleElement.type="text/css",this._styleElement.appendChild(document.createTextNode("")),this.settings.document.body.appendChild(this._styleElement)),this._styleElement},this.modifyObject=function(){},this.addStyle=function(e,t,o){e&&e.tagName&&(e=mw.tools.generateSelectorForNode(e))}},mw.liveedit.toolbar={fixPad:function(){document.body.style.paddingTop=parseFloat($(document.body).css("paddingTop"))+mw.$("#live_edit_toolbar").height()+"px"},setEditor:function(){},prepare:function(){mw.$("#liveedit_wysiwyg").on("mousedown touchstart",(function(){0===mw.$(".mw_editor_btn_hover").length&&(mw.mouseDownOnEditor=!0,mw.$(this).addClass("hover"))})).on("mouseup touchend",(function(){mw.mouseDownOnEditor=!1,mw.$(this).removeClass("hover")})),mw.$(window).scroll((function(){$(window).scrollTop()>10?mw.tools.addClass(document.getElementById("live_edit_toolbar"),"scrolling"):mw.tools.removeClass(document.getElementById("live_edit_toolbar"),"scrolling")})),mw.$("#live_edit_toolbar").hover((function(){mw.$(document.body).addClass("toolbar-hover")}),(function(){mw.$(document.body).removeClass("toolbar-hover")}))},editor:{init:function(){this.ed=document.getElementById("liveedit_wysiwyg"),this.nextBTNS=mw.$(".liveedit_wysiwyg_next"),this.prevBTNS=mw.$(".liveedit_wysiwyg_prev")},calc:{SliderButtonsNeeded:function(e){var t={left:!1,right:!1};if(null!=e&&e){var o=e.firstElementChild;if($(e).width()>mw.$(o).width())return t;var i=mw.$(e).offset().left+mw.$(e).width();return mw.$(o).offset().left+mw.$(o).width()>i&&(t.right=!0),$(o).offset().left<mw.$(e).offset().left&&(t.left=!0),t}},SliderNormalize:function(e){if(null===e||!e)return!1;var t=e.firstElementChild,o=mw.$(e).offset().left+mw.$(e).width(),i=mw.$(t).offset().left+mw.$(t).width();return i<o&&o-i},SliderNext:function(e,t){if(null===e||!e)return!1;var o=e.firstElementChild;if($(e).width()>mw.$(o).width())return 0;var i=mw.$(e).offset().left+mw.$(e).width(),n=mw.$(o).offset().left+mw.$(o).width();t=t||mw.$(e).width();var a=parseFloat(window.getComputedStyle(o,null).left);return i<n&&n-t>i?a-t:a-(n-i)},SliderPrev:function(e,t){if(null===e||!e)return!1;var o=e.firstElementChild;t=t||mw.$(e).width();var i=parseFloat(window.getComputedStyle(o,null).left);return i<0&&i+t<0?i+t:0}},step:function(){return $(mw.liveedit.toolbar.editor.ed).width()},denied:!1,buttons:function(){var e=mw.liveedit.toolbar.editor.calc.SliderButtonsNeeded(mw.liveedit.toolbar.editor.ed);e&&(e.left?mw.liveedit.toolbar.editor.prevBTNS.addClass("active"):mw.liveedit.toolbar.editor.prevBTNS.removeClass("active"),e.right?mw.liveedit.toolbar.editor.nextBTNS.addClass("active"):mw.liveedit.toolbar.editor.nextBTNS.removeClass("active"))},slideLeft:function(){if(!mw.liveedit.toolbar.editor.denied){mw.liveedit.toolbar.editor.denied=!0;var e=mw.liveedit.toolbar.editor.ed.firstElementChild,t=mw.liveedit.toolbar.editor.calc.SliderPrev(mw.liveedit.toolbar.editor.ed,mw.liveedit.toolbar.editor.step());$(e).animate({left:t},(function(){mw.liveedit.toolbar.editor.denied=!1,mw.liveedit.toolbar.editor.buttons()}))}},slideRight:function(){if(!mw.liveedit.toolbar.editor.denied){mw.liveedit.toolbar.editor.denied=!0;var e=mw.liveedit.toolbar.editor.ed.firstElementChild,t=mw.liveedit.toolbar.editor.calc.SliderNext(mw.liveedit.toolbar.editor.ed,mw.liveedit.toolbar.editor.step());$(e).animate({left:t},(function(){mw.liveedit.toolbar.editor.denied=!1,mw.liveedit.toolbar.editor.buttons()}))}},fixConvertible:function(e){if(e=e||".wysiwyg-convertible",(e=$(e)).length>1)return $(e).each((function(){mw.liveedit.toolbar.editor.fixConvertible(this)})),!1;var t=$(window).width(),o=e.offset().left+e.width();o>t?e.css("left",-(o-t)):e.css("left",0)}}},mw.liveedit=mw.liveedit||{},mw.liveedit.widgets={htmlEditorDialog:function(){var e=mw.settings.site_url+"api/module?id=mw_global_html_editor&live_edit=true&module_settings=true&type=editor/code_editor&autosize=true";mw.dialogIframe({url:e,title:"Code editor",height:"auto",width:"95%"})},cssEditorDialog:function(){var e=mw.settings.site_url+"api/module?id=mw_global_css_editor&live_edit=true&module_settings=true&type=editor/css_editor&autosize=true";return mw.dialogIframe({url:e,height:"auto",autoHeight:!0,name:"mw-css-editor-front",title:"CSS Editor",template:"default",center:!1,resize:!0,draggable:!0})}},mw.require("css_parser.js"),mw.require("icon_selector.js"),mw.require("events.js"),classApplier=window.classApplier||[],Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),o=t.length;--o>=0&&t.item(o)!==this;);return o>-1}),void 0===Selection.prototype.containsNode&&(Selection.prototype.containsNode=function(e){if(0===this.rangeCount)return!1;var t=this.getRangeAt(0);if(t.commonAncestorContainer===e)return!0;if(t.endContainer===e)return!0;if(t.startContainer===e)return!0;if(t.commonAncestorContainer.parentNode===e)return!0;if(3!==e.nodeType){var o=mw.wysiwyg.validateCommonAncestorContainer(t.commonAncestorContainer).querySelectorAll(e.nodeName.toLowerCase()),i=o.length,n=0;if(i>0)for(;n<i;n++)if(o[n]===e)return!0}return!1}),void 0===Range.prototype.querySelector&&(Range.prototype.querySelector=function(e){var t=this.extractContents(),o=t.querySelector(e);return this.insertNode(t),o}),void 0===Range.prototype.querySelectorAll&&(Range.prototype.querySelectorAll=function(e){var t=this.extractContents(),o=t.querySelectorAll(e);return this.insertNode(t),o}),mw.wysiwyg={isSafeMode:function(e){if(!e){var t=window.getSelection();if(!t.rangeCount)return!1;var o=t.getRangeAt(0);e=mw.wysiwyg.validateCommonAncestorContainer(o.commonAncestorContainer)}var i=mw.tools.hasAnyOfClassesOnNodeOrParent(e,["safe-mode"]),n=mw.tools.parentsOrCurrentOrderMatchOrNone(e,["regular-mode","safe-mode"]);return i&&!n},parseClassApplierSheet:function(){var e=document.querySelector("link[classApplier]");if(null!==e)for(var t=e.sheet.rules,o=0;o<t.length;o++)if(t[o].selectorText){var i=t[o].selectorText.trim(),n=i.split(".");0===i.indexOf(".")&&-1===i.indexOf(":")&&-1===i.indexOf("#")&&2===n.length&&-1===i.indexOf("[")&&classApplier.push(n[1])}},initClassApplier:function(){this.parseClassApplierSheet();var e=mw.$("#format_main ul");classApplier.forEach((function(t,o){e.append('<li value=".'+t+'"><a href="#"><div class="'+t+'">Custom '+o+"</div></a></li>")}))},editInsideModule:function(e){e=e.target?e.target:e;var t=mw.tools.parentsOrder(e,["edit","module"]);return t.edit<t.module},pasteFromWordUI:function(){if(!mw.wysiwyg.isSelectionEditable())return!1;mw.wysiwyg.save_selection();var e=mw.$('<div class="mw-cleaner-block" contenteditable="true"><small class="muted">Paste document here.</small></div>'),t=mw.$('<span class="mw-ui-btn mw-ui-btn-medium mw-ui-btn-invert pull-right">Insert</span>'),o=mw.dialog({content:e,overlay:!0,title:"Paste from word",footer:t,height:"auto",autoHeight:!0});e.on("paste",(function(){setTimeout((function(){e[0].innerHTML=mw.wysiwyg.clean_word(e[0].innerHTML)}),100)})),e.on("click",(function(){$(this).hasClass("active")||(mw.$(this).addClass("active"),mw.$(this).html(""))})),t.on("click",(function(){mw.wysiwyg.restore_selection(),mw.wysiwyg.insert_html(e.html()),o.remove()}))},globalTarget:document.body,allStatements:function(e,t){var o=window.getSelection().getRangeAt(0),i=mw.wysiwyg.validateCommonAncestorContainer(o.commonAncestorContainer),n=mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(i,["allow-drop","nodrop"]);mw.wysiwyg.isSelectionEditable()&&n?"function"==typeof e&&e.call():"function"==typeof t&&t.call()},action:{removeformat:function(){var e=window.getSelection(),t=e.getRangeAt(0).commonAncestorContainer;mw.wysiwyg.removeStyles(t,e)}},removeStyles:function(e,t){if(e.querySelectorAll)for(var o=e.querySelectorAll("*"),i=o.length,n=0;n<i;n++){var a=o[n];void 0!==t&&t.containsNode(a,!0)&&mw.$(a).removeAttr("style")}else mw.wysiwyg.removeStyles(e.parentNode)},init_editables:function(e){if(window.mwAdmin)if(void 0!==e)mw.wysiwyg.contentEditable(e,!1),mw.$(e.querySelectorAll(".edit")).each((function(){mw.wysiwyg.contentEditable(this,!0),mw.on.DOMChange(this,(function(){mw.wysiwyg.change(this)}))}));else{for(var t=document.querySelectorAll("[contenteditable]"),o=t.length,i=0;i<o;i++)mw.wysiwyg.contentEditable(t[i],"inherit");mw.$(".edit").each((function(){mw.on.DOMChange(this,(function(){mw.wysiwyg.change(this),0===this.querySelectorAll("*").length&&mw.live_edit.hasAbilityToDropElementsInside(this)&&mw.wysiwyg.modify(this,(function(){mw.wysiwyg.isSafeMode(this)||(this.innerHTML='<p class="element">'+this.innerHTML+"</p>")})),mw.wysiwyg.normalizeBase64Images(this)}),!1,!0),mw.$(this).mouseenter((function(){0===this.querySelectorAll("*").length&&mw.live_edit.hasAbilityToDropElementsInside(this)&&mw.wysiwyg.modify(this,(function(){mw.wysiwyg.isSafeMode(this)||(this.innerHTML='<p class="element">'+this.innerHTML+"&nbsp;</p>")}))}))})),mw.$(".empty-element, .ui-resizable-handle").each((function(){mw.wysiwyg.contentEditable(this,!1)})),mw.on.moduleReload((function(){mw.wysiwyg.nceui()}))}},modify:function(e,t){var o=mw.askusertostay;"function"==typeof e?(t=e).call():t.call(e),mw.askusertostay=o},fixElements:function(e){var t=e.querySelectorAll(".element"),o=t.length;for(i=0;i<o;i++)""!==t[i].innerHTML&&""!==t[i].innerHTML.replace(/\s+/g,"")||(t[i].innerHTML="&zwj;&nbsp;&zwj;")},removeEditable:function(e){e=e||[];for(var t,o=0,i=document.getElementsByClassName("edit"),n=i.length;o<n;o++)if(e.length){var a=!1;for(mw.wysiwyg.contentEditable(i[o],!1),t=0;t<e.length;t++)e[t]===i[o]&&(a=!0);a||mw.wysiwyg.contentEditable(i[o],!1)}else mw.wysiwyg.contentEditable(i[o],!1)},_lastCopy:null,handleCopyEvent:function(e){this._lastCopy=e.target},contentEditableSplitTypes:function(e){},contentEditable:function(e,t){if(e&&(1===e.nodeType||(e=mw.wysiwyg.validateCommonAncestorContainer(e)))){if(void 0===t)return e.contentEditable;t&&(mw.on.DOMChangePause=!0,e._handleCopy||(e._handleCopy=!0,mw.$(e).on("copy",(function(e){mw.wysiwyg.handleCopyEvent(e)})))),!0===t?t="true":!1===t&&(t="false"),"true"===t&&(mw.wysiwyg.isSafeMode(e)||(e=mw.tools.firstParentOrCurrentWithAnyOfClasses(e,["edit","regular-mode"]))),void 0!==mw.liveedit&&mw.liveedit.data.set("mouseup","isIcon")&&(t=!1),e&&e.contentEditable!==t&&(e.contentEditable=t),mw.on.DOMChangePause=!1}},prepareContentEditable:function(){mw.on("EditMouseDown",(function(e,t,o,i){if(mw.$(".safe-mode").each((function(){mw.wysiwyg.contentEditable(this,"inherit")})),mw.wysiwyg.isSafeMode(o)){var n=o,a=["p","div","h1","h2","h3","h4","h5","h6","header","section","footer","ul","ol"],r=["safe-element"];if(mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(n,["edit","module"])){if(-1===a.indexOf(n.nodeName.toLocaleLowerCase())&&!mw.tools.hasAnyOfClassesOnNodeOrParent(n,r)){var l=[];r.forEach((function(e){l.push("."+e)})),l=l.concat(a),n=mw.tools.firstMatchesOnNodeOrParent(n,l)}mw.$("[contenteditable='true']").not(n).attr("contenteditable","false"),mw.wysiwyg.contentEditable(n,!0)}}else{var s=mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(i.target,["edit","module"]);mw.$(".safe-mode").each((function(){mw.wysiwyg.contentEditable(this,!1)})),mw.wysiwyg.contentEditable(o,s)}}))},hide_drag_handles:function(){mw.$(".mw-wyswyg-plus-element").hide()},show_drag_handles:function(){mw.$(".mw-wyswyg-plus-element").show()},_external:function(){var e=document.createElement("div");return e.className="wysiwyg_external",document.body.appendChild(e),e},isSelectionEditable:function(e){try{var t=(e||window.getSelection()).focusNode;return null!==t&&(1===t.nodeType?t.isContentEditable:t.parentNode.isContentEditable)}catch(e){return!1}},execCommandFilter:function(e,t,o){var i,n=window.getSelection().focusNode,a=mw.wysiwyg.validateCommonAncestorContainer(n);if("insertorderedlist"===e||"insertunorderedlist"===e){var r=mw.tools.firstParentOrCurrentWithTag(a,"p");if(r){var l="insertorderedlist"===e?"ol":"ul",s=document.createElement(l),m=document.createElement("li");for(s.appendChild(m);r.firstChild;)m.appendChild(r.firstChild);return r.parentNode.insertBefore(s,r.nextSibling),void r.remove()}}return mw.wysiwyg.isSafeMode(a)&&-1!==["justifyCenter","justifyFull","justifyLeft","justifyRight"].indexOf(e)?("full"===(i=e.split("justify")[1].toLowerCase())&&(i="justify"),a.style.textAlign=i,mw.wysiwyg.change(a),!1):"P"!==a.nodeName||("full"===(i=e.split("justify")[1].toLowerCase())&&(i="justify"),a.style.textAlign=i,mw.wysiwyg.change(a),!1)},execCommand:function(e,t,o){document.execCommand("styleWithCss","false",!1);var i,n=getSelection(),a=n.focusNode;a&&(i=mw.wysiwyg.validateCommonAncestorContainer(a));try{if(document.queryCommandSupported(e)&&mw.wysiwyg.isSelectionEditable()){t=t||!1,o=o||!1;var r=mw.$(a).clone()[0];n.rangeCount>0&&mw.wysiwyg.execCommandFilter(e,t,o)&&document.execCommand(e,t,o),null!==a&&mw.loaded&&(mw.wysiwyg.change(a),mw.trigger("execCommand",[e,a,r,i]))}}catch(e){}},selection:"",_do:function(e){mw.wysiwyg.execCommand(e),"function"==typeof mw.wysiwyg.action[e]&&mw.wysiwyg.action[e]()},save_selected_element:function(){mw.$("#mw-text-editor").addClass("editor_hover")},deselect_selected_element:function(){mw.$("#mw-text-editor").removeClass("editor_hover")},nceui:function(){mw.settings.liveEdit&&(mw.wysiwyg.execCommand("enableObjectResizing",!1,"false"),mw.wysiwyg.execCommand("2D-Position",!1,!1),mw.wysiwyg.execCommand("enableInlineTableEditing",null,!1))},_pasteManager:void 0,pasteManager:function(e){return e=mw.wysiwyg.clean_word(e),mw.wysiwyg._pasteManager=this._pasteManager||document.createElement("div"),mw.wysiwyg._pasteManager.innerHTML=e,mw.$("*",mw.wysiwyg._pasteManager).removeAttr("style"),mw.wysiwyg._pasteManager.innerHTML},cleanExcel:function(e){var t=e.getData("text/html"),o=mw.tools.parseHtml(t).body;return mw.$("[style*='mso-spacerun']",o).remove(),mw.$("style",o).remove(),mw.$("table",o).width("100%").addClass("mw-wysiwyg-table").removeAttr("width"),o.innerHTML},pastedFromExcel:function(e){return-1!==e.getData("text/html").indexOf("ProgId content=Excel.Sheet")},areSameLike:function(e,t){return!(!e||!t||e.nodeType!==t.nodeType||e.className.trim()||t.className.trim()||(e.getAttribute("style")||"").replace(/\s/g,"")!==(t.getAttribute("style")||"").replace(/\s/g,"")||e.nodeName!==t.nodeName)},cleanUnwantedTags:function(e){var t=this;return mw.$("*",e).each((function(){"A"!==this.nodeName&&mw.ea.helpers.isInlineLevel(this)&&this.className.trim&&!this.className.trim()&&t.areSameLike(this,this.nextElementSibling)&&this.nextElementSibling===this.nextSibling&&(this.nextSibling!==this.nextElementSibling&&this.appendChild(this.nextSibling),this.innerHTML=this.innerHTML+this.nextElementSibling.innerHTML,this.nextElementSibling.innerHTML="",this.nextElementSibling.className="mw-skip-and-remove")})),mw.$(".mw-skip-and-remove",e).remove(),e},doLocalPaste:function(e){var t=e.getData("text/html"),o=mw.tools.parseHtml(t).body;mw.$("[style]",o).removeAttr("style"),mw.$("[id]",o).each((function(){this.id="dlp-item-"+mw.random()})),mw.wysiwyg.insert_html(o.innerHTML)},isLocalPaste:function(e){var t=e.getData("text/html"),o=mw.tools.parseHtml(t).body;return this._lastCopy&&this._lastCopy.innerHTML&&this._lastCopy.innerHTML.contains(t)||null!==o.querySelector(".module,.element,.edit")},paste:function(e){var t,o;if(o=e.originalEvent?e.originalEvent.clipboardData||window.clipboardData:e.clipboardData||window.clipboardData,mw.wysiwyg.isSafeMode(e.target)&&void 0!==o&&"function"==typeof o.getData&&mw.wysiwyg.editable(e.target))return(r=o.getData("text"))&&mw.wysiwyg.insert_html(r),e.preventDefault(),"";if(mw.wysiwyg.isLocalPaste(o))return mw.wysiwyg.doLocalPaste(o),e.preventDefault(),"";if(mw.wysiwyg.pastedFromExcel(o))return t=mw.wysiwyg.cleanExcel(o),mw.wysiwyg.insert_html(t),e.preventDefault(),"";if(o.files.length>0){for(var i=0;i<o.files.length;i++){var n=o.files[i];if(-1!=n.type.indexOf("image/")){var a=new FileReader;a.onload=function(e){mw.wysiwyg.insert_html('<img src="'+e.target.result+'">'),mw.wysiwyg.normalizeBase64Images()},a.readAsDataURL(n)}}e.preventDefault()}else if(void 0!==o&&"function"==typeof o.getData&&mw.wysiwyg.editable(e.target)){t=o.getData("text/html");var r=o.getData("text");if(!t&&r&&/\r\n/.test(r)){var l=mw.wysiwyg.validateCommonAncestorContainer(getSelection().focusNode),s=(l=mw.tools.firstMatchesOnNodeOrParent(l,[".element","p","div",".edit"])).nodeName.toLowerCase();t="<"+s+' id="element_'+mw.random()+'">'+r.replace(/\r\n/g,"<br>")+"</"+s+">"}t&&(mw.form&&mw.form.validate.url(t)&&(t="<a href='"+t+"'>"+t+"</a>"),t=mw.wysiwyg.pasteManager(t),mw.wysiwyg.insert_html(t),e.target.querySelector&&mw.$(e.target.querySelectorAll('[style*="outline"]')).css({outline:"none"}),e.preventDefault())}},hasContentFromWord:function(e){return e.getElementsByTagName("o:p").length>0||e.getElementsByTagName("v:shapetype").length>0||e.getElementsByTagName("v:path").length>0||null!==e.querySelector(".MsoNormal")},prepare:function(){mw.wysiwyg.external=mw.wysiwyg._external(),mw.$("#liveedit_wysiwyg").on("mousedown mouseup click",(function(e){e.preventDefault()})),mw.$(".element").not(".module"),mw.$(".mw_editor").hover((function(){mw.$(this).addClass("editor_hover")}),(function(){mw.$(this).removeClass("editor_hover")}))},deselect:function(e){(e=e||window.getSelection()).empty?e.empty():e.removeAllRanges()},editors_disabled:!1,enableEditors:function(){mw.$(".mw_editor, #mw_small_editor").removeClass("mw-editor-disabled"),mw.wysiwyg.editors_disabled=!1},disableEditors:function(){},checkForTextOnlyElements:function(e,t){if(e=e||!1,"selection"===(t=t||"selection")){var o=window.getSelection().focusNode;if(null!=(o=mw.tools.hasClass(o,"edit")?o:mw.tools.firstParentWithClass(o,"edit")).attributes&&o.attributes.field&&"title"==o.attributes.field.nodeValue)return e&&mw.event.cancel(e,!0),!1}},merge:{isMergeable:function(e){if(!e)return!1;if(3===e.nodeType)return!0;var t=!1,o=getComputedStyle(e),i=o.getPropertyValue("display");return o.getPropertyValue("position"),"inline"===i||(["p",".element","div:not([class])","h1","h2","h3","h4","h5","h6"].forEach((function(o){e.matches(o)&&(t=!0)})),t&&(null!==e.querySelector(".module")||mw.tools.hasClass(e,"module"))&&(t=!1),t)},manageBreakables:function(e,t,o,i){if(mw.wysiwyg.merge.isInNonbreakable(e,o)){if(getSelection().getRangeAt(0),i.preventDefault(),null===t)return!1;if(3===t.nodeType&&null!==/\r|\n/.exec(t.nodeValue))return i.preventDefault(),!1;"next"==o?mw.wysiwyg.cursorToElement(t):mw.wysiwyg.cursorToElement(t,"end")}},isInNonbreakable:function(e,t){if(3===(i=mw.wysiwyg.merge.findNextNearest(e,t)).nodeType&&null!==/\r|\n/.exec(i.nodeValue)&&(i=mw.wysiwyg.merge.findNextNearest(e,t,!0)),1===i.nodeType){if(mw.tools.hasAnyOfClasses(i,["nodrop","allow-drop"]))return!1;if(null!==i.querySelector(".nodrop",".allow-drop"))return!1}if(mw.wysiwyg.merge.alwaysMergeable(i)&&(mw.wysiwyg.merge.alwaysMergeable(i.firstElementChild)||!i.firstElementChild))return!1;if(""==e.textContent){var o=mw.wysiwyg.merge.findNextNearest(i,t);if(3==i.nodeType&&null!==/\r|\n/.exec(i.nodeValue))return mw.wysiwyg.merge.isInNonbreakableClass(o)}if(1===e.nodeType&&e.textContent.trim())return!1;if(null===e.nextSibling&&3===e.nodeType&&"next"==t){var i=mw.wysiwyg.merge.findNextNearest(e,t);return o=mw.wysiwyg.merge.findNextNearest(i,t),null!==/\r|\n/.exec(i.nodeValue)?mw.wysiwyg.merge.isInNonbreakableClass(o):1===o.nodeType?mw.wysiwyg.merge.isInNonbreakableClass(o)||mw.wysiwyg.merge.isInNonbreakableClass(o.firstChild):3===o.nodeType}return null===e.previousSibling&&3===e.nodeType&&"prev"==t?(i=mw.wysiwyg.merge.findNextNearest(e,"prev"),1===(o=mw.wysiwyg.merge.findNextNearest(i,"prev")).nodeType?mw.wysiwyg.merge.isInNonbreakableClass(o):3===o.nodeType):(e=mw.wysiwyg.validateCommonAncestorContainer(e),mw.wysiwyg.merge.isInNonbreakableClass(e))},isInNonbreakableClass:function(e,t){var o=mw.wysiwyg.merge.findNextNearest(e,t);if(3==e.nodeType&&null===/\r|\n/.exec(o.nodeValue))return!1;e=mw.wysiwyg.validateCommonAncestorContainer(e);var i=!1;return["unbreakable","*col","*row","*btn","*icon","module","edit"].forEach((function(t){0===t.indexOf("*")?(t=t.split("*")[1],-1!==e.className.indexOf(t)?i=!0:mw.tools.foreachParents(e,(function(o){-1===this.className.indexOf(t)||this.contains(e)?(i=!1,mw.tools.stopLoop(o)):(i=!0,mw.tools.stopLoop(o))}))):(mw.tools.hasClass(e,t)||mw.tools.hasParentsWithClass(e,t))&&(i=!0)})),i},getNext:function(e){for(var t=e.nextSibling;null!==e&&null===e.nextSibling;)t=(e=e.parentNode).nextSibling;return t},getPrev:function(e){for(var t=e.previousSibling;null!==e&&null===e.previousSibling;)t=(e=e.parentNode).previousSibling;return t},findNextNearest:function(e,t,o){var i,n;if(o=void 0!==o,"next"==t){if(null===(n=e[i=o?"nextElementSibling":"nextSibling"]))for(;null===e[i];)n=(e=e.parentNode)[i]}else if(null===(n=e[i=o?"previousElementSibling":"previousSibling"]))for(;null===e[i];)n=(e=e.parentNode)[i];return n},alwaysMergeable:function(e){if(!e)return!1;if(3===e.nodeType)return mw.wysiwyg.merge.alwaysMergeable(mw.wysiwyg.validateCommonAncestorContainer(e));if(1===e.nodeType){if(/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i.test(e.tagName))return!0;if(/^(?:strong|em|i|b|li)$/i.test(e.tagName))return!0;if(/^(?:span)$/i.test(e.tagName)&&!e.className)return!0}if(mw.tools.hasClass(e,"module"))return!1;mw.tools.hasParentsWithClass(e,"module")&&mw.tools.parentsOrder(e,["edit","module"]);for(var t=["p.element","div.element","div:not([class])","h1.element","h2.element","h3.element","h4.element","h5.element","h6.element",".edit  h1",".edit  h2",".edit  h3",".edit  h4",".edit  h5",".edit  h6",".edit p"],o=!1,i=0;i<t.length;i++){var n=t[i];if(e.matches(n)){o=!0;break}}return o}},init:function(e){e=e||".mw_editor_btn";var t=mw.$(e).not(".ready");t.addClass("ready").on("click",(function(e){if(mw.wysiwyg.editors_disabled)return!1;if(e.preventDefault(),!$(this).hasClass("disabled")){var t=mw.wysiwyg.validateCommonAncestorContainer(getSelection().focusNode);t=mw.tools.firstParentOrCurrentWithAnyOfClasses(t,["element","edit"]),mw.liveEditState&&"wysiwyg   "!==mw.liveEditState.state()[0].$id&&mw.liveEditState.record({target:t,value:t.innerHTML,$id:"wysiwyg"});var o=mw.$(this).dataset("command");if(o.contains("custom-")){var i=o.replace("custom-","");"link"===i?mw.wysiwyg.link(void 0,void 0,getSelection().toString()):mw.wysiwyg[i]()}else mw.wysiwyg._do(o);mw.liveEditState&&mw.liveEditState.record({target:t,value:t.innerHTML}),mw.$(this).removeClass("mw_editor_btn_mousedown"),mw.wysiwyg.check_selection(e.target)}"mousedown"!==e.type||$(this).hasClass("disabled")||mw.$(this).addClass("mw_editor_btn_mousedown")})),t.hover((function(){mw.$(this).addClass("mw_editor_btn_hover")}),(function(){mw.$(this).removeClass("mw_editor_btn_hover")})),mw.wysiwyg.ready||(mw.wysiwyg.ready=!0,mw.$(document.body).on("mouseup",(function(e){e.target.isContentEditable&&e.target.nodeName&&mw.wysiwyg.check_selection(e.target)})),mw.$(document.body).on("keydown",(function(e){if(46!=e.keyCode&&8!=e.keyCode||"keydown"!=e.type||(mw.tools.removeClass(mw.image_resizer,"active"),mw.wysiwyg.change(".element-current")),"keydown"===e.type){if(mw.tools.isField(e.target)||!e.target.isContentEditable)return!0;var t=window.getSelection();if(mw.event.is.enter(e)&&(setTimeout((function(){if(mw.liveEditDomTree){var e=mw.wysiwyg.validateCommonAncestorContainer(t.focusNode);mw.liveEditDomTree.refresh(e.parentNode)}}),10),mw.wysiwyg.isSafeMode(e.target)&&(mw.tools.firstMatchesOnNodeOrParent(e.target,["li","ul","ol"])||(e.preventDefault(),mw.id("mw-br-"),mw.wysiwyg.insert_html("<br>")))),t.rangeCount>0)return t.getRangeAt(0),9==e.keyCode&&!e.shiftKey&&t.focusNode.parentNode.iscontentEditable&&t.isCollapsed?(mw.wysiwyg.insert_html("&nbsp;&nbsp;&nbsp;&nbsp;"),!1):mw.wysiwyg.manageDeleteAndBackspace(e,t)}})),mw.on.tripleClick(document.body,(function(e){mw.wysiwyg.select_all(e),mw.tools.hasParentsWithClass(e,"element");var t=window.getSelection();if(t.rangeCount){var o=t.getRangeAt(0),i=(o.cloneContents(),o.commonAncestorContainer);1===i.nodeType?mw.tools.hasClass(i,"element")&&mw.wysiwyg.select_all(i):(i=mw.wysiwyg.validateCommonAncestorContainer(o.commonAncestorContainer),mw.tools.hasClass(i,"element")&&mw.wysiwyg.select_element(i));for(var n=i.querySelectorAll("*"),a=n.length,r=0;r<a;r++)if(t.containsNode&&t.containsNode(n[r],!0)){o.setEndBefore(n[r]);break}}})),mw.$(document.body).on("keyup",(function(e){if(mw.smallEditorCanceled=!0,mw.smallEditor.css({visibility:"hidden"}),e.target.isContentEditable&&!mw.tools.isField(e.target)){if(mw.wysiwyg.change(e.target),document.body.editor_typing_startTime||(document.body.editor_typing_startTime=new Date),mw.tools.hasAnyOfClasses(this,["isTyping"])){started_typing_endTime=new Date;var t=started_typing_endTime-document.body.editor_typing_startTime;t/=1e3;var o=Math.round(t);document.body.editor_typing_seconds=o}else mw.tools.addClass(this,"isTyping"),document.body.editor_typing_startTime=new Date,mw._initHandles&&mw._initHandles.hideAll();document.body.editor_typing_seconds&&document.body.editor_typing_seconds>10&&(mw.trigger("editUserIsTypingForLong",this),document.body.editor_typing_seconds=0,document.body.editor_typing_startTime=0),mw.$(this._onCloneableControl).hide(),mw.event.is.enter(e)}e.target.isContentEditable&&!e.shiftKey&&!e.ctrlKey&&27!==e.keyCode&&116!==e.keyCode&&17!==e.keyCode&&(e.keyCode<37||e.keyCode>40)&&mw.wysiwyg.change(e.target),e&&e.target&&mw.wysiwyg.check_selection(e.target)})))},createElementId:function(){return"mw-element_"+mw.random()},change:function(e){"string"==typeof e&&(e=document.querySelector(e));var t=null;mw.tools.hasClass(e,"edit")?(mw.tools.addClass(e,"changed"),t=e,mw.trigger("editChanged",t)):mw.tools.hasParentsWithClass(e,"edit")&&(t=mw.tools.firstParentWithClass(e,"edit"),mw.tools.addClass(t,"changed"),mw.trigger("editChanged",t)),null!==t&&(mw.tools.foreachParents(t,(function(){mw.tools.hasClass(this,"edit")&&(mw.tools.addClass(this,"changed"),mw.trigger("editChanged",this))})),mw.askusertostay=!0,mw.drag.initDraft=!0)},validateCommonAncestorContainer:function(e){if(!e||!e.parentNode||e.parentNode===document.body)return null;try{return"function"==typeof e.querySelector?e:mw.wysiwyg.validateCommonAncestorContainer(e.parentNode)}catch(e){return null}},editable:function(e){return(e=mw.wysiwyg.validateCommonAncestorContainer(e)).isContentEditable&&-1===["SELECT","INPUT","TEXTAREA"].indexOf(e.nodeName)},getNextNode:function(e){return e.nextSibling?e.nextSibling:this.getNextNode(e.parentNode)},cursorToElement:function(e,t){if(!e)return!1;if(!mw.tools.hasAnyOfClassesOnNodeOrParent(e,["safe-element","icon","mw-icon","material-icons","mw-wysiwyg-custom-icon"])){mw.wysiwyg.contentEditable(e,!0),t=(t||"start").trim();var o=window.getSelection(),i=document.createRange();if(o.removeAllRanges(),"start"===t)i.selectNodeContents(e),i.collapse(!0),o.addRange(i);else if("end"===t)i.selectNodeContents(e),i.collapse(!1),o.addRange(i);else if("before"===t)i.selectNode(e),i.collapse(!1),o.addRange(i);else if("after"===t){var n=document.createRange();n.setStartAfter(e),n.collapse(!0),o.removeAllRanges(),o.addRange(n)}}},rfapplier:function(e,t,o){getSelection().focusNode;var i=mw.id("mw-applier-element-");this.execCommand("insertHTML",!1,"<"+e+" "+(t?'class="'+t+'"':"")+' id="'+i+'">'+getSelection()+"</"+e+">");var n=mw.$("#"+i);return o&&n.css(o),n[0]},applier:function(e,t,o){if(t=t||"",mw.wysiwyg.isSelectionEditable()){var i=window.getSelection().getRangeAt(0),n=i.extractContents(),a=document.createElement(e);return a.className=t,void 0!==o&&mw.$(a).css(o),a.appendChild(n),i.insertNode(a),mw.wysiwyg.change(a),a}},external_tool:function(e,t){var o=(e=mw.$(e).eq(0)).offset();mw.$(mw.wysiwyg.external).css({top:o.top-mw.$(window).scrollTop()+e.height(),left:o.left}),mw.$(mw.wysiwyg.external).html("<iframe src='"+t+"' scrolling='no' frameborder='0' />");var i=mw.wysiwyg.external.querySelector("iframe");i.contentWindow.thisframe=i},getExternalData:function(e,t){var o=mw.storage.get(e);o?t.call(o,o):$.get(e,(function(o){mw.storage.set(e,o),t.call(o,o)}))},todo_external_tool:function(e,t){var o=(e=mw.$(e).eq(0)).offset();mw.$(mw.wysiwyg.external).css({top:o.top-mw.$(window).scrollTop()+e.height(),left:o.left}),mw.$(mw.wysiwyg.external).html("<iframe scrolling='no' frameborder='0' />");var i=mw.wysiwyg.external.querySelector("iframe");i.contentWindow.thisframe=i,-1!==t.indexOf("#")&&(i.src="#"+t.split("#")[1]),mw.wysiwyg.getExternalData(t,(function(e){i.contentWindow.document.open(),i.contentWindow.document.write(e),i.contentWindow.document.close()}))},createelement:function(){mw.wysiwyg.applier("div","mw_applier element")},fontcolorpicker:function(){mw.wysiwyg._fontcolorpicker.show(),setTimeout((function(){mw.wysiwyg._fontcolorpicker.show()}),20)},fontbgcolorpicker:function(){setTimeout((function(){mw.wysiwyg._bgfontcolorpicker.show()}),20)},fontColor:function(e){/^[0-9A-F]{3,6}$/i.test(e)&&!e.contains("#")&&(e="#"+e);var t=mw.wysiwyg.validateCommonAncestorContainer(getSelection().focusNode);t=mw.tools.firstParentOrCurrentWithAnyOfClasses(t,["element","edit"]),mw.liveEditState&&"wysiwyg   "!==mw.liveEditState.state()[0].$id&&mw.liveEditState.record({target:t,value:t.innerHTML,$id:"wysiwyg"}),"none"==e?mw.wysiwyg.execCommand("removeFormat",!1,"foreColor"):(document.execCommand("styleWithCSS",null,!0),mw.wysiwyg.execCommand("forecolor",null,e)),mw.liveEditState.record({target:t,value:t.innerHTML})},fontbg:function(e){/^[0-9A-F]{3,6}$/i.test(e)&&!e.contains("#")&&(e="#"+e),"none"===e?mw.wysiwyg.execCommand("removeFormat",!1,"backcolor"):(document.execCommand("styleWithCSS",null,!0),mw.wysiwyg.execCommand("backcolor",null,e))},request_change_bg_color:function(e){mw.wysiwyg.external_tool(e,mw.external_tool("color_picker")+"#change_bg_color"),mw.$(mw.wysiwyg.external).find("iframe").width(280).height(320)},change_bg_color:function(e){e="transparent"!==e?"#"+e:e,mw.$(".element-current").css("backgroundColor",e),mw.wysiwyg.change(".element-current")},request_border_color:function(e){mw.wysiwyg.external_tool(e,mw.external_tool("color_picker")+"#change_border_color"),mw.$(mw.wysiwyg.external).find("iframe").width(280).height(320)},change_border_color:function(e){"transparent"!=e?(mw.$(".element-current").css(mw.border_which+"Color","#"+e),mw.$(".ed_bordercolor_pick span").css("background","#"+e),mw.wysiwyg.change(".element-current")):(mw.$(".element-current").css(mw.border_which+"Color","transparent"),mw.$(".ed_bordercolor_pick span").css("background",""),mw.wysiwyg.change(".element-current"))},request_change_shadow_color:function(e){mw.wysiwyg.external_tool(e,mw.external_tool("color_picker")+"#change_shadow_color"),mw.$(mw.wysiwyg.external).find("iframe").width(280).height(320)},change_shadow_color:function(e){if(mw.current_element_styles=getComputedStyle(mw.$(".element-current")[0],null),"none"!=mw.current_element_styles.boxShadow){var t=mw.current_element_styles.boxShadow.split(" "),o=t.length,i=parseFloat(t[o-4]),n=parseFloat(t[o-3]),a=parseFloat(t[o-2]);mw.$(".element-current").css("box-shadow",i+"px "+n+"px "+a+"px #"+e),mw.$(".ed_shadow_color").dataset("color",e)}else mw.$(".element-current").css("box-shadow","0px 0px 6px #"+e),mw.$(".ed_shadow_color").dataset("color",e);mw.wysiwyg.change(".element-current")},fontFamily:function(e){var t=getSelection().getRangeAt(0);document.execCommand("styleWithCSS",null,!0);var o=mw.wysiwyg.validateCommonAncestorContainer(t.commonAncestorContainer);t.collapsed?(mw.wysiwyg.select_all(o),document.execCommand("fontName",null,e),t.collapse()):document.execCommand("fontName",null,e),mw.wysiwyg.change(o)},nestingFixes:function(e){},lineHeight:function(e){e="number"==typeof(e=e||"normal")?e+"px":e;var t=getSelection().getRangeAt(0).commonAncestorContainer;mw.wysiwyg.validateCommonAncestorContainer(t),t.style.fontSize=e,mw.wysiwyg.change(t)},fontSize:function(e){if(window.getSelection().isCollapsed)return!1;mw.wysiwyg.allStatements((function(){rangy.init();var t="mw-font-size-"+mw.random();rangy.createCssClassApplier("mw-font-size "+t,!0).applyToSelection();for(var o=document.querySelectorAll("."+t),i=o.length,n=0;n<i;n++)o[n].style.fontSize=e+"px",mw.tools.removeClass(o[n],t),mw.wysiwyg.change(o[n]);mw.$(".edit .mw-font-size").removeClass("mw-font-size")}))},fontSizePrompt:function(){var e=prompt("Please enter font size","");if(null!=e){var t=parseInt(e);t>0&&this.fontSize(t)}},resetActiveButtons:function(){mw.$(".mw_editor_btn_active").removeClass("mw_editor_btn_active")},setActiveButtons:function(e){mw.require("css_parser.js");var t=mw.CSSParser(e);if(t&&t.get){var o=t.get.font(),i=o.family.split(",");if(1==i.length)var n=o.family;else n=i.shift();var a=mw.$(".mw_dropdown_action_font_family");0!=a.length&&null!=a.setDropdownValue&&mw.$(".mw_dropdown_action_font_family").each((function(){mw.$(this).setDropdownValue(n)}))}},setActiveFontSize:function(){mw.require("css_parser.js");var e=getSelection(),t=e.getRangeAt(0);if(t.collapsed){var o=mw.wysiwyg.validateCommonAncestorContainer(e.focusNode);if(void 0!==(l=mw.CSSParser(o).get))var i=Math.round(parseFloat(l.font().size));mw.$(".mw_dropdown_action_font_size .mw-dropdown-val").html(i+"px")}else{var n=t.startContainer,a=t.endContainer,r=mw.wysiwyg.validateCommonAncestorContainer(t.commonAncestorContainer);for(i=Math.round(parseFloat(mw.CSSParser(r).get.font().size));n&&n!==a;){var l;if(o=mw.wysiwyg.validateCommonAncestorContainer(n),n=n.nextElementSibling,void 0!==(l=mw.CSSParser(o).get)&&Math.round(parseFloat(l.font().size))!==i)return void mw.$(".mw_dropdown_action_font_size .mw-dropdown-val").html(mw.lang("Size"))}mw.$(".mw_dropdown_action_font_size .mw-dropdown-val").html(i+"px")}},listSplit:function(e,t){if(e&&void 0!==t){for(var o=e.children[t],i=document.createElement(e.nodeName),n=document.createElement(e.nodeName),a={middle:o},r=0;r<t;r++)i.appendChild(e.children[r]);for(var l=1;l<e.children.length;l++)n.appendChild(e.children[l]);return i.children.length>0&&(a.top=i),n.children.length>0&&(a.bottom=n),a}},isFormatElement:function(e){return/^(div|h[1-6]|p)$/i.test(e.nodeName)},decorators:{b:".mw_editor_bold",strong:".mw_editor_bold",i:".mw_editor_italic",em:".mw_editor_italic",u:".mw_editor_underline",s:".mw_editor_strike",strike:".mw_editor_strike"},setDecorators:function(e){for(var t=(e=e||getSelection()).focusNode;"DIV"!==t.nodeName&&"BODY"!==t.nodeName;){for(var o in mw.wysiwyg.decorators)t.nodeName.toLowerCase()===o&&mw.$(mw.wysiwyg.decorators[o]).addClass("mw_editor_btn_active");t=t.parentNode}},started_checking:!1,check_selection:function(e){if(e=e||!1,mw.require("css_parser.js"),!mw.wysiwyg.started_checking){mw.wysiwyg.started_checking=!0;var t=window.getSelection();if(t.rangeCount>0){mw.wysiwyg.resetActiveButtons();var o=t.getRangeAt(0),i=(o.startContainer,o.endContainer,o.commonAncestorContainer),n=o.cloneContents().childNodes,a=0,r=n.length,l=mw.tools.firstParentWithTag(i,["ul","ol"]);if(l&&mw.$(".mw_editor_"+l.nodeName.toLowerCase()).addClass("mw_editor_btn_active"),3!==i.nodeType){var s=mw.CSSParser(i).get.alignNormalize();for(mw.$(".mw_editor_alignment").removeClass("mw_editor_btn_active"),mw.$(".mw-align-"+s).addClass("mw_editor_btn_active");a<r;a++)n[a].nodeName&&mw.wysiwyg.setActiveButtons(n[a])}else void 0!==i.parentElement&&null!==i.parentElement&&(s=mw.CSSParser(i.parentElement).get.alignNormalize(),mw.$(".mw_editor_alignment").removeClass("mw_editor_btn_active"),mw.$(".mw-align-"+s).addClass("mw_editor_btn_active"),mw.wysiwyg.setActiveButtons(i.parentElement));if(mw.wysiwyg.isFormatElement(i)){var m=i.nodeName.toLowerCase(),d=mw.$(".mw_dropdown_action_format");0!=d.length&&null!=d.setDropdownValue&&mw.$(".mw_dropdown_action_format").setDropdownValue(m)}else mw.tools.foreachParents(i,(function(e){if(mw.wysiwyg.isFormatElement(this)){var t=this.nodeName.toLowerCase(),o=mw.$(".mw_dropdown_action_format");0!=o.length&&null!=o.setDropdownValue&&mw.$(".mw_dropdown_action_format").setDropdownValue(t),mw.tools.stopLoop(e)}}));mw.wysiwyg.setActiveFontSize(),mw.wysiwyg.setDecorators(t)}e&&e.nodeName&&(mw.wysiwyg.setActiveButtons(e),"A"===e.tagName&&mw.$(".mw_editor_link").addClass("mw_editor_btn_active"),mw.tools.firstParentWithTag(e,"a")&&mw.$(".mw_editor_link").addClass("mw_editor_btn_active")),mw.wysiwyg.started_checking=!1}},link:function(e,t,o){mw.require("external_callbacks.js"),mw.wysiwyg.save_selection();var i,n=t?document.getElementById(t):mw.tools.firstParentWithTag(getSelection().focusNode,"a"),a=getSelection();if(n)i={url:e||n.href,text:o||n.innerHTML,target:"_blank"===n.target};else if(!a.isCollapsed){var r=document.createElement("div");if(a.rangeCount)for(var l=a.getRangeAt(0).cloneContents();l.firstChild;)r.append(l.firstChild);i={text:o||r.innerHTML,url:e||""}}new mw.LinkEditor({mode:"dialog"}).setValue(i).promise().then((function(e){mw.wysiwyg.restore_selection(),mw.iframecallbacks.insert_link(e,e.target?"_blank":"_self",e.text)}))},unlink:function(){if(window.getSelection().isCollapsed){var e=mw.wysiwyg.findTagAcrossSelection("a");e&&(mw.wysiwyg.select_element(e),mw.wysiwyg.execCommand("unlink",null,null))}else mw.wysiwyg.execCommand("unlink",null,null);mw.$(".mw_editor_link").removeClass("mw_editor_btn_active")},findTagAcrossSelection:function(e,t){if((t=t||window.getSelection()).anchorNode.nodeName.toLowerCase()===e)return t.anchorNode;var o=t.getRangeAt(0).commonAncestorContainer,i=mw.tools.firstParentWithTag(o,[e]);if(i)return i;if(void 0!==o.querySelectorAll){var n=o.querySelectorAll(e),a=n.length,r=0,l=[];if(a>0){for(;r<a;r++)t.containsNode(n[r],!0)&&l.push(n[r]);if(l.length>0)return 1===l.length?l[0]:l}}return!1},image_link:function(e){mw.$("img.element-current").wrap("<a href='"+e+"'></a>"),mw.wysiwyg.change(".element-current")},request_media:function(e,t){mw.require("external_callbacks.js"),t=t||!1,"#editimage"===e&&(t="images");var o=t?"rte_image_editor?types="+t+e:"rte_image_editor"+e;o=mw.settings.site_url+"editor_tools/"+o,mw.wysiwyg.save_selection(),mw.top().dialogIframe({url:o,name:"mw_rte_image",width:460,height:"auto",autoHeight:!0,overlay:!0},(function(t){"#set_bg_image"!==e?(mw.wysiwyg.restore_selection(),mw.require("files.js"),"#editimage"===e?mw.image.currentResizing&&("IMG"===mw.image.currentResizing[0].nodeName?(mw.image.currentResizing.attr("src",t),mw.image.currentResizing.css("height","auto")):(mw.image.currentResizing.css("backgroundImage","url("+mw.files.safeFilename(t)+")"),parent.mw.image.currentResizing&&mw.wysiwyg.bgQuotesFix(parent.mw.image.currentResizing[0])),mw.image.currentResizing&&mw.wysiwyg.change(mw.image.currentResizing[0]),mw.image.currentResizing.load((function(){mw.image.resize.resizerSet(this)}))):-1!==t.indexOf("<")?mw.wysiwyg.insert_html(t):mw.wysiwyg.insertMedia(t),this.remove()):mw.wysiwyg.set_bg_image(t)}))},media:function(e){if(mw.settings.liveEdit&&void 0===mw.target.item)return!1;if(e=(e=e||"insert_html").replace(/#/g,""),mw.wysiwyg.isSelectionEditable()||mw.$(mw.target.item).hasClass("image_change")||mw.$(mw.target.item.parentNode).hasClass("image_change")||mw.target.item===mw.image_resizer){var t;mw.wysiwyg.save_selection();var o=function(o){var i=o.src?o.src:o;"editimage"===e?mw.image.currentResizing&&("IMG"===mw.image.currentResizing[0].nodeName?(mw.image.currentResizing.attr("src",i),mw.image.currentResizing.css("height","auto")):(mw.image.currentResizing.css("backgroundImage","url("+mw.files.safeFilename(i)+")"),parent.mw.image.currentResizing&&mw.wysiwyg.bgQuotesFix(parent.mw.image.currentResizing[0])),mw.image.currentResizing&&mw.wysiwyg.change(mw.image.currentResizing[0]),mw.image.currentResizing.load((function(){mw.image.resize.resizerSet(this)}))):mw.wysiwyg.insertMedia(i),t.remove()},i=new mw.filePicker({type:"images",label:!1,autoSelect:!1,footer:!0,_frameMaxHeight:!0,fileUploaded:function(e){o(e.src),t.remove()},onResult:o,cancel:function(){t.remove()}});t=mw.dialog({content:i.root,title:mw.lang("Select image"),footer:!1,width:1200})}},request_bg_image:function(){mw.wysiwyg.request_media("#set_bg_image")},set_bg_image:function(e){mw.$(".element-current").css("backgroundImage","url("+e+")"),mw.wysiwyg.change(".element-current")},insert_html:function(e){if("string"==typeof e)var t=e.contains("<iframe")||e.contains("<embed")||e.contains("<object");else t=!1;if(t){var o="frame-"+mw.random(),i=e;e='<span id="'+o+'"></span>'}if(window.MSStream){if(mw.wysiwyg.restore_selection(),mw.wysiwyg.isSelectionEditable()){var n=window.getSelection().getRangeAt(0);(a=document.createElement("span")).innerHTML=e,n.insertNode(a),mw.$(a).replaceWith(a.innerHTML)}}else document.selection?document.selection.createRange().pasteHTML(e):mw.wysiwyg.execCommand("inserthtml",!1,e);if(t){var a=document.getElementById(o);mw.wysiwyg.contentEditable(a.parentNode,!1),mw.$(a).replaceWith(i)}var r=getSelection();r.rangeCount&&mw.wysiwyg.change(mw.wysiwyg.validateCommonAncestorContainer(r.getRangeAt(0).commonAncestorContainer))},selection_length:function(){for(var e=window.getSelection().getRangeAt(0).cloneContents().childNodes,t=e.length,o=0,i=0;o<t;o++){var n=e[o];1===n.nodeType?i+=n.textContent.length:3===n.nodeType&&(i+=n.nodeValue.length)}return i},insertMedia:function(e,t){var o=e.split(".").pop().toLowerCase(),i=e.split("/").pop();if(t||(-1!==["png","gif","jpg","jpeg","tiff","bmp","svg"].indexOf(o)&&(t="image"),-1!==["mp4","ogg"].indexOf(o)&&(t="video")),"image"===t)return this.insert_image(e);if("video"===t){var n='<span class="mwembed"><video id="image_'+mw.random()+'" contentEditable="false" src="'+e+'" controls></video></span>';mw.wysiwyg.insert_html(n)}else n='<a id="image_'+mw.random()+'" contentEditable="true" src="'+e+'">'+i+"</a>",mw.wysiwyg.insert_html(n)},insert_image:function(e){var t="image_"+mw.random(),o='<img id="'+t+'" contentEditable="true" class="element" src="'+e+'" />';return mw.wysiwyg.insert_html(o),mw.settings.liveEdit&&mw.$("#"+t).attr("contenteditable",!1),mw.$("#"+t).removeAttr("_moz_dirty"),mw.wysiwyg.change(document.getElementById(t)),t},save_selection:function(){var e=window.getSelection();if(e.rangeCount>0)var t=e.getRangeAt(0);else(t=document.createRange()).selectNode(document.querySelector(".edit .element"));mw.wysiwyg.selection={},mw.wysiwyg.selection.sel=e,mw.wysiwyg.selection.range=t,mw.wysiwyg.selection.element=mw.$(mw.wysiwyg.validateCommonAncestorContainer(t.commonAncestorContainer))},restore_selection:function(){mw.wysiwyg.selection&&(mw.wysiwyg.selection.element.attr("contenteditable","true"),mw.wysiwyg.selection.element.focus(),mw.wysiwyg.selection.sel.removeAllRanges(),mw.wysiwyg.selection.sel.addRange(mw.wysiwyg.selection.range))},select_all:function(e){var t=document.createRange();t.selectNodeContents(e);var o=window.getSelection();o.removeAllRanges(),o.addRange(t)},select_element:function(e){var t=document.createRange();try{t.selectNode(e);var o=window.getSelection();o.removeAllRanges(),o.addRange(t)}catch(e){}},formatNative:function(e){var t=mw.wysiwyg.validateCommonAncestorContainer(window.getSelection().focusNode);mw.wysiwyg.isSafeMode()&&(mw.$("[contenteditable]").removeAttr("contenteditable"),mw.tools.firstBlockLevel(t.parentNode).contentEditable=!0),mw.wysiwyg.execCommand("formatBlock",!1,"<"+e+">"),mw.wysiwyg.execCommand("formatBlock",!1,e)},format:function(e){var t=mw.wysiwyg.validateCommonAncestorContainer(getSelection().getRangeAt(0).commonAncestorContainer);mw.liveEditState.record({target:t.parentNode,value:t.parentNode.innerHTML});var o=mw.tools.setTag(t,e);mw.wysiwyg.cursorToElement(o,"end"),mw.liveEditState.record({target:o.parentNode,value:o.parentNode.innerHTML})},fontFamilies:["Arial","Tahoma","Verdana","Georgia","Times New Roman"],fontFamiliesExtended:[],fontFamiliesTemplate:[],initFontSelectorBox:function(){mw.wysiwyg.initFontFamilies();for(var e=mw.wysiwyg.fontFamilies.length,t=0,o="";t<e;t++)o+='<li value="'+mw.wysiwyg.fontFamilies[t]+'"><a style="font-family:'+mw.wysiwyg.fontFamilies[t]+'" href="javascript:;">'+mw.wysiwyg.fontFamilies[t]+"</a></li>";for(e=mw.wysiwyg.fontFamiliesTemplate.length,t=0;t<e;t++)-1===mw.wysiwyg.fontFamilies.indexOf(mw.wysiwyg.fontFamiliesTemplate[t])&&""!=mw.wysiwyg.fontFamiliesTemplate[t]&&(o+='<li value="'+mw.wysiwyg.fontFamiliesTemplate[t]+'"><a style="font-family:'+mw.wysiwyg.fontFamiliesTemplate[t]+'" href="javascript:;">'+mw.wysiwyg.fontFamiliesTemplate[t]+"</a></li>");for(e=mw.wysiwyg.fontFamiliesExtended.length,t=0;t<e;t++)-1===mw.wysiwyg.fontFamilies.indexOf(mw.wysiwyg.fontFamiliesExtended[t])&&""!=mw.wysiwyg.fontFamiliesExtended[t]&&(o+='<li value="'+mw.wysiwyg.fontFamiliesExtended[t]+'"><a style="font-family:'+mw.wysiwyg.fontFamiliesExtended[t]+'" href="javascript:;">'+mw.wysiwyg.fontFamiliesExtended[t]+"</a></li>");mw.$(".mw_dropdown_action_font_family ul").empty().append(o),mw.$(".mw_dropdown_action_font_family").off("change"),mw.$(".mw_dropdown_action_font_family").on("change",(function(){var e=mw.$(this).getDropdownValue();mw.wysiwyg.fontFamily(e)})),mw.$(".mw_dropdown_action_font_family").each((function(){mw.$("[value]",mw.$(this)).on("mousedown touchstart",(function(e){return mw.$(mw.tools.firstParentWithClass(this,"mw-dropdown")).setDropdownValue(this.getAttribute("value"),!0),!1}))}))},initFontFamilies:function(){if(null!=window.getComputedStyle(document.body)){var e=window.getComputedStyle(document.body,null).fontFamily.split(",")[0].replace(/'/g,"").replace(/"/g,"");-1===mw.wysiwyg.fontFamilies.indexOf(e)&&mw.wysiwyg.fontFamilies.push(e),$.each(["body","html","h1","h2","h3","h4","h5","p","a[class]"],(function(e,t){var o=mw.$(document.querySelector(t));if(o.length>0){var i=window.getComputedStyle(o[0],null).fontFamily.split(",");$.each(i,(function(e,t){var o=t;o=o.replace(/'/gi,"").replace(/"/gi,""),-1===mw.wysiwyg.fontFamilies.indexOf(o)&&mw.wysiwyg.fontFamilies.push(o)}))}}))}},initExtendedFontFamilies:function(e){var t=[];"string"==typeof e?t=e.split(","):"object"==typeof e&&(t=e),$.each(t,(function(e,t){var o=t;o=o.replace(/'/gi,"").replace(/"/gi,""),-1===mw.wysiwyg.fontFamilies.indexOf(o)&&-1===mw.wysiwyg.fontFamiliesExtended.indexOf(o)&&mw.wysiwyg.fontFamiliesExtended.push(o)}))},fontIconFamilies:["fas","fab","far","fa","mw-ui-icon","mw-icon","material-icons","mw-wysiwyg-custom-icon","icon","mdi"],elementHasFontIconClass:function(e){var t=mw.wysiwyg.fontIconFamilies;if("I"===e.tagName||"SPAN"===e.tagName)return!!mw.tools.hasAnyOfClasses(e,t)||-1!==e.className.indexOf("mw-micon-")||-1!==e.className.indexOf("mw-icon-")||mw.tools.firstParentOrCurrentWithAnyOfClasses(e.parentNode,t)},firstElementThatHasFontIconClass:function(e){var t=mw.wysiwyg.fontIconFamilies.map((function(e){return"."+e}));t.push('[class*="mw-micon-"]');var o=mw.tools.firstMatchesOnNodeOrParent(e,t);if(o&&("I"===o.tagName||"SPAN"===o.tagName))return o},elementRemoveFontIconClasses:function(e){for(var t=mw.wysiwyg.fontIconFamilies.length,o=0;o<t;o++){var i=mw.wysiwyg.fontIconFamilies[o];mw.tools.classNamespaceDelete(e,i+"-")}},iframe_editor:function(e,t,o){o=o||!1;var i=mw.$(e).attr("id");mw.$("#iframe_editor_"+i).remove();var n=t,a=document.createElement("iframe");return a.className="mw-editor-iframe-loading",a.id="iframe_editor_"+i,a.width=mw.$(e).width(),a.height=mw.$(e).height(),a.scrolling="no",a.setAttribute("frameborder",0),a.src=n,a.style.resize="vertical",a.onload=function(){a.className="mw-editor-iframe-loaded";var t=mw.$(this).contents().find(".edit");null!=(t=mw.$(this).contents().find("[field='content']")[0])&&(mw.wysiwyg.contentEditable(t,!0),mw.$(t).on("blur keyup",(function(){e.value=mw.$(this).html()})),o&&mw.$(t).html(o),mw.on.DOMChange(t,(function(){e.value=mw.$(this).html(),mw.askusertostay=!0})))},mw.$(e).after(a),mw.$(e).hide(),a},word_listitem_get_level:function(e){var t=e.getAttribute("style").split("mso-list");if(t.length>1)for(var o=t[1].split(" "),i=0;i<o.length;i++)if(-1!==o[i].indexOf("level"))return parseInt(o[i].split("level")[1],10)},word_list_build:function(e,t){var o,i=0;if(0===(t=t||0))for(o in e){var n=e[o];n.nodeName&&1===n.nodeType&&(mw.$(n),e[o]=mw.tools.setTag(n,"li"))}return e.each((function(){var e=this.textContent.trim().split(".")[0],t=parseInt(e,10);if((l=mw.$(this)).attr("data-type")||(!isNaN(t)&&e>0?(this.innerHTML=this.innerHTML.replace(e+".",""),l.attr("data-type","ol")):l.attr("data-type","ul")),!this.__done){this.__done=!1;var o=parseInt($(this).attr("data-level"));if(!isNaN(o)&&o>i&&(i=o),!isNaN(o)&&o>1){var n=this.previousElementSibling;if(n&&"LI"==n.nodeName){var a=this.getAttribute("data-type");(s=document.createElement("ul"==a?"ul":"ol")).setAttribute("data-level",o),mw.$(s).append(this),mw.$(s).appendTo(n),t=!0}else if(!n||"UL"!=n.nodeName&&"OL"!=n.nodeName){if(!n&&"UL"!=this.parentNode.nodeName&&"OL"!=this.parentNode.nodeName){for(var r=mw.$([this]),l=this;$(l).next('li[data-level="'+o+'"]').length>0;)r.push($(l).next('li[data-level="'+o+'"]')[0]),l=mw.$(l).next('li[data-level="'+o+'"]')[0];r.wrapAll("ul"==r.eq(0).attr("data-type")?"<ul></ul>":"<ol></ol>"),t=!0}}else{var s,m=mw.$('li[data-level="'+o+'"]',n);m.length>0?(m.after(this),t=!0):(a=this.getAttribute("data-type"),(s=document.createElement("ul"==a?"ul":"ol")).setAttribute("data-level",o),mw.$(s).append(this),mw.$(s).appendTo($("li:last",n)),t=!0)}}}})),mw.$("ul[data-level!='1'], ol[data-level!='1']").each((function(){var e=parseInt($(this).attr("data-level"));this.previousElementSibling&&e>parseInt($(this.previousElementSibling).attr("data-level"))&&mw.$("li:last",this.previousElementSibling).append(this)})),0===t&&setTimeout((function(){mw.wysiwyg.word_list_build($("li[data-level]"),1),mw.wysiwyg.wrap_li_roots()}),1),e},wrap_li_roots:function(){for(var e=document.querySelectorAll("li[data-level]"),t=0,o=!1;t<e.length;t++){var i=e[t].parentElement.nodeName;if("OL"!=i&&"UL"!=i){o=!0;for(var n=mw.$([]),a=e[t];a&&"LI"==a.nodeName;)n.push(a),a=a.nextElementSibling;var r=document.createElement("ul"==e[t].getAttribute("data-type")?"ul":"ol");r.className="element",n.wrapAll(r);break}}if(o)return mw.wysiwyg.wrap_li_roots()},isWordHtml:function(e){return-1!==e.indexOf("urn:schemas-microsoft-com:office:word")},bgQuotesFix:function(e){if((e=mw.$(e)[0])&&1===e.nodeType){var t=e.outerHTML.split(">")[0];-1!==e.style.backgroundImage.indexOf('"')&&-1!==t.indexOf('style="')&&(e.attributes.style.nodeValue=e.attributes.style.nodeValue.replace(/\"/g,"'"))}},clean_word_list:function(e){if(!mw.wysiwyg.isWordHtml(e))return e;-1!=e.indexOf("</body>")&&(e=e.split("</body>")[0]);var t=mw.tools.parseHtml(e).body,o=mw.$('[style*="mso-list:"]',t);return o.each((function(){var e=mw.wysiwyg.word_listitem_get_level(this);e&&(this.setAttribute("data-level",e),this.setAttribute("class","level-"+e))})),mw.$("[style]",t).removeAttr("style"),o.length>0&&(o=mw.wysiwyg.word_list_build(o),mw.$([]),mw.$("li",t).each((function(){this.innerHTML=this.innerHTML.replace(//g,"").replace(new RegExp(String.fromCharCode(160),"g"),"").replace(/&nbsp;/gi,"").replace(/\/g,"").replace(/<\/?span[^>]*>/g,"").replace("","")}))),t.innerHTML},clean_word:function(e){return(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=mw.wysiwyg.clean_word_list(e)).replace(/<td([^>]*)>/gi,"<td>")).replace(/<table([^>]*)>/gi,'<table cellspacing="0" cellpadding="0" border="1" style="width:100%;" width="100%" class="element">')).replace(/<o:p>\s*<\/o:p>/g,"")).replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;")).replace(/\s*mso-[^:]+:[^;"]+;?/gi,"")).replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"")).replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,'"')).replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"")).replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"')).replace(/\s*TEXT-ALIGN: [^\s;]+;?"/gi,'"')).replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,'"')).replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"')).replace(/\s*tab-stops:[^;"]*;?/gi,"")).replace(/\s*tab-stops:[^"]*/gi,"")).replace(/\s*face="[^"]*"/gi,"")).replace(/\s*face=[^ >]*/gi,"")).replace(/\s*FONT-FAMILY:[^;"]*;?/gi,"")).replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<STYLE[^>]*>[\s\S]*?<\/STYLE[^>]*>/gi,"")).replace(/<(?:META|LINK)[^>]*>\s*/gi,"")).replace(/\s*style="\s*"/gi,"")).replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,"&nbsp;")).replace(/<SPAN\s*[^>]*><\/SPAN>/gi,"")).replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<SPAN\s*>([\s\S]*?)<\/SPAN>/gi,"$1")).replace(/<FONT\s*>([\s\S]*?)<\/FONT>/gi,"$1")).replace(/<\\?\?xml[^>]*>/gi,"")).replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"")).replace(/<\/?\w+:[^>]*>/gi,"")).replace(/<\!--[\s\S]*?-->/g,"")).replace(/<(U|I|STRIKE)>&nbsp;<\/\1>/g,"&nbsp;")).replace(/<H\d>\s*<\/H\d>/gi,"")).replace(/<(\w+)[^>]*\sstyle="[^"]*DISPLAY\s?:\s?none[\s\S]*?<\/\1>/gi,"")).replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseover="([^\"]*)"([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseout="([^\"]*)"([^>]*)/gi,"<$1$3")).replace(/<H(\d)([^>]*)>/gi,"<h$1>")).replace(/<font size=2>(.*)<\/font>/gi,"$1")).replace(/<font size=3>(.*)<\/font>/gi,"$1")).replace(/<a name=.*>(.*)<\/a>/gi,"$1")).replace(/<H1([^>]*)>/gi,"<H2$1>")).replace(/<\/H1\d>/gi,"</H2>")).replace(/<\/span\d>/gi,"")).replace(/<(H\d)><FONT[^>]*>([\s\S]*?)<\/FONT><\/\1>/gi,"<$1>$2</$1>")).replace(/<(H\d)><EM>([\s\S]*?)<\/EM><\/\1>/gi,"<$1>$2</$1>")},cleanTables:function(e){for(var t=e.querySelectorAll("tbody > *:not(tr), thead > *:not(tr), tr > *:not(td)"),o=t.length,i=0;i<o;i++)mw.$(t[i]).remove();var n=e.querySelectorAll("table");for(o=n.length,i=0;i<o;i++)for(o=(a=n[i]).children.length,i=0;i<o;i++){var a;if(void 0!==(a=a.children[i])&&3!==a.nodeType){var r=a.nodeName.toLowerCase();"thead tfoot tr tbody col colgroup".contains(r)||mw.$(a).remove()}}},cleanHTML:function(e){e=e||document.body,mw.tools.foreachChildren(e,(function(){mw.wysiwyg.hasContentFromWord(this)&&(this.innerHTML=mw.wysiwyg.clean_word(this.innerHTML)),mw.wysiwyg.cleanTables(this)}))},normalizeBase64Image:function(e,t){if(void 0!==e.src&&0===e.src.indexOf("data:image/")){var o=e.src.split("/")[1].split(";")[0],i={file:e.src,name:mw.random().toString(36)+"."+o};$.post(mw.settings.api_url+"media/upload",i,(function(o){o=$.parseJSON(o),e.src=o.src,"function"==typeof t&&t.call(e),mw.wysiwyg.change(e),mw.trigger("imageSrcChanged",[e,e.src])}))}else if(-1!==e.style.backgroundImage.indexOf("data:image/")){var n=e.style.backgroundImage.replace(/url\(/g,"").replace(/\)/g,"");o=n.split("/")[1].split(";")[0],i={file:n,name:mw.random().toString(36)+"."+o},$.post(mw.settings.api_url+"media/upload",i,(function(o){o=$.parseJSON(o),e.style.backgroundImage="url('"+o.src+"')","function"==typeof t&&t.call(e),mw.wysiwyg.change(e),mw.trigger("nodeBackgroundChanged",[e,e.src])}))}},normalizeBase64Images:function(e){var t=(e=e||document.body).querySelectorAll(".edit img[src*='data:image/'], .edit [style*='data:image/'][style*='background-image']"),o=t.length,i=0;if(o>0)for(;i<o;i++)mw.tools.addClass(t[i],"element"),mw.wysiwyg.normalizeBase64Image(t[i])},documentCommonFonts:function(){var e=$("html, body, h1:first, h2:first, p:first"),t=[];return e.each((function(){var e=$(this).css("fontFamily").split(",")[0].trim();-1===t.indexOf(e)&&t.push(e)})),t}},mw.disable_selection=function(e){var t=e||".module";(t=mw.$(t,".edit").not(".unselectable")).attr("unselectable","on"),t.addClass("unselectable"),t.on("selectstart",(function(e){return e.preventDefault(),!1}))},mw.wysiwyg.dropdowns=function(){mw.$(".mw_dropdown_action_font_size").not(".ready").addClass("ready").change((function(){var e=mw.$(this).getDropdownValue();mw.wysiwyg.fontSize(e),mw.$(".mw-dropdown-val",this).append("px")})),mw.$(".mw_dropdown_action_format").not(".ready").addClass("ready").change((function(){var e=mw.$(this).getDropdownValue();mw.wysiwyg.format(e)})),mw.wysiwyg.initFontSelectorBox(),mw.$("#wysiwyg_insert").not(".ready").addClass("ready").on("change",(function(){var e=window.getSelection().focusNode,t=mw.tools.firstParentOrCurrentWithClass(e,"plain-text");if(mw.wysiwyg.isSelectionEditable()){var o=mw.$(this).getDropdownValue();if("icon"!=o&&t)return!1;if("hr"==o)mw.wysiwyg._do("InsertHorizontalRule");else if("box"==o){var i=mw.wysiwyg.applier("div","mw-ui-box mw-ui-box-content element");mw.wysiwyg.selection_length()<=2&&mw.$(i).append("<p>&nbsp;</p>")}else if("pre"==o)i=mw.wysiwyg.applier("pre",""),mw.wysiwyg.selection_length()<=2&&mw.$(i).append("&nbsp;");else if("code"===o)null!=(n=prompt("Paste your code"))&&((i=mw.wysiwyg.applier("code")).innerHTML=n);else if("insert_html"===o){var n;null!=(n=prompt("Paste your html code in the box"))&&mw.wysiwyg.insert_html(n)}else if("icon"===o){var a=mw.wysiwyg.applier("i");a.className="mw-icon",mw.editorIconPicker.tooltip(a)}else"table"===o?mw.wysiwyg.applier("div","element",{width:"100%"}).innerHTML='<table class="mw-wysiwyg-table"><tbody><tr><td>Lorem Ipsum</td><td  >Lorem Ipsum</td></tr><tr><td  >Lorem Ipsum</td><td  >Lorem Ipsum</td></tr></tbody></table>':"quote"===o&&(i=mw.wysiwyg.applier("blockquote","element"),mw.$(i).append("<cite>By Lorem Ipsum</cite>"))}mw.$(this).find(".mw-dropdown-val").html("insert").find(".mw-dropdown-content").hide(),mw.$(this).find(".mw-dropdown-content").hide()}))},$(mwd).ready((function(){mw.wysiwyg.initClassApplier(),mw.wysiwyg.dropdowns(),mw.editorIconPicker=mw.iconPicker({iconOptions:{reset:!0}}),mw.editorIconPicker.on("select",(function(e){e.render(),mw.wysiwyg.change(mw.editorIconPicker.target)})),mw.editorIconPicker.on("sizeChange",(function(e){mw.editorIconPicker.target.style.fontSize=e+"px",mw.tools.tooltip.setPosition(mw.editorIconPicker._tooltip,mw.editorIconPicker.target,"bottom-center"),mw.wysiwyg.change(mw.editorIconPicker.target)})),mw.editorIconPicker.on("colorChange",(function(e){mw.editorIconPicker.target.style.color=e,mw.wysiwyg.change(mw.editorIconPicker.target)})),mw.editorIconPicker.on("reset",(function(e){mw.editorIconPicker.target.style.color="",mw.editorIconPicker.target.style.fontSize="",mw.tools.tooltip.setPosition(mw.editorIconPicker._tooltip,mw.editorIconPicker.target,"bottom-center"),mw.wysiwyg.change(mw.editorIconPicker.target)})),mw.wysiwyg._fontcolorpicker||(mw.lib.require("colorpicker"),mw.wysiwyg._fontcolorpicker=mw.colorPicker({element:document.querySelector("#mw_editor_font_color"),tip:!0,showHEX:!1,onchange:function(e){mw.wysiwyg.fontColor(e)}})),mw.wysiwyg._bgfontcolorpicker||(mw.wysiwyg._bgfontcolorpicker=mw.colorPicker({element:document.querySelector(".mw_editor_font_background_color"),tip:!0,showHEX:!1,onchange:function(e){mw.wysiwyg.fontbg(e)}})),mw.$(document).on("scroll",(function(){mw.wysiwyg._bgfontcolorpicker&&mw.wysiwyg._bgfontcolorpicker.settings&&(mw.tools.tooltip.setPosition(mw.wysiwyg._bgfontcolorpicker.tip,mw.wysiwyg._bgfontcolorpicker.settings.element,mw.wysiwyg._bgfontcolorpicker.settings.position),mw.tools.tooltip.setPosition(mw.wysiwyg._fontcolorpicker.tip,mw.wysiwyg._fontcolorpicker.settings.element,mw.wysiwyg._fontcolorpicker.settings.position))})),mw.wysiwyg.nceui(),mw.smallEditor=mw.$("#mw_small_editor"),mw.smallEditorCanceled=!0,mw.bigEditor=mw.$("#mw-text-editor"),mw.$(document.body).on("mousedown touchstart",(function(e){var t=e.target;$(t).hasClass("element")?mw.trigger("ElementMouseDown",t):$(t).parents(".element").length>0&&mw.trigger("ElementMouseDown",mw.$(t).parents(".element")[0]),$(t).hasClass("edit")?mw.trigger("EditMouseDown",[t,t,e]):$(t).parents(".edit").length>0&&mw.trigger("EditMouseDown",[$(t).parents(".edit")[0],t,e]);var o=document.getElementById("mw-history-panel");null!==o&&"none"!=o.style.display&&(o.contains(t)||(o.style.display="none",mw.$("#history_panel_toggle").removeClass("mw_editor_btn_active")))})),mw.wysiwyg.editorFonts=[]})),$(window).on("load",(function(){mw.$(this).on("imageSrcChanged",(function(e,t,o){mw.require("files.js");var i=mw.tools.firstParentOrCurrentWithAnyOfClasses(t,["mw-image-holder"]);if(i){o=mw.files.safeFilename(o);var n=i.querySelector("img");n&&(n.src=o),mw.$(i).css("backgroundImage","url("+o+")")}})),mw.$(window).on("keydown",(function(e){if("keydown"===e.type&&(13===e.keyCode&&("title"===mw.tools.mwattr(e.target,"field")||mw.tools.hasClass(e.target,"plain-text"))&&e.preventDefault(),e.ctrlKey))if(mw.tools.firstParentOrCurrentWithClass(e.target,"plain-text"))65!=e.keyCode&&e.keyCode;else{var t=e.keyCode;66===t?(mw.wysiwyg.execCommand("bold"),e.preventDefault()):73==t?(mw.wysiwyg.execCommand("italic"),e.preventDefault()):85==t&&(mw.wysiwyg.execCommand("underline"),e.preventDefault())}})),mw.$(".mw_editor").each((function(){mw.tools.dropdown(this)}));for(var e=document.querySelectorAll(".edit"),t=e.length,o=0;o<t;o++){var i=e[o],n=mw.tools.mwattr(i,"rel");"content"==mw.tools.mwattr(i,"field")&&"content"==n&&null!==i.querySelector("p")&&(i=i.querySelector("p")),e[o].pasteBinded||mw.tools.hasParentsWithClass(e[o],"edit")||(e[o].pasteBinded=!0,e[o].addEventListener("paste",(function(e){mw.wysiwyg.paste(e),mw.wysiwyg.change(e.target)})))}mw.require("wysiwygmdab.js")})),mw.linkTip={init:function(e){if(null===e||!e)return!1;mw.$(e).on("click",(function(e){var t=mw.linkTip.find(e.target);t?(mw.linkTip.tip(t),e.preventDefault()):mw.$(".mw-link-tip").remove()}))},find:function(e){if(!mw.tools.hasClass(e,"module")){var t=mw.tools.firstMatchesOnNodeOrParent(e,["a"]);if(t&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(t,["edit","module"]))return t}},tip:function(e){if(e){var t=document.createElement("a");t.href=e.getAttribute("href"),t.target="_blank",t.className="mw-link-tip-link",t.innerHTML=e.getAttribute("href");var o=document.createElement("span");o.className="mw-link-tip-edit",o.innerHTML=mw.lang("Edit");var i=document.createElement("div");i.appendChild(t),i.append(" - "),i.appendChild(o),o.onclick=function(t){return t.preventDefault(),new mw.LinkEditor({mode:"dialog"}).setValue({url:e.href,text:e.innerHTML,target:"_blank"===e.target}).promise().then((function(t){e.href=t.url,e.innerHTML=t.text})),mw.$(".mw-link-tip").remove(),!1},mw.linkTip._tip=mw.tooltip({content:i,position:"bottom-center",skin:"dark",element:e}),mw.$(mw.linkTip._tip).addClass("mw-link-tip")}}},t=function(e){var t=e.target;return!mw.tools.hasAnyOfClassesOnNodeOrParent(e,["safe-element"])&&mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(t,["allow-drop","nodrop"])},mw.wysiwyg._manageDeleteAndBackspaceInSafeMode={emptyNode:function(e,o,i,n){if(t(o)){var a,r,l=o;mw.tools.hasAnyOfClasses(o.parentNode,["text","title"])&&(l=o.parentNode),mw.event.is.delete(e)?(a=l.nextElementSibling,r="start"):(a=l.previousElementSibling,r="end");var s=l.parentNode;mw.liveEditState.record({target:s,value:s.innerHTML}),$(l).remove(),a&&mw.tools.isEditable(a)&&setTimeout((function(){mw.wysiwyg.cursorToElement(a,r)})),mw.liveEditState.record({target:s,value:s.innerHTML})}},nodeBoundaries:function(e,o,i,n){var a,r,l=0===n.startOffset||!(i.anchorNode.data||"").substring(0,n.startOffset).replace(/\s/g,"");if(mw.event.is.backSpace(e)&&l&&n.collapsed){a=o,mw.tools.hasAnyOfClasses(o.parentNode,["text","title"])&&(a=o.parentNode);var s=a.previousElementSibling;s&&s.nodeName===o.nodeName&&t(o)&&(r=o.innerHTML,mw.wysiwyg.cursorToElement(s,"end"),s.appendChild(n.createContextualFragment(r)),$(a).remove())}else if(mw.event.is.delete(e)&&n.collapsed&&n.startOffset===i.anchorNode.data.replace(/\s*$/,"").length&&t(o)){a=o,mw.tools.hasAnyOfClasses(o.parentNode,["text","title"])&&(a=o.parentNode);var m,d=a.nextElementSibling;mw.tools.hasAnyOfClasses(d,["text","title"])&&(d=d.firstElementChild,m=!0),d&&d.nodeName===a.nodeName&&(r=d.innerHTML,setTimeout((function(){var e=m?d.parentNode.parentNode:d.parentNode;mw.liveEditState.actionRecord((function(){return{target:e,value:e.innerHTML}}),(function(){a.append(n.createContextualFragment(r))}))})))}}},mw.wysiwyg.manageDeleteAndBackspaceInSafeMode=function(e,t){var o=mw.wysiwyg.validateCommonAncestorContainer(t.focusNode),i=t.getRangeAt(0);return o.innerText.replace(/\s/gi,"")?(mw.wysiwyg._manageDeleteAndBackspaceInSafeMode.nodeBoundaries(e,o,t,i),!0):(mw.wysiwyg._manageDeleteAndBackspaceInSafeMode.emptyNode(e,o,t,i),!1)},mw.wysiwyg.manageDeleteAndBackspace=function(e,t){if(mw.settings.liveEdit||self!==top){if(mw.event.is.delete(e)||mw.event.is.backSpace(e)){if(!t.rangeCount)return;var o=t.getRangeAt(0);if(mw.wysiwyg.isSafeMode())return mw.wysiwyg.manageDeleteAndBackspaceInSafeMode(e,t);if(!mw.settings.liveEdit)return!0;var i,n,a,r=null;if(mw.event.is.delete(e)?(i=t.focusNode.textContent.charAt(t.focusOffset),n=t.focusNode.textContent.charAt(t.focusOffset+1),a=t.focusNode.nextSibling||t.focusNode.nextElementSibling):(i=t.focusNode.textContent.charAt(t.focusOffset-1),n=t.focusNode.textContent.charAt(t.focusOffset-2),a=t.focusNode.previouSibling||t.focusNode.previousElementSibling),(" "===i||null!==/\r|\n/.exec(i))&&3===t.focusNode.nodeType&&!n)return e.preventDefault(),!1;if(""===n)if(""===i.replace(/\s/g,"")&&o.collapsed){if(!(!a||mw.ea.helpers.isBlockLevel(a)||void 0!==a.className&&a.className.trim()))return!0;if(a&&"BR"!==a.nodeName){if("P"===t.focusNode.nodeName){if(46===e.keyCode&&"P"===t.focusNode.nextElementSibling.nodeName)return!0;if(8===e.keyCode&&"P"===t.focusNode.previousElementSibling.nodeName)return!0}return e.preventDefault(),!1}}else if(null===focus.previousElementSibling&&null===rootfocus.previousElementSibling&&mw.tools.hasAnyOfClassesOnNodeOrParent(rootfocus,["nodrop","allow-drop"]))return!1;if(""==i){if(mw.event.is.delete(e)&&(r=mw.wysiwyg.merge.getNext(t.focusNode)),mw.event.is.backSpace(e)&&(r=mw.wysiwyg.merge.getPrev(t.focusNode)),mw.wysiwyg.merge.alwaysMergeable(r))return!0;if(mw.wysiwyg.merge.isInNonbreakable(r))return e.preventDefault(),!1;r.nodeValue,null!==r&&mw.wysiwyg.merge.isMergeable(r)?mw.event.is.delete(e)?mw.wysiwyg.merge.manageBreakables(t.focusNode,r,"next",e):mw.wysiwyg.merge.manageBreakables(t.focusNode,r,"prev",e):e.preventDefault(),null===r&&(r=t.focusNode.parentNode.nextSibling,mw.wysiwyg.merge.isMergeable(r)||e.preventDefault(),mw.event.is.delete(e)?mw.wysiwyg.merge.manageBreakables(t.focusNode,r,"next",e):mw.wysiwyg.merge.manageBreakables(t.focusNode,r,"prev",e))}}return!0}}})();